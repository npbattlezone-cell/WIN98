<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover">
    <title>Gaming Tournament</title>

    <!-- Icons and Fonts -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Swiper CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        /* --- Modern UI/UX Enhancement --- */
        :root {
            --primary-bg: #0d1117; /* GitHub Dark Dimmed BG */
            --secondary-bg: #161b22; /* GitHub Dark Dimmed BG-Secondary */
            --card-bg: #1a202c; /* Slightly bluer card */
            --border-color: #30363d; /* GitHub Dark Dimmed Border */
            --text-primary: #c9d1d9; /* GitHub Dark Dimmed Text */
            --text-secondary: #8b949e; /* GitHub Dark Dimmed Text-Secondary */
            --accent-color: #58a6ff; /* GitHub Dark Dimmed Blue */
            --accent-gradient: linear-gradient(to right, #3B82F6, #58a6ff);
            --primary-button-bg: #238636; /* GitHub Dark Dimmed Green */
            --success-color: #238636;
            --danger-color: #da3633;
            --warning-color: #f59e0b;
            --info-color: #58a6ff;
            --bottom-nav-bg: rgba(22, 27, 34, 0.85); /* Semi-transparent */
            --glow-color: rgba(88, 166, 255, 0.5); /* Glow for interactive elements */
            --font-family: 'Poppins', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { font-size: 16px; scroll-behavior: smooth; }

        body {
            font-family: var(--font-family);
            background-color: var(--primary-bg);
            color: var(--text-primary);
            padding-top: 80px; /* Increased for taller header */
            padding-bottom: 75px;
            min-height: 100vh;
            overscroll-behavior-y: contain;
            -webkit-text-size-adjust: 100%;
            text-size-adjust: 100%;
            -webkit-user-select: none;
            user-select: none;
        }

        /* Custom Scrollbar for a modern look */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: var(--primary-bg); }
        ::-webkit-scrollbar-thumb { background-color: var(--border-color); border-radius: 10px; border: 2px solid var(--primary-bg); }
        ::-webkit-scrollbar-thumb:hover { background-color: var(--text-secondary); }

        a { color: var(--accent-color); text-decoration: none; }
        a:hover { color: #80baff; text-decoration: underline; }

        .main-content { padding: 1rem; max-width: 1200px; margin: 0 auto; }
        .section { display: none; animation: fadeIn 0.4s ease-in-out; }
        .section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }

        .section-title { font-size: 1.2rem; font-weight: 600; margin-bottom: 1.25rem; color: var(--text-primary); border-bottom: 1px solid var(--border-color); padding-bottom: 0.5rem; }
        .custom-card { background-color: var(--card-bg); border-radius: 12px; padding: 1.25rem; margin-bottom: 1.25rem; border: 1px solid var(--border-color); box-shadow: 0 4px 12px rgba(0,0,0,0.2); }
        .btn-custom { border-radius: 8px; font-size: 0.95rem; font-weight: 500; padding: 10px 18px; border: 1px solid transparent; display: inline-flex; align-items: center; justify-content: center; gap: 8px; transition: all 0.2s ease-in-out; }
        .btn-custom-primary { background: var(--accent-gradient); color: white; font-weight: 600; box-shadow: 0 0 15px -5px var(--glow-color); }
        .btn-custom-primary:hover { transform: translateY(-2px); box-shadow: 0 0 25px -5px var(--glow-color); filter: brightness(1.1); }
        .btn-custom-secondary { background-color: var(--secondary-bg); color: var(--text-primary); border-color: var(--border-color); }
        .btn-custom-secondary:hover { background-color: #30363d; border-color: var(--text-secondary); }
        
        .form-control { background-color: var(--primary-bg); border: 1px solid var(--border-color); color: var(--text-primary); border-radius: 8px; padding: 10px; }
        .form-control:focus { background-color: var(--secondary-bg); border-color: var(--accent-color); color: var(--text-primary); box-shadow: 0 0 0 3px var(--glow-color); }
        
        .list-group-item { background-color: transparent; border-color: var(--border-color); }
        #globalLoaderEl { 
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
        }
        
        /* QR Code Display Styles */
        #qrCodeDisplayContainer {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 1rem;
            border: 1px solid var(--border-color);
        }
        
        #qrCodeDisplayImg {
            transition: transform 0.3s ease;
            cursor: pointer;
        }
        
        #qrCodeDisplayImg:hover {
            transform: scale(1.05);
        }
        
        /* QR Code Actions Styling */
        .qr-code-actions {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-top: 12px;
        }
        
        .qr-code-actions .btn {
            flex: 1;
            max-width: 120px;
            font-size: 0.85rem;
            padding: 6px 12px;
        }
        
        /* Fullscreen Modal Enhancements */
        #qrCodeFullscreenModal .modal-dialog {
            max-width: 90vw;
            max-height: 90vh;
        }
        
        #qrCodeFullscreenModal .modal-body {
            padding: 2rem;
            text-align: center;
        }
        
        #qrCodeFullscreenModal img {
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border: 2px solid var(--border-color);
        }

        /* --- Header Enhancements --- */
        .app-header {
            height: 70px; /* Taller header */
            background-color: rgba(13, 17, 23, 0.8); /* Semi-transparent */
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            padding: 0 1rem;
        }
        .header-logo { border: 2px solid var(--accent-color); }
        .wallet-chip { background: var(--accent-gradient); font-weight: 600; border-radius: 25px; box-shadow: 0 2px 8px rgba(0,0,0,0.3); }

        /* --- Bottom Navigation Enhancements --- */
        .bottom-nav {
            height: 70px;
            background-color: var(--bottom-nav-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-top: 1px solid var(--border-color);
        }
        .nav-item.active { color: var(--accent-color); background-color: transparent; }
        .nav-item.active i { transform: scale(1.2); text-shadow: 0 0 10px var(--glow-color); }
        .nav-item i { transition: transform 0.2s ease; }
        .nav-item:hover i { transform: scale(1.1); }

        /* --- Game Card Enhancements --- */
        .game-card {
            border-radius: 12px;
            border: 1px solid var(--border-color);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            overflow: hidden;
            background: linear-gradient(145deg, var(--secondary-bg), var(--card-bg));
        }
        .game-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px -10px var(--glow-color);
            border-color: var(--accent-color);
        }
        .game-card img { height: 140px; }
        .game-card span { font-weight: 600; font-size: 1rem; }

        /* --- Tournament Card Enhancements --- */
        .tournament-tabs .tab-item.active { background-color: var(--accent-color); color: var(--primary-bg); font-weight: 700; }
        
        .tournament-card {
            background: linear-gradient(160deg, var(--secondary-bg) 0%, var(--primary-bg) 100%);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 1rem;
            transition: all 0.3s ease;
        }
        .tournament-card:hover { border-color: var(--accent-color); box-shadow: 0 0 20px -10px var(--glow-color); }
        .tournament-card-header { margin-bottom: 0.75rem; }
        .tournament-card-tags span { background-color: rgba(255,255,255,0.05); border: 1px solid var(--border-color); font-size: 0.75rem; }
        .tournament-card-title { font-size: 1.1rem; }
        .tournament-card-info { padding: 0.75rem 0; font-size: 0.85rem; }
        .info-item strong { font-size: 1rem; }
        .progress { height: 8px; border-radius: 4px; }
        .progress-bar { background: var(--accent-gradient); }

        .tournament-card-actions .btn-sm { font-size: 0.9rem; padding: 10px; }
        .tournament-card-actions .btn-join, .btn-idpass { background: var(--accent-gradient); color: white; font-weight: 600; border: none; }
        .tournament-card-actions .btn-join:hover { filter: brightness(1.2); transform: scale(1.02); }
        .tournament-card-actions .btn-details { background-color: transparent; border: 1px solid var(--border-color); }
        .tournament-card-actions .btn-details:hover { background-color: var(--secondary-bg); border-color: var(--text-secondary); }
        
        /* Result Area in Tournament Card */
        .tournament-result-area {
            background-color: rgba(13, 17, 23, 0.7); /* Darker, semi-transparent */
            border-radius: 12px;
            border-top: 1px solid var(--accent-color);
        }
        .result-grid-item strong { font-size: 1.4rem; color: var(--accent-color); }

        /* Wallet and Profile Cards */
        .wallet-card, .profile-header-card {
            background: linear-gradient(145deg, var(--card-bg), var(--secondary-bg));
            border-radius: 16px;
        }
        .balance-item-value { font-size: 1.25rem; }
        .profile-avatar { border: 3px solid var(--accent-color); }

        /* --- Modern Login & Signup Styles --- */
        .auth-container {
            min-height: calc(100vh - 155px);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem 1rem;
            background: linear-gradient(135deg, var(--primary-bg) 0%, var(--secondary-bg) 100%);
            position: relative;
            overflow: hidden;
        }

        .auth-container::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(88, 166, 255, 0.1) 0%, transparent 70%);
            animation: float 20s ease-in-out infinite;
            pointer-events: none;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            25% { transform: translate(10px, -10px) rotate(1deg); }
            50% { transform: translate(-5px, 5px) rotate(-1deg); }
            75% { transform: translate(-10px, -5px) rotate(0.5deg); }
        }

        .auth-card {
            background: rgba(26, 32, 44, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(88, 166, 255, 0.2);
            border-radius: 24px;
            padding: 2.5rem;
            width: 100%;
            max-width: 420px;
            box-shadow: 
                0 25px 50px -12px rgba(0, 0, 0, 0.5),
                0 0 0 1px rgba(88, 166, 255, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            position: relative;
            z-index: 1;
            transition: all 0.3s ease;
        }

        .auth-card:hover {
            transform: translateY(-5px);
            box-shadow: 
                0 35px 60px -12px rgba(0, 0, 0, 0.6),
                0 0 0 1px rgba(88, 166, 255, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.15);
        }

        .auth-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .auth-logo {
            width: 80px;
            height: 80px;
            background: var(--accent-gradient);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.5rem;
            font-size: 2rem;
            color: white;
            box-shadow: 0 8px 32px rgba(88, 166, 255, 0.3);
            border: 3px solid rgba(255, 255, 255, 0.1);
        }

        .auth-title {
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--accent-color) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .auth-subtitle {
            color: var(--text-secondary);
            font-size: 1rem;
            font-weight: 400;
        }

        .auth-form {
            margin-bottom: 1.5rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
            position: relative;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
            font-weight: 500;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .form-input {
            width: 100%;
            padding: 1rem 1rem 1rem 3rem;
            background: rgba(13, 17, 23, 0.8);
            border: 2px solid rgba(88, 166, 255, 0.1);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 1rem;
            transition: all 0.3s ease;
            position: relative;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--accent-color);
            background: rgba(13, 17, 23, 0.9);
            box-shadow: 0 0 0 4px rgba(88, 166, 255, 0.1);
        }

        .form-input::placeholder {
            color: var(--text-secondary);
            opacity: 0.7;
        }

        .input-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
            font-size: 1.1rem;
            transition: color 0.3s ease;
        }

        .form-input:focus + .input-icon {
            color: var(--accent-color);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .auth-btn {
            width: 100%;
            padding: 1rem;
            background: var(--accent-gradient);
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            margin-bottom: 1rem;
        }

        .auth-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }

        .auth-btn:hover::before {
            left: 100%;
        }

        .auth-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(88, 166, 255, 0.3);
        }

        .auth-btn:active {
            transform: translateY(0);
        }

        .auth-toggle {
            background: none;
            border: none;
            color: var(--accent-color);
            font-size: 0.9rem;
            cursor: pointer;
            text-decoration: underline;
            transition: color 0.3s ease;
        }

        .auth-toggle:hover {
            color: #80baff;
        }

        .auth-footer {
            text-align: center;
            margin-top: 1.5rem;
        }

        .forgot-password {
            color: var(--text-secondary);
            font-size: 0.9rem;
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .forgot-password:hover {
            color: var(--accent-color);
        }

        .form-divider {
            text-align: center;
            margin: 1.5rem 0;
            position: relative;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .form-divider::before,
        .form-divider::after {
            content: '';
            position: absolute;
            top: 50%;
            width: 30%;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--border-color), transparent);
        }

        .form-divider::before {
            left: 0;
        }

        .form-divider::after {
            right: 0;
        }

        .form-divider span {
            background: rgba(26, 32, 44, 0.95);
            padding: 0 1rem;
            position: relative;
            z-index: 1;
        }

        .status-message {
            padding: 1rem;
            border-radius: 12px;
            margin-bottom: 1rem;
            font-size: 0.9rem;
            font-weight: 500;
            text-align: center;
            border: 1px solid transparent;
        }

        .status-message.success {
            background: rgba(34, 134, 54, 0.1);
            border-color: rgba(34, 134, 54, 0.3);
            color: #4ade80;
        }

        .status-message.error {
            background: rgba(218, 54, 51, 0.1);
            border-color: rgba(218, 54, 51, 0.3);
            color: #f87171;
        }

        .status-message.info {
            background: rgba(88, 166, 255, 0.1);
            border-color: rgba(88, 166, 255, 0.3);
            color: #60a5fa;
        }

        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .auth-container {
                padding: 1rem;
                min-height: calc(100vh - 140px);
            }

            .auth-card {
                padding: 2rem 1.5rem;
                margin: 0 0.5rem;
            }

            .auth-title {
                font-size: 1.75rem;
            }

            .form-row {
                grid-template-columns: 1fr;
                gap: 0;
            }

            .form-input {
                padding: 0.875rem 0.875rem 0.875rem 2.5rem;
                font-size: 0.95rem;
            }

            .input-icon {
                left: 0.875rem;
                font-size: 1rem;
            }
        }

        @media (max-width: 480px) {
            .auth-card {
                padding: 1.5rem 1rem;
                border-radius: 20px;
            }

            .auth-logo {
                width: 70px;
                height: 70px;
                font-size: 1.75rem;
            }

            .auth-title {
                font-size: 1.5rem;
            }

            .form-input {
                padding: 0.75rem 0.75rem 0.75rem 2.25rem;
            }

            .input-icon {
                left: 0.75rem;
            }
        }

        /* Modal Enhancements */
        .modal-content {
            background-color: rgba(22, 27, 34, 0.9);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 16px;
        }
        .modal-header { border-bottom-color: var(--border-color); }
        .modal-footer { border-top-color: var(--border-color); }

        /* --- Modern Refer & Earn UI Styles --- */
        .referral-container {
            padding: 1rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .referral-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 24px;
            padding: 2.5rem 2rem;
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(102, 126, 234, 0.3);
        }

        .referral-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(255,255,255,0.15) 0%, rgba(255,255,255,0.05) 100%);
            pointer-events: none;
        }

        .referral-header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            z-index: 1;
            gap: 2rem;
        }

        .referral-title-section {
            flex: 1;
        }

        .referral-title {
            color: white;
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .referral-subtitle {
            color: rgba(255,255,255,0.95);
            font-size: 1.1rem;
            margin: 0;
            font-weight: 400;
            line-height: 1.5;
        }

        .referral-header-icon {
            width: 80px;
            height: 80px;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2rem;
            backdrop-filter: blur(15px);
            border: 2px solid rgba(255,255,255,0.3);
            box-shadow: 0 8px 32px rgba(0,0,0,0.2);
        }

        /* Referral Overview Grid */
        .referral-overview-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
            margin-bottom: 2.5rem;
        }

        .referral-card {
            background: linear-gradient(180deg, rgba(22,27,34,0.98), rgba(22,27,34,0.92));
            border-radius: 20px;
            padding: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .referral-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--accent-color), #FBBF24, #10B981);
        }

        .referral-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 25px 50px rgba(0,0,0,0.4);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .referral-card-header {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .referral-icon {
            width: 60px;
            height: 60px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .total-earnings-card .referral-icon {
            background: linear-gradient(135deg, #10B981, #059669);
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
        }

        .successful-referrals-card .referral-icon {
            background: linear-gradient(135deg, #3B82F6, #1D4ED8);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.4);
        }

        .referral-icon::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            transform: rotate(45deg);
            transition: all 0.6s ease;
        }

        .referral-card:hover .referral-icon::before {
            transform: rotate(45deg) translate(50%, 50%);
        }

        .referral-info {
            flex: 1;
        }

        .referral-label {
            color: var(--text-primary);
            font-size: 1.1rem;
            font-weight: 600;
            margin: 0 0 0.75rem 0;
            letter-spacing: 0.5px;
        }

        .referral-amount {
            color: var(--text-primary);
            font-size: 2rem;
            font-weight: 800;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .referral-card-footer {
            border-top: 1px solid rgba(255,255,255,0.1);
            padding-top: 1.25rem;
        }

        .referral-source {
            color: var(--text-secondary);
            font-size: 0.9rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Referral Code Section */
        .referral-code-section {
            background: linear-gradient(180deg, rgba(22,27,34,0.98), rgba(22,27,34,0.92));
            border-radius: 20px;
            padding: 2.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 2.5rem;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .referral-code-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2);
        }

        .referral-code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .referral-code-title {
            color: var(--text-primary);
            font-size: 1.4rem;
            font-weight: 700;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .btn-copy-code {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border: none;
            border-radius: 12px;
            padding: 0.75rem 1.5rem;
            color: white;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .btn-copy-code:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 35px rgba(102, 126, 234, 0.6);
        }

        .btn-copy-code:active {
            transform: translateY(0);
        }

        .referral-code {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
            border: 2px solid rgba(102, 126, 234, 0.3);
            border-radius: 16px;
            padding: 1.5rem;
            text-align: center;
            margin-bottom: 1.5rem;
            position: relative;
            overflow: hidden;
        }

        .referral-code::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.05), transparent);
            transform: translateX(-100%);
            transition: transform 0.6s ease;
        }

        .referral-code:hover::before {
            transform: translateX(100%);
        }

        .referral-code span {
            font-family: 'Courier New', monospace;
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--text-primary);
            letter-spacing: 2px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .referral-code-subtitle {
            color: var(--text-secondary);
            font-size: 1rem;
            margin: 0;
            text-align: center;
            font-weight: 500;
            line-height: 1.5;
        }

        /* Referral History Section */
        .referral-history-section {
            background: linear-gradient(180deg, rgba(22,27,34,0.98), rgba(22,27,34,0.92));
            border-radius: 20px;
            padding: 2.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }

        .referral-history-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #10B981, #059669);
        }

        .referral-history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .history-title {
            color: var(--text-primary);
            font-size: 1.4rem;
            font-weight: 700;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .history-actions {
            display: flex;
            gap: 0.75rem;
        }

        .btn-refresh {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 12px;
            padding: 0.75rem 1.25rem;
            color: var(--text-secondary);
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            backdrop-filter: blur(10px);
        }

        .btn-refresh:hover {
            background: var(--accent-color);
            color: white;
            border-color: var(--accent-color);
            transform: translateY(-2px);
        }

        /* Referral History List */
        .referral-history-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .referral-history-item {
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 16px;
            padding: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .referral-history-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(180deg, #10B981, #059669);
            transform: scaleY(0);
            transition: transform 0.3s ease;
        }

        .referral-history-item:hover {
            background: rgba(255,255,255,0.05);
            border-color: rgba(255,255,255,0.15);
            transform: translateX(8px);
        }

        .referral-history-item:hover::before {
            transform: scaleY(1);
        }

        .referral-history-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #10B981, #059669);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .referral-history-content {
            flex: 1;
            min-width: 0;
        }

        .referral-history-name {
            color: var(--text-primary);
            font-size: 1.1rem;
            font-weight: 600;
            margin: 0 0 0.25rem 0;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .referral-history-email {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin: 0 0 0.5rem 0;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .referral-history-date {
            color: var(--text-secondary);
            font-size: 0.8rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .referral-history-status {
            background: linear-gradient(135deg, #10B981, #059669);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            flex-shrink: 0;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
        }

        /* Empty State */
        .empty-referral-state {
            text-align: center;
            padding: 3rem 2rem;
            color: var(--text-secondary);
        }

        .empty-referral-state i {
            font-size: 4rem;
            margin-bottom: 1.5rem;
            opacity: 0.5;
        }

        .empty-referral-state h4 {
            color: var(--text-primary);
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 0.75rem;
        }

        .empty-referral-state p {
            font-size: 1rem;
            line-height: 1.6;
            margin: 0;
        }

        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .referral-container {
                padding: 0.75rem;
            }
            
            .referral-header {
                padding: 2rem 1.5rem;
                border-radius: 20px;
                margin-bottom: 1.5rem;
            }
            
            .referral-title {
                font-size: 1.8rem;
            }
            
            .referral-subtitle {
                font-size: 1rem;
            }
            
            .referral-header-icon {
                width: 60px;
                height: 60px;
                font-size: 1.5rem;
            }
            
            .referral-overview-grid {
                gap: 1rem;
                margin-bottom: 2rem;
            }
            
            .referral-card {
                padding: 1.5rem;
            }
            
            .referral-code-section {
                padding: 2rem 1.5rem;
                margin-bottom: 2rem;
            }
            
            .referral-code-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }
            
            .btn-copy-code {
                width: 100%;
                justify-content: center;
            }
            
            .referral-code {
                padding: 1.25rem;
            }
            
            .referral-code span {
                font-size: 1.5rem;
                letter-spacing: 1px;
            }
            
            .referral-history-section {
                padding: 2rem 1.5rem;
            }
            
            .referral-history-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }
            
            .btn-refresh {
                width: 100%;
                justify-content: center;
            }
            
            .referral-history-item {
                padding: 1.25rem;
                flex-direction: column;
                text-align: center;
                gap: 1rem;
            }
            
            .referral-history-content {
                text-align: center;
            }
            
            .referral-history-status {
                align-self: center;
            }
        }

        @media (min-width: 768px) {
            .referral-overview-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 1024px) {
            .referral-overview-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Enhanced Visual Effects */
        .referral-header::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: float 6s ease-in-out infinite;
            pointer-events: none;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            33% { transform: translate(30px, -30px) rotate(120deg); }
            66% { transform: translate(-20px, 20px) rotate(240deg); }
        }

        /* Enhanced Card Interactions */
        .referral-card {
            position: relative;
            overflow: hidden;
        }

        .referral-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.5s ease;
        }

        .referral-card:hover::after {
            left: 100%;
        }

        /* Enhanced Referral Code */
        .referral-code {
            position: relative;
            overflow: hidden;
        }

        .referral-code::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.1) 50%, transparent 70%);
            transform: translateX(-100%);
            transition: transform 0.6s ease;
        }

        .referral-code:hover::after {
            transform: translateX(100%);
        }

        /* Enhanced History Items */
        .referral-history-item {
            position: relative;
            overflow: hidden;
        }

        .referral-history-item::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(16, 185, 129, 0.05), transparent);
            transform: translateX(-100%);
            transition: transform 0.6s ease;
        }

        .referral-history-item:hover::after {
            transform: translateX(100%);
        }

        /* Enhanced Share Buttons */
        .share-option-btn {
            position: relative;
            overflow: hidden;
        }

        .share-option-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.3s ease, height 0.3s ease;
        }

        .share-option-btn:hover::before {
            width: 200%;
            height: 200%;
        }

        .share-option-btn span {
            position: relative;
            z-index: 1;
        }

        /* --- Modern Stats UI Styles --- */
        .stats-container {
            padding: 1rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .stats-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 24px;
            padding: 2.5rem 2rem;
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(102, 126, 234, 0.3);
        }

        .stats-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(255,255,255,0.15) 0%, rgba(255,255,255,0.05) 100%);
            pointer-events: none;
        }

        .stats-header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            z-index: 1;
            gap: 2rem;
        }

        .stats-title-section {
            flex: 1;
        }

        .stats-title {
            color: white;
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .stats-subtitle {
            color: rgba(255,255,255,0.95);
            font-size: 1.1rem;
            margin: 0;
            font-weight: 400;
            line-height: 1.5;
        }

        .stats-header-icon {
            width: 80px;
            height: 80px;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2rem;
            backdrop-filter: blur(15px);
            border: 2px solid rgba(255,255,255,0.3);
            box-shadow: 0 8px 32px rgba(0,0,0,0.2);
        }

        /* Stats Sections */
        .stats-performance-section,
        .stats-earnings-section {
            background: linear-gradient(180deg, rgba(22,27,34,0.98), rgba(22,27,34,0.92));
            border-radius: 20px;
            padding: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .stats-performance-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #3B82F6, #1D4ED8);
        }

        .stats-earnings-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #10B981, #059669);
        }

        .stats-section-title {
            color: var(--text-primary);
            font-size: 1.4rem;
            font-weight: 700;
            margin: 0 0 1.5rem 0;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .stats-section-title i {
            color: var(--accent-color);
            font-size: 1.2rem;
        }

        /* Stats Grid Layouts */
        .stats-performance-grid,
        .stats-earnings-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }

        /* Stats Cards */
        .stats-card {
            background: linear-gradient(180deg, rgba(22,27,34,0.95), rgba(22,27,34,0.85));
            border-radius: 16px;
            padding: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.08);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .stats-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--accent-color), #FBBF24);
        }

        .stats-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 25px 50px rgba(0,0,0,0.4);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .stats-card-header {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .stats-icon {
            width: 60px;
            height: 60px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
            position: relative;
            overflow: hidden;
        }

        /* Card-specific icon colors */
        .tournaments-joined-card .stats-icon {
            background: linear-gradient(135deg, #3B82F6, #1D4ED8);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.4);
        }

        .matches-played-card .stats-icon {
            background: linear-gradient(135deg, #8B5CF6, #7C3AED);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.4);
        }

        .matches-won-card .stats-icon {
            background: linear-gradient(135deg, #F59E0B, #D97706);
            box-shadow: 0 8px 25px rgba(245, 158, 11, 0.4);
        }

        .win-rate-card .stats-icon {
            background: linear-gradient(135deg, #10B981, #059669);
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
        }

        .tournament-winnings-card .stats-icon {
            background: linear-gradient(135deg, #F59E0B, #D97706);
            box-shadow: 0 8px 25px rgba(245, 158, 11, 0.4);
        }

        .referral-winnings-card .stats-icon {
            background: linear-gradient(135deg, #EC4899, #DB2777);
            box-shadow: 0 8px 25px rgba(236, 72, 153, 0.4);
        }

        .entry-fees-card .stats-icon {
            background: linear-gradient(135deg, #6B7280, #4B5563);
            box-shadow: 0 8px 25px rgba(107, 114, 128, 0.4);
        }

        .net-earnings-card .stats-icon {
            background: linear-gradient(135deg, #10B981, #059669);
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
        }

        .stats-icon::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            transform: rotate(45deg);
            transition: all 0.6s ease;
        }

        .stats-card:hover .stats-icon::before {
            transform: rotate(45deg) translate(50%, 50%);
        }

        .stats-info {
            flex: 1;
        }

        .stats-label {
            color: var(--text-primary);
            font-size: 1rem;
            font-weight: 600;
            margin: 0 0 0.75rem 0;
            letter-spacing: 0.5px;
        }

        .stats-amount {
            color: var(--text-primary);
            font-size: 2rem;
            font-weight: 800;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Stats Card Footer */
        .stats-card-footer {
            border-top: 1px solid rgba(255,255,255,0.1);
            padding-top: 1.25rem;
        }

        .stats-trend {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.85rem;
            font-weight: 500;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            width: fit-content;
        }

        .stats-trend.positive {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(5, 150, 105, 0.2));
            color: #10B981;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .stats-trend.neutral {
            background: linear-gradient(135deg, rgba(107, 114, 128, 0.2), rgba(75, 85, 99, 0.2));
            color: #9CA3AF;
            border: 1px solid rgba(107, 114, 128, 0.3);
        }

        .stats-trend i {
            font-size: 0.8rem;
        }

        /* Win Rate Progress */
        .win-rate-progress {
            text-align: center;
        }

        .win-rate-progress .progress {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 0.75rem;
        }

        .win-rate-progress .progress-bar {
            background: linear-gradient(90deg, #10B981, #059669);
            border-radius: 10px;
            transition: width 0.8s ease;
        }

        .win-rate-label {
            color: var(--text-secondary);
            font-size: 0.8rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Stats Summary Section */
        .stats-summary-section {
            background: linear-gradient(180deg, rgba(22,27,34,0.98), rgba(22,27,34,0.92));
            border-radius: 20px;
            padding: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .stats-summary-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #F59E0B, #D97706);
        }

        .stats-summary-card {
            position: relative;
            z-index: 1;
        }

        .summary-header {
            margin-bottom: 1.5rem;
        }

        .summary-title {
            color: var(--text-primary);
            font-size: 1.2rem;
            font-weight: 700;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .summary-title i {
            color: #F59E0B;
        }

        .summary-content {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background: rgba(255,255,255,0.03);
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.08);
            transition: all 0.3s ease;
        }

        .summary-item:hover {
            background: rgba(255,255,255,0.05);
            border-color: rgba(255,255,255,0.15);
            transform: translateX(8px);
        }

        .summary-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
            font-weight: 500;
        }

        .summary-value {
            color: var(--text-primary);
            font-size: 1rem;
            font-weight: 600;
        }

        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .stats-container {
                padding: 0.75rem;
            }
            
            .stats-header {
                padding: 2rem 1.5rem;
                border-radius: 20px;
                margin-bottom: 1.5rem;
            }
            
            .stats-title {
                font-size: 1.8rem;
            }
            
            .stats-subtitle {
                font-size: 1rem;
            }
            
            .stats-header-icon {
                width: 60px;
                height: 60px;
                font-size: 1.5rem;
            }
            
            .stats-performance-section,
            .stats-earnings-section,
            .stats-summary-section {
                padding: 1.5rem;
                border-radius: 16px;
                margin-bottom: 1.5rem;
            }
            
            .stats-performance-grid,
            .stats-earnings-grid {
                gap: 1rem;
            }
            
            .stats-card {
                padding: 1.25rem;
            }
            
            .stats-card-header {
                gap: 1rem;
                margin-bottom: 1.25rem;
            }
            
            .stats-icon {
                width: 50px;
                height: 50px;
                font-size: 1.3rem;
            }
            
            .stats-amount {
                font-size: 1.5rem;
            }
            
            .summary-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
                text-align: left;
            }
        }

        @media (min-width: 768px) {
            .stats-performance-grid,
            .stats-earnings-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 1024px) {
            .stats-performance-grid,
            .stats-earnings-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Enhanced Visual Effects */
        .stats-header::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: float 6s ease-in-out infinite;
            pointer-events: none;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            33% { transform: translate(30px, -30px) rotate(120deg); }
            66% { transform: translate(-20px, 20px) rotate(240deg); }
        }

        /* Enhanced Card Interactions */
        .stats-card {
            position: relative;
            overflow: hidden;
        }

        .stats-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.5s ease;
        }

        .stats-card:hover::after {
            left: 100%;
        }

        /* Enhanced Stats Amount Animation */
        .stats-amount {
            background-size: 200% 200%;
            animation: gradientShift 3s ease infinite;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Enhanced Summary Items */
        .summary-item {
            position: relative;
            overflow: hidden;
        }

        .summary-item::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(245, 158, 11, 0.05), transparent);
            transform: translateX(-100%);
            transition: transform 0.6s ease;
        }

        .summary-item:hover::after {
            transform: translateX(100%);
        }

        /* Animation Classes */
        .stats-card.animate-in {
            animation: slideInUp 0.6s ease-out;
        }

        .stats-performance-section.animate-in {
            animation: slideInUp 0.6s ease-out 0.1s both;
        }

        .stats-earnings-section.animate-in {
            animation: slideInUp 0.6s ease-out 0.2s both;
        }

        .stats-summary-section.animate-in {
            animation: slideInUp 0.6s ease-out 0.3s both;
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Loading States */
        .stats-loading {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 3rem;
            color: var(--text-secondary);
        }

        .stats-loading .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(255,255,255,0.1);
            border-top: 3px solid var(--accent-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* --- Modern Profile UI Styles --- */
        .profile-container {
            padding: 1rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .profile-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 24px;
            padding: 2.5rem 2rem;
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(102, 126, 234, 0.3);
        }

        .profile-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(255,255,255,0.15) 0%, rgba(255,255,255,0.05) 100%);
            pointer-events: none;
        }

        .profile-header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            z-index: 1;
            gap: 2rem;
        }

        .profile-avatar-section {
            display: flex;
            align-items: center;
            gap: 2rem;
        }

        .profile-avatar-container {
            position: relative;
            width: 100px;
            height: 100px;
        }

        .profile-avatar {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid rgba(255,255,255,0.3);
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
        }

        .profile-edit-overlay {
            position: absolute;
            bottom: 0;
            right: 0;
            background: rgba(255,255,255,0.9);
            border-radius: 50%;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .profile-edit-overlay:hover {
            background: white;
            transform: scale(1.1);
        }

        .btn-edit-avatar {
            background: none;
            border: none;
            color: #667eea;
            font-size: 1rem;
            cursor: pointer;
            padding: 0;
        }

        .profile-info {
            color: white;
        }

        .profile-name {
            font-size: 2rem;
            font-weight: 800;
            margin: 0 0 0.5rem 0;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .profile-email {
            font-size: 1.1rem;
            margin: 0 0 1rem 0;
            opacity: 0.9;
        }

        .profile-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .status-badge {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            background: rgba(255,255,255,0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.3);
        }

        .status-badge.online {
            background: rgba(16, 185, 129, 0.2);
            color: #10B981;
            border-color: rgba(16, 185, 129, 0.3);
        }

        .status-badge i {
            font-size: 0.8rem;
            color: #10B981;
        }

        .profile-actions {
            display: flex;
            gap: 1rem;
        }

        .btn-profile-action {
            background: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 12px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            backdrop-filter: blur(10px);
        }

        .btn-profile-action:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }

        /* Profile Stats Overview */
        .profile-stats-overview {
            background: linear-gradient(180deg, rgba(22,27,34,0.98), rgba(22,27,34,0.92));
            border-radius: 20px;
            padding: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .profile-stats-overview::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #F59E0B, #D97706);
        }

        .stats-overview-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }

        .stat-overview-card {
            background: linear-gradient(180deg, rgba(22,27,34,0.95), rgba(22,27,34,0.85));
            border-radius: 16px;
            padding: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.08);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .stat-overview-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--accent-color), #FBBF24);
        }

        .stat-overview-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 25px 50px rgba(0,0,0,0.4);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .stat-overview-icon {
            width: 60px;
            height: 60px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
            position: relative;
            overflow: hidden;
            flex-shrink: 0;
        }

        /* Card-specific icon colors */
        .stat-overview-card.matches-played .stat-overview-icon {
            background: linear-gradient(135deg, #3B82F6, #1D4ED8);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.4);
        }

        .stat-overview-card.matches-won .stat-overview-icon {
            background: linear-gradient(135deg, #F59E0B, #D97706);
            box-shadow: 0 8px 25px rgba(245, 158, 11, 0.4);
        }

        .stat-overview-card.total-earnings .stat-overview-icon {
            background: linear-gradient(135deg, #10B981, #059669);
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
        }

        .stat-overview-card.tournaments-joined .stat-overview-icon {
            background: linear-gradient(135deg, #8B5CF6, #7C3AED);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.4);
        }

        .stat-overview-content {
            flex: 1;
            min-width: 0;
        }

        .stat-overview-value {
            color: var(--text-primary);
            font-size: 1.8rem;
            font-weight: 800;
            margin: 0 0 0.5rem 0;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-overview-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
            font-weight: 500;
            margin: 0;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stat-overview-trend {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.8rem;
            font-weight: 600;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            background: rgba(16, 185, 129, 0.2);
            color: #10B981;
            border: 1px solid rgba(16, 185, 129, 0.3);
            flex-shrink: 0;
        }

        .stat-overview-trend i {
            font-size: 0.7rem;
        }

        /* Profile Menu */
        .profile-menu {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .menu-section {
            background: linear-gradient(180deg, rgba(22,27,34,0.98), rgba(22,27,34,0.92));
            border-radius: 20px;
            padding: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .menu-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--accent-color), #FBBF24);
        }

        .menu-section-title {
            color: var(--text-primary);
            font-size: 1.3rem;
            font-weight: 700;
            margin: 0 0 1.5rem 0;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .menu-section-title i {
            color: var(--accent-color);
            font-size: 1.1rem;
        }

        /* Quick Actions Section */
        .quick-actions-section .quick-actions-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
        }

        .quick-action-card {
            background: linear-gradient(180deg, rgba(22,27,34,0.95), rgba(22,27,34,0.85));
            border-radius: 16px;
            padding: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.08);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            text-decoration: none;
            color: var(--text-primary);
            cursor: pointer;
        }

        .quick-action-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--accent-color), #FBBF24);
        }

        .quick-action-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 25px 50px rgba(0,0,0,0.4);
            border-color: rgba(255, 255, 255, 0.2);
            text-decoration: none;
            color: var(--text-primary);
        }

        .quick-action-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            color: white;
            margin-bottom: 1rem;
        }

        .quick-action-card .earnings-icon {
            background: linear-gradient(135deg, #F59E0B, #D97706);
        }

        .quick-action-card .referral-icon {
            background: linear-gradient(135deg, #EC4899, #DB2777);
        }

        .quick-action-card .stats-icon {
            background: linear-gradient(135deg, #3B82F6, #1D4ED8);
        }

        .quick-action-card .wallet-icon {
            background: linear-gradient(135deg, #10B981, #059669);
        }

        .quick-action-title {
            font-size: 1.1rem;
            font-weight: 700;
            margin: 0 0 0.5rem 0;
            color: var(--text-primary);
        }

        .quick-action-subtitle {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin: 0;
            line-height: 1.4;
        }

        /* Menu Items */
        .menu-items {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .menu-item {
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 16px;
            padding: 1.25rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            text-decoration: none;
            color: var(--text-primary);
        }

        .menu-item:hover {
            background: rgba(255,255,255,0.05);
            border-color: rgba(255,255,255,0.15);
            transform: translateX(8px);
            text-decoration: none;
            color: var(--text-primary);
        }

        .menu-item-content {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .menu-item-icon {
            width: 45px;
            height: 45px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: white;
            background: rgba(255,255,255,0.1);
        }

        .menu-item-icon.earnings-icon {
            background: linear-gradient(135deg, #F59E0B, #D97706);
        }

        .menu-item-icon.referral-icon {
            background: linear-gradient(135deg, #EC4899, #DB2777);
        }

        .menu-item-icon.stats-icon {
            background: linear-gradient(135deg, #3B82F6, #1D4ED8);
        }

        .menu-item-icon.legal-icon {
            background: linear-gradient(135deg, #6B7280, #4B5563);
        }

        .menu-item-icon.logout-icon {
            background: linear-gradient(135deg, #EF4444, #DC2626);
        }

        .menu-item-text h6 {
            font-size: 1rem;
            font-weight: 600;
            margin: 0 0 0.25rem 0;
            color: var(--text-primary);
        }

        .menu-item-text p {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin: 0;
            line-height: 1.4;
        }

        .menu-item-action {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }

        /* Form Switch Styling */
        .form-check-input {
            background-color: rgba(255,255,255,0.1);
            border-color: rgba(255,255,255,0.2);
            width: 3rem;
            height: 1.5rem;
        }

        .form-check-input:checked {
            background-color: var(--accent-color);
            border-color: var(--accent-color);
        }

        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .profile-container {
                padding: 0.75rem;
            }
            
            .profile-header {
                padding: 2rem 1.5rem;
                border-radius: 20px;
                margin-bottom: 1.5rem;
            }
            
            .profile-header-content {
                flex-direction: column;
                gap: 1.5rem;
                text-align: center;
            }
            
            .profile-avatar-section {
                flex-direction: column;
                gap: 1.5rem;
                text-align: center;
            }
            
            .profile-avatar-container {
                width: 80px;
                height: 80px;
            }
            
            .profile-name {
                font-size: 1.8rem;
            }
            
            .profile-email {
                font-size: 1rem;
            }
            
            .profile-stats-overview {
                padding: 1.5rem;
                border-radius: 16px;
                margin-bottom: 1.5rem;
            }
            
            .stats-overview-grid {
                gap: 1rem;
            }
            
            .stat-overview-card {
                padding: 1.25rem;
                flex-direction: column;
                text-align: center;
                gap: 1rem;
            }
            
            .stat-overview-icon {
                width: 50px;
                height: 50px;
                font-size: 1.3rem;
            }
            
            .stat-overview-value {
                font-size: 1.5rem;
            }
            
            .stat-overview-trend {
                align-self: center;
            }
            
            .menu-section {
                padding: 1.5rem;
                border-radius: 16px;
            }
            
            .quick-actions-grid {
                gap: 0.75rem;
            }
            
            .quick-action-card {
                padding: 1.25rem;
                text-align: center;
            }
            
            .quick-action-icon {
                margin: 0 auto 1rem auto;
            }
            
            .menu-item {
                padding: 1rem;
            }
            
            .menu-item-content {
                gap: 0.75rem;
            }
            
            .menu-item-icon {
                width: 40px;
                height: 40px;
                font-size: 1.1rem;
            }
        }

        @media (min-width: 768px) {
            .stats-overview-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .quick-actions-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 1024px) {
            .stats-overview-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .quick-actions-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        /* Enhanced Visual Effects */
        .profile-header::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: float 6s ease-in-out infinite;
            pointer-events: none;
        }

        /* Enhanced Card Interactions */
        .stat-overview-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.5s ease;
        }

        .stat-overview-card:hover::after {
            left: 100%;
        }

        .quick-action-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.5s ease;
        }

        .quick-action-card:hover::after {
            left: 100%;
        }

        /* Enhanced Menu Items */
        .menu-item::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(88, 166, 255, 0.05), transparent);
            transform: translateX(-100%);
            transition: transform 0.6s ease;
        }

        .menu-item:hover::after {
            transform: translateX(100%);
        }

        /* Animation Classes */
        .stat-overview-card.animate-in {
            animation: slideInUp 0.6s ease-out;
        }

        .quick-action-card.animate-in {
            animation: slideInUp 0.6s ease-out 0.1s both;
        }

        .menu-section.animate-in {
            animation: slideInUp 0.6s ease-out 0.2s both;
        }



        /* Enhanced Animations for Mobile */
        @media (max-width: 768px) {
            .referral-card:hover {
                transform: translateY(-4px);
            }
            

            
            @keyframes pulse {
                0% { box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4); }
                50% { box-shadow: 0 8px 25px rgba(102, 126, 234, 0.8); }
                100% { box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4); }
            }
        }

        /* Animation Classes */
        .referral-card.animate-in {
            animation: slideInUp 0.6s ease-out;
        }

        .referral-code-section.animate-in {
            animation: slideInUp 0.6s ease-out 0.1s both;
        }

        .referral-history-section.animate-in {
            animation: slideInUp 0.6s ease-out 0.2s both;
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Loading States */
        .referral-loading {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 3rem;
            color: var(--text-secondary);
        }

        .referral-loading .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(255,255,255,0.1);
            border-top: 3px solid var(--accent-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Enhanced Referral UI Elements */
        .referral-share-options {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .share-option-btn {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 12px;
            padding: 0.75rem 1.25rem;
            color: var(--text-secondary);
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            backdrop-filter: blur(10px);
            text-decoration: none;
        }

        .share-option-btn:hover {
            background: var(--accent-color);
            color: white;
            border-color: var(--accent-color);
            transform: translateY(-2px);
            text-decoration: none;
        }

        .share-option-btn.whatsapp:hover {
            background: #25D366;
            border-color: #25D366;
        }

        .share-option-btn.telegram:hover {
            background: #0088cc;
            border-color: #0088cc;
        }

        .share-option-btn.copy:hover {
            background: #10B981;
            border-color: #10B981;
        }

        /* Success Animation */
        .copy-success {
            animation: copySuccess 0.6s ease-out;
        }

        @keyframes copySuccess {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        /* Enhanced Card Hover Effects */
        .referral-card:hover .referral-icon {
            transform: scale(1.1);
        }

        .referral-icon {
            transition: transform 0.3s ease;
        }

        /* Gradient Text Animation */
        .referral-amount {
            background-size: 200% 200%;
            animation: gradientShift 3s ease infinite;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }



        /* --- Modern Earnings UI Styles --- */
        .earnings-container {
            padding: 1rem;
        }

        .earnings-container:hover {
            transform: scale(1.05);
        }
        
        /* QR Code Actions Styling */
        .qr-code-actions {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-top: 12px;
        }
        
        .qr-code-actions .btn {
            flex: 1;
            max-width: 120px;
            font-size: 0.85rem;
            padding: 6px 12px;
        }
        
        /* Fullscreen Modal Enhancements */
        #qrCodeFullscreenModal .modal-dialog {
            max-width: 90vw;
            max-height: 90vh;
        }
        
        #qrCodeFullscreenModal .modal-body {
            padding: 2rem;
            text-align: center;
        }
        
        #qrCodeFullscreenModal img {
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border: 2px solid var(--border-color);
        }

        /* --- Header Enhancements --- */
        .app-header {
            height: 70px; /* Taller header */
            background-color: rgba(13, 17, 23, 0.8); /* Semi-transparent */
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            padding: 0 1rem;
        }
        .header-logo { border: 2px solid var(--accent-color); }
        .wallet-chip { background: var(--accent-gradient); font-weight: 600; border-radius: 25px; box-shadow: 0 2px 8px rgba(0,0,0,0.3); }

        /* --- Bottom Navigation Enhancements --- */
        .bottom-nav {
            height: 70px;
            background-color: var(--bottom-nav-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-top: 1px solid var(--border-color);
        }
        .nav-item.active { color: var(--accent-color); background-color: transparent; }
        .nav-item.active i { transform: scale(1.2); text-shadow: 0 0 10px var(--glow-color); }
        .nav-item i { transition: transform 0.2s ease; }
        .nav-item:hover i { transform: scale(1.1); }

        /* --- Game Card Enhancements --- */
        .game-card {
            border-radius: 12px;
            border: 1px solid var(--border-color);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            overflow: hidden;
            background: linear-gradient(145deg, var(--secondary-bg), var(--card-bg));
        }
        .game-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px -10px var(--glow-color);
            border-color: var(--accent-color);
        }
        .game-card img { height: 140px; }
        .game-card span { font-weight: 600; font-size: 1rem; }

        /* --- Tournament Card Enhancements --- */
        .tournament-tabs .tab-item.active { background-color: var(--accent-color); color: var(--primary-bg); font-weight: 700; }
        
        .tournament-card {
            background: linear-gradient(160deg, var(--secondary-bg) 0%, var(--primary-bg) 100%);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 1rem;
            transition: all 0.3s ease;
        }
        .tournament-card:hover { border-color: var(--accent-color); box-shadow: 0 0 20px -10px var(--glow-color); }
        .tournament-card-header { margin-bottom: 0.75rem; }
        .tournament-card-tags span { background-color: rgba(255,255,255,0.05); border: 1px solid var(--border-color); font-size: 0.75rem; }
        .tournament-card-title { font-size: 1.1rem; }
        .tournament-card-info { padding: 0.75rem 0; font-size: 0.85rem; }
        .info-item strong { font-size: 1rem; }
        .progress { height: 8px; border-radius: 4px; }
        .progress-bar { background: var(--accent-gradient); }

        .tournament-card-actions .btn-sm { font-size: 0.9rem; padding: 10px; }
        .tournament-card-actions .btn-join, .btn-idpass { background: var(--accent-gradient); color: white; font-weight: 600; border: none; }
        .tournament-card-actions .btn-join:hover { filter: brightness(1.2); transform: scale(1.02); }
        .tournament-card-actions .btn-details { background-color: transparent; border: 1px solid var(--border-color); }
        .tournament-card-actions .btn-details:hover { background-color: var(--secondary-bg); border-color: var(--text-secondary); }
        
        /* Result Area in Tournament Card */
        .tournament-result-area {
            background-color: rgba(13, 17, 23, 0.7); /* Darker, semi-transparent */
            border-radius: 12px;
            border-top: 1px solid var(--accent-color);
        }
        .result-grid-item strong { font-size: 1.4rem; color: var(--accent-color); }

        /* Wallet and Profile Cards */
        .wallet-card, .profile-header-card {
            background: linear-gradient(145deg, var(--card-bg), var(--secondary-bg));
            border-radius: 16px;
        }
        .balance-item-value { font-size: 1.25rem; }
        .profile-avatar { border: 3px solid var(--accent-color); }

        /* --- Modern Login & Signup Styles --- */
        .auth-container {
            min-height: calc(100vh - 155px);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem 1rem;
            background: linear-gradient(135deg, var(--primary-bg) 0%, var(--secondary-bg) 100%);
            position: relative;
            overflow: hidden;
        }

        .auth-container::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(88, 166, 255, 0.1) 0%, transparent 70%);
            animation: float 20s ease-in-out infinite;
            pointer-events: none;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            25% { transform: translate(10px, -10px) rotate(1deg); }
            50% { transform: translate(-5px, 5px) rotate(-1deg); }
            75% { transform: translate(-10px, -5px) rotate(0.5deg); }
        }

        .auth-card {
            background: rgba(26, 32, 44, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(88, 166, 255, 0.2);
            border-radius: 24px;
            padding: 2.5rem;
            width: 100%;
            max-width: 420px;
            box-shadow: 
                0 25px 50px -12px rgba(0, 0, 0, 0.5),
                0 0 0 1px rgba(88, 166, 255, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            position: relative;
            z-index: 1;
            transition: all 0.3s ease;
        }

        .auth-card:hover {
            transform: translateY(-5px);
            box-shadow: 
                0 35px 60px -12px rgba(0, 0, 0, 0.6),
                0 0 0 1px rgba(88, 166, 255, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.15);
        }

        .auth-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .auth-logo {
            width: 80px;
            height: 80px;
            background: var(--accent-gradient);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.5rem;
            font-size: 2rem;
            color: white;
            box-shadow: 0 8px 32px rgba(88, 166, 255, 0.3);
            border: 3px solid rgba(255, 255, 255, 0.1);
        }

        .auth-title {
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--accent-color) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .auth-subtitle {
            color: var(--text-secondary);
            font-size: 1rem;
            font-weight: 400;
        }

        .auth-form {
            margin-bottom: 1.5rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
            position: relative;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
            font-weight: 500;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .form-input {
            width: 100%;
            padding: 1rem 1rem 1rem 3rem;
            background: rgba(13, 17, 23, 0.8);
            border: 2px solid rgba(88, 166, 255, 0.1);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 1rem;
            transition: all 0.3s ease;
            position: relative;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--accent-color);
            background: rgba(13, 17, 23, 0.9);
            box-shadow: 0 0 0 4px rgba(88, 166, 255, 0.1);
        }

        .form-input::placeholder {
            color: var(--text-secondary);
            opacity: 0.7;
        }

        .input-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
            font-size: 1.1rem;
            transition: color 0.3s ease;
        }

        .form-input:focus + .input-icon {
            color: var(--accent-color);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .auth-btn {
            width: 100%;
            padding: 1rem;
            background: var(--accent-gradient);
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            margin-bottom: 1rem;
        }

        .auth-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }

        .auth-btn:hover::before {
            left: 100%;
        }

        .auth-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(88, 166, 255, 0.3);
        }

        .auth-btn:active {
            transform: translateY(0);
        }

        .auth-toggle {
            background: none;
            border: none;
            color: var(--accent-color);
            font-size: 0.9rem;
            cursor: pointer;
            text-decoration: underline;
            transition: color 0.3s ease;
        }

        .auth-toggle:hover {
            color: #80baff;
        }

        .auth-footer {
            text-align: center;
            margin-top: 1.5rem;
        }

        .forgot-password {
            color: var(--text-secondary);
            font-size: 0.9rem;
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .forgot-password:hover {
            color: var(--accent-color);
        }

        .form-divider {
            text-align: center;
            margin: 1.5rem 0;
            position: relative;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .form-divider::before,
        .form-divider::after {
            content: '';
            position: absolute;
            top: 50%;
            width: 30%;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--border-color), transparent);
        }

        .form-divider::before {
            left: 0;
        }

        .form-divider::after {
            right: 0;
        }

        .form-divider span {
            background: rgba(26, 32, 44, 0.95);
            padding: 0 1rem;
            position: relative;
            z-index: 1;
        }

        .status-message {
            padding: 1rem;
            border-radius: 12px;
            margin-bottom: 1rem;
            font-size: 0.9rem;
            font-weight: 500;
            text-align: center;
            border: 1px solid transparent;
        }

        .status-message.success {
            background: rgba(34, 134, 54, 0.1);
            border-color: rgba(34, 134, 54, 0.3);
            color: #4ade80;
        }

        .status-message.error {
            background: rgba(218, 54, 51, 0.1);
            border-color: rgba(218, 54, 51, 0.3);
            color: #f87171;
        }

        .status-message.info {
            background: rgba(88, 166, 255, 0.1);
            border-color: rgba(88, 166, 255, 0.3);
            color: #60a5fa;
        }

        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .auth-container {
                padding: 1rem;
                min-height: calc(100vh - 140px);
            }

            .auth-card {
                padding: 2rem 1.5rem;
                margin: 0 0.5rem;
            }

            .auth-title {
                font-size: 1.75rem;
            }

            .form-row {
                grid-template-columns: 1fr;
                gap: 0;
            }

            .form-input {
                padding: 0.875rem 0.875rem 0.875rem 2.5rem;
                font-size: 0.95rem;
            }

            .input-icon {
                left: 0.875rem;
                font-size: 1rem;
            }
        }

        @media (max-width: 480px) {
            .auth-card {
                padding: 1.5rem 1rem;
                border-radius: 20px;
            }

            .auth-logo {
                width: 70px;
                height: 70px;
                font-size: 1.75rem;
            }

            .auth-title {
                font-size: 1.5rem;
            }

            .form-input {
                padding: 0.75rem 0.75rem 0.75rem 2.25rem;
            }

            .input-icon {
                left: 0.75rem;
            }
        }

        /* Modal Enhancements */
        .modal-content {
            background-color: rgba(22, 27, 34, 0.9);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 16px;
        }
        .modal-header { border-bottom-color: var(--border-color); }
        .modal-footer { border-top-color: var(--border-color); }

        /* --- Modern Refer & Earn UI Styles --- */
        .referral-container {
            padding: 1rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .referral-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 24px;
            padding: 2.5rem 2rem;
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(102, 126, 234, 0.3);
        }

        .referral-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(255,255,255,0.15) 0%, rgba(255,255,255,0.05) 100%);
            pointer-events: none;
        }

        .referral-header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            z-index: 1;
            gap: 2rem;
        }

        .referral-title-section {
            flex: 1;
        }

        .referral-title {
            color: white;
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .referral-subtitle {
            color: rgba(255,255,255,0.95);
            font-size: 1.1rem;
            margin: 0;
            font-weight: 400;
            line-height: 1.5;
        }

        .referral-header-icon {
            width: 80px;
            height: 80px;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2rem;
            backdrop-filter: blur(15px);
            border: 2px solid rgba(255,255,255,0.3);
            box-shadow: 0 8px 32px rgba(0,0,0,0.2);
        }

        /* Referral Overview Grid */
        .referral-overview-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
            margin-bottom: 2.5rem;
        }

        .referral-card {
            background: linear-gradient(180deg, rgba(22,27,34,0.98), rgba(22,27,34,0.92));
            border-radius: 20px;
            padding: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .referral-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--accent-color), #FBBF24, #10B981);
        }

        .referral-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 25px 50px rgba(0,0,0,0.4);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .referral-card-header {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .referral-icon {
            width: 60px;
            height: 60px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .total-earnings-card .referral-icon {
            background: linear-gradient(135deg, #10B981, #059669);
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
        }

        .successful-referrals-card .referral-icon {
            background: linear-gradient(135deg, #3B82F6, #1D4ED8);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.4);
        }

        .referral-icon::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            transform: rotate(45deg);
            transition: all 0.6s ease;
        }

        .referral-card:hover .referral-icon::before {
            transform: rotate(45deg) translate(50%, 50%);
        }

        .referral-info {
            flex: 1;
        }

        .referral-label {
            color: var(--text-primary);
            font-size: 1.1rem;
            font-weight: 600;
            margin: 0 0 0.75rem 0;
            letter-spacing: 0.5px;
        }

        .referral-amount {
            color: var(--text-primary);
            font-size: 2rem;
            font-weight: 800;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .referral-card-footer {
            border-top: 1px solid rgba(255,255,255,0.1);
            padding-top: 1.25rem;
        }

        .referral-source {
            color: var(--text-secondary);
            font-size: 0.9rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Referral Code Section */
        .referral-code-section {
            background: linear-gradient(180deg, rgba(22,27,34,0.98), rgba(22,27,34,0.92));
            border-radius: 20px;
            padding: 2.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 2.5rem;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .referral-code-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2);
        }

        .referral-code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .referral-code-title {
            color: var(--text-primary);
            font-size: 1.4rem;
            font-weight: 700;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .btn-copy-code {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border: none;
            border-radius: 12px;
            padding: 0.75rem 1.5rem;
            color: white;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .btn-copy-code:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 35px rgba(102, 126, 234, 0.6);
        }

        .btn-copy-code:active {
            transform: translateY(0);
        }

        .referral-code {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
            border: 2px solid rgba(102, 126, 234, 0.3);
            border-radius: 16px;
            padding: 1.5rem;
            text-align: center;
            margin-bottom: 1.5rem;
            position: relative;
            overflow: hidden;
        }

        .referral-code::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.05), transparent);
            transform: translateX(-100%);
            transition: transform 0.6s ease;
        }

        .referral-code:hover::before {
            transform: translateX(100%);
        }

        .referral-code span {
            font-family: 'Courier New', monospace;
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--text-primary);
            letter-spacing: 2px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .referral-code-subtitle {
            color: var(--text-secondary);
            font-size: 1rem;
            margin: 0;
            text-align: center;
            font-weight: 500;
            line-height: 1.5;
        }

        /* Referral History Section */
        .referral-history-section {
            background: linear-gradient(180deg, rgba(22,27,34,0.98), rgba(22,27,34,0.92));
            border-radius: 20px;
            padding: 2.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }

        .referral-history-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #10B981, #059669);
        }

        .referral-history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .history-title {
            color: var(--text-primary);
            font-size: 1.4rem;
            font-weight: 700;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .history-actions {
            display: flex;
            gap: 0.75rem;
        }

        .btn-refresh {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 12px;
            padding: 0.75rem 1.25rem;
            color: var(--text-secondary);
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            backdrop-filter: blur(10px);
        }

        .btn-refresh:hover {
            background: var(--accent-color);
            color: white;
            border-color: var(--accent-color);
            transform: translateY(-2px);
        }

        /* Referral History List */
        .referral-history-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .referral-history-item {
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 16px;
            padding: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .referral-history-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(180deg, #10B981, #059669);
            transform: scaleY(0);
            transition: transform 0.3s ease;
        }

        .referral-history-item:hover {
            background: rgba(255,255,255,0.05);
            border-color: rgba(255,255,255,0.15);
            transform: translateX(8px);
        }

        .referral-history-item:hover::before {
            transform: scaleY(1);
        }

        .referral-history-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #10B981, #059669);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .referral-history-content {
            flex: 1;
            min-width: 0;
        }

        .referral-history-name {
            color: var(--text-primary);
            font-size: 1.1rem;
            font-weight: 600;
            margin: 0 0 0.25rem 0;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .referral-history-email {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin: 0 0 0.5rem 0;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .referral-history-date {
            color: var(--text-secondary);
            font-size: 0.8rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .referral-history-status {
            background: linear-gradient(135deg, #10B981, #059669);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            flex-shrink: 0;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
        }

        /* Empty State */
        .empty-referral-state {
            text-align: center;
            padding: 3rem 2rem;
            color: var(--text-secondary);
        }

        .empty-referral-state i {
            font-size: 4rem;
            margin-bottom: 1.5rem;
            opacity: 0.5;
        }

        .empty-referral-state h4 {
            color: var(--text-primary);
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 0.75rem;
        }

        .empty-referral-state p {
            font-size: 1rem;
            line-height: 1.6;
            margin: 0;
        }

        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .referral-container {
                padding: 0.75rem;
            }
            
            .referral-header {
                padding: 2rem 1.5rem;
                border-radius: 20px;
                margin-bottom: 1.5rem;
            }
            
            .referral-title {
                font-size: 1.8rem;
            }
            
            .referral-subtitle {
                font-size: 1rem;
            }
            
            .referral-header-icon {
                width: 60px;
                height: 60px;
                font-size: 1.5rem;
            }
            
            .referral-overview-grid {
                gap: 1rem;
                margin-bottom: 2rem;
            }
            
            .referral-card {
                padding: 1.5rem;
            }
            
            .referral-code-section {
                padding: 2rem 1.5rem;
                margin-bottom: 2rem;
            }
            
            .referral-code-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }
            
            .btn-copy-code {
                width: 100%;
                justify-content: center;
            }
            
            .referral-code {
                padding: 1.25rem;
            }
            
            .referral-code span {
                font-size: 1.5rem;
                letter-spacing: 1px;
            }
            
            .referral-history-section {
                padding: 2rem 1.5rem;
            }
            
            .referral-history-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }
            
            .btn-refresh {
                width: 100%;
                justify-content: center;
            }
            
            .referral-history-item {
                padding: 1.25rem;
                flex-direction: column;
                text-align: center;
                gap: 1rem;
            }
            
            .referral-history-content {
                text-align: center;
            }
            
            .referral-history-status {
                align-self: center;
            }
        }

        @media (min-width: 768px) {
            .referral-overview-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 1024px) {
            .referral-overview-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Enhanced Visual Effects */
        .referral-header::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: float 6s ease-in-out infinite;
            pointer-events: none;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            33% { transform: translate(30px, -30px) rotate(120deg); }
            66% { transform: translate(-20px, 20px) rotate(240deg); }
        }

        /* Enhanced Card Interactions */
        .referral-card {
            position: relative;
            overflow: hidden;
        }

        .referral-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.5s ease;
        }

        .referral-card:hover::after {
            left: 100%;
        }

        /* Enhanced Referral Code */
        .referral-code {
            position: relative;
            overflow: hidden;
        }

        .referral-code::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.1) 50%, transparent 70%);
            transform: translateX(-100%);
            transition: transform 0.6s ease;
        }

        .referral-code:hover::after {
            transform: translateX(100%);
        }

        /* Enhanced History Items */
        .referral-history-item {
            position: relative;
            overflow: hidden;
        }

        .referral-history-item::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(16, 185, 129, 0.05), transparent);
            transform: translateX(-100%);
            transition: transform 0.6s ease;
        }

        .referral-history-item:hover::after {
            transform: translateX(100%);
        }

        /* Enhanced Share Buttons */
        .share-option-btn {
            position: relative;
            overflow: hidden;
        }

        .share-option-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.3s ease, height 0.3s ease;
        }

        .share-option-btn:hover::before {
            width: 200%;
            height: 200%;
        }

        .share-option-btn span {
            position: relative;
            z-index: 1;
        }

        /* --- Modern Stats UI Styles --- */
        .stats-container {
            padding: 1rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .stats-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 24px;
            padding: 2.5rem 2rem;
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(102, 126, 234, 0.3);
        }

        .stats-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(255,255,255,0.15) 0%, rgba(255,255,255,0.05) 100%);
            pointer-events: none;
        }

        .stats-header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            z-index: 1;
            gap: 2rem;
        }

        .stats-title-section {
            flex: 1;
        }

        .stats-title {
            color: white;
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .stats-subtitle {
            color: rgba(255,255,255,0.95);
            font-size: 1.1rem;
            margin: 0;
            font-weight: 400;
            line-height: 1.5;
        }

        .stats-header-icon {
            width: 80px;
            height: 80px;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2rem;
            backdrop-filter: blur(15px);
            border: 2px solid rgba(255,255,255,0.3);
            box-shadow: 0 8px 32px rgba(0,0,0,0.2);
        }

        /* Stats Sections */
        .stats-performance-section,
        .stats-earnings-section {
            background: linear-gradient(180deg, rgba(22,27,34,0.98), rgba(22,27,34,0.92));
            border-radius: 20px;
            padding: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .stats-performance-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #3B82F6, #1D4ED8);
        }

        .stats-earnings-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #10B981, #059669);
        }

        .stats-section-title {
            color: var(--text-primary);
            font-size: 1.4rem;
            font-weight: 700;
            margin: 0 0 1.5rem 0;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .stats-section-title i {
            color: var(--accent-color);
            font-size: 1.2rem;
        }

        /* Stats Grid Layouts */
        .stats-performance-grid,
        .stats-earnings-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }

        /* Stats Cards */
        .stats-card {
            background: linear-gradient(180deg, rgba(22,27,34,0.95), rgba(22,27,34,0.85));
            border-radius: 16px;
            padding: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.08);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .stats-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--accent-color), #FBBF24);
        }

        .stats-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 25px 50px rgba(0,0,0,0.4);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .stats-card-header {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .stats-icon {
            width: 60px;
            height: 60px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
            position: relative;
            overflow: hidden;
        }

        /* Card-specific icon colors */
        .tournaments-joined-card .stats-icon {
            background: linear-gradient(135deg, #3B82F6, #1D4ED8);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.4);
        }

        .matches-played-card .stats-icon {
            background: linear-gradient(135deg, #8B5CF6, #7C3AED);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.4);
        }

        .matches-won-card .stats-icon {
            background: linear-gradient(135deg, #F59E0B, #D97706);
            box-shadow: 0 8px 25px rgba(245, 158, 11, 0.4);
        }

        .win-rate-card .stats-icon {
            background: linear-gradient(135deg, #10B981, #059669);
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
        }

        .tournament-winnings-card .stats-icon {
            background: linear-gradient(135deg, #F59E0B, #D97706);
            box-shadow: 0 8px 25px rgba(245, 158, 11, 0.4);
        }

        .referral-winnings-card .stats-icon {
            background: linear-gradient(135deg, #EC4899, #DB2777);
            box-shadow: 0 8px 25px rgba(236, 72, 153, 0.4);
        }

        .entry-fees-card .stats-icon {
            background: linear-gradient(135deg, #6B7280, #4B5563);
            box-shadow: 0 8px 25px rgba(107, 114, 128, 0.4);
        }

        .net-earnings-card .stats-icon {
            background: linear-gradient(135deg, #10B981, #059669);
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
        }

        .stats-icon::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            transform: rotate(45deg);
            transition: all 0.6s ease;
        }

        .stats-card:hover .stats-icon::before {
            transform: rotate(45deg) translate(50%, 50%);
        }

        .stats-info {
            flex: 1;
        }

        .stats-label {
            color: var(--text-primary);
            font-size: 1rem;
            font-weight: 600;
            margin: 0 0 0.75rem 0;
            letter-spacing: 0.5px;
        }

        .stats-amount {
            color: var(--text-primary);
            font-size: 2rem;
            font-weight: 800;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Stats Card Footer */
        .stats-card-footer {
            border-top: 1px solid rgba(255,255,255,0.1);
            padding-top: 1.25rem;
        }

        .stats-trend {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.85rem;
            font-weight: 500;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            width: fit-content;
        }

        .stats-trend.positive {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(5, 150, 105, 0.2));
            color: #10B981;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .stats-trend.neutral {
            background: linear-gradient(135deg, rgba(107, 114, 128, 0.2), rgba(75, 85, 99, 0.2));
            color: #9CA3AF;
            border: 1px solid rgba(107, 114, 128, 0.3);
        }

        .stats-trend i {
            font-size: 0.8rem;
        }

        /* Win Rate Progress */
        .win-rate-progress {
            text-align: center;
        }

        .win-rate-progress .progress {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 0.75rem;
        }

        .win-rate-progress .progress-bar {
            background: linear-gradient(90deg, #10B981, #059669);
            border-radius: 10px;
            transition: width 0.8s ease;
        }

        .win-rate-label {
            color: var(--text-secondary);
            font-size: 0.8rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Stats Summary Section */
        .stats-summary-section {
            background: linear-gradient(180deg, rgba(22,27,34,0.98), rgba(22,27,34,0.92));
            border-radius: 20px;
            padding: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .stats-summary-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #F59E0B, #D97706);
        }

        .stats-summary-card {
            position: relative;
            z-index: 1;
        }

        .summary-header {
            margin-bottom: 1.5rem;
        }

        .summary-title {
            color: var(--text-primary);
            font-size: 1.2rem;
            font-weight: 700;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .summary-title i {
            color: #F59E0B;
        }

        .summary-content {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background: rgba(255,255,255,0.03);
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.08);
            transition: all 0.3s ease;
        }

        .summary-item:hover {
            background: rgba(255,255,255,0.05);
            border-color: rgba(255,255,255,0.15);
            transform: translateX(8px);
        }

        .summary-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
            font-weight: 500;
        }

        .summary-value {
            color: var(--text-primary);
            font-size: 1rem;
            font-weight: 600;
        }

        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .stats-container {
                padding: 0.75rem;
            }
            
            .stats-header {
                padding: 2rem 1.5rem;
                border-radius: 20px;
                margin-bottom: 1.5rem;
            }
            
            .stats-title {
                font-size: 1.8rem;
            }
            
            .stats-subtitle {
                font-size: 1rem;
            }
            
            .stats-header-icon {
                width: 60px;
                height: 60px;
                font-size: 1.5rem;
            }
            
            .stats-performance-section,
            .stats-earnings-section,
            .stats-summary-section {
                padding: 1.5rem;
                border-radius: 16px;
                margin-bottom: 1.5rem;
            }
            
            .stats-performance-grid,
            .stats-earnings-grid {
                gap: 1rem;
            }
            
            .stats-card {
                padding: 1.25rem;
            }
            
            .stats-card-header {
                gap: 1rem;
                margin-bottom: 1.25rem;
            }
            
            .stats-icon {
                width: 50px;
                height: 50px;
                font-size: 1.3rem;
            }
            
            .stats-amount {
                font-size: 1.5rem;
            }
            
            .summary-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
                text-align: left;
            }
        }

        @media (min-width: 768px) {
            .stats-performance-grid,
            .stats-earnings-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 1024px) {
            .stats-performance-grid,
            .stats-earnings-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Enhanced Visual Effects */
        .stats-header::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: float 6s ease-in-out infinite;
            pointer-events: none;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            33% { transform: translate(30px, -30px) rotate(120deg); }
            66% { transform: translate(-20px, 20px) rotate(240deg); }
        }

        /* Enhanced Card Interactions */
        .stats-card {
            position: relative;
            overflow: hidden;
        }

        .stats-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.5s ease;
        }

        .stats-card:hover::after {
            left: 100%;
        }

        /* Enhanced Stats Amount Animation */
        .stats-amount {
            background-size: 200% 200%;
            animation: gradientShift 3s ease infinite;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Enhanced Summary Items */
        .summary-item {
            position: relative;
            overflow: hidden;
        }

        .summary-item::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(245, 158, 11, 0.05), transparent);
            transform: translateX(-100%);
            transition: transform 0.6s ease;
        }

        .summary-item:hover::after {
            transform: translateX(100%);
        }

        /* Animation Classes */
        .stats-card.animate-in {
            animation: slideInUp 0.6s ease-out;
        }

        .stats-performance-section.animate-in {
            animation: slideInUp 0.6s ease-out 0.1s both;
        }

        .stats-earnings-section.animate-in {
            animation: slideInUp 0.6s ease-out 0.2s both;
        }

        .stats-summary-section.animate-in {
            animation: slideInUp 0.6s ease-out 0.3s both;
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Loading States */
        .stats-loading {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 3rem;
            color: var(--text-secondary);
        }

        .stats-loading .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(255,255,255,0.1);
            border-top: 3px solid var(--accent-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* --- Modern Profile UI Styles --- */
        .profile-container {
            padding: 1rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .profile-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 24px;
            padding: 2.5rem 2rem;
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(102, 126, 234, 0.3);
        }

        .profile-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(255,255,255,0.15) 0%, rgba(255,255,255,0.05) 100%);
            pointer-events: none;
        }

        .profile-header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            z-index: 1;
            gap: 2rem;
        }

        .profile-avatar-section {
            display: flex;
            align-items: center;
            gap: 2rem;
        }

        .profile-avatar-container {
            position: relative;
            width: 100px;
            height: 100px;
        }

        .profile-avatar {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid rgba(255,255,255,0.3);
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
        }

        .profile-edit-overlay {
            position: absolute;
            bottom: 0;
            right: 0;
            background: rgba(255,255,255,0.9);
            border-radius: 50%;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .profile-edit-overlay:hover {
            background: white;
            transform: scale(1.1);
        }

        .btn-edit-avatar {
            background: none;
            border: none;
            color: #667eea;
            font-size: 1rem;
            cursor: pointer;
            padding: 0;
        }

        .profile-info {
            color: white;
        }

        .profile-name {
            font-size: 2rem;
            font-weight: 800;
            margin: 0 0 0.5rem 0;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .profile-email {
            font-size: 1.1rem;
            margin: 0 0 1rem 0;
            opacity: 0.9;
        }

        .profile-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .status-badge {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            background: rgba(255,255,255,0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.3);
        }

        .status-badge.online {
            background: rgba(16, 185, 129, 0.2);
            color: #10B981;
            border-color: rgba(16, 185, 129, 0.3);
        }

        .status-badge i {
            font-size: 0.8rem;
            color: #10B981;
        }

        .profile-actions {
            display: flex;
            gap: 1rem;
        }

        .btn-profile-action {
            background: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 12px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            backdrop-filter: blur(10px);
        }

        .btn-profile-action:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }

        /* Profile Stats Overview */
        .profile-stats-overview {
            background: linear-gradient(180deg, rgba(22,27,34,0.98), rgba(22,27,34,0.92));
            border-radius: 20px;
            padding: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .profile-stats-overview::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #F59E0B, #D97706);
        }

        .stats-overview-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }

        .stat-overview-card {
            background: linear-gradient(180deg, rgba(22,27,34,0.95), rgba(22,27,34,0.85));
            border-radius: 16px;
            padding: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.08);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .stat-overview-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--accent-color), #FBBF24);
        }

        .stat-overview-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 25px 50px rgba(0,0,0,0.4);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .stat-overview-icon {
            width: 60px;
            height: 60px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
            position: relative;
            overflow: hidden;
            flex-shrink: 0;
        }

        /* Card-specific icon colors */
        .stat-overview-card.matches-played .stat-overview-icon {
            background: linear-gradient(135deg, #3B82F6, #1D4ED8);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.4);
        }

        .stat-overview-card.matches-won .stat-overview-icon {
            background: linear-gradient(135deg, #F59E0B, #D97706);
            box-shadow: 0 8px 25px rgba(245, 158, 11, 0.4);
        }

        .stat-overview-card.total-earnings .stat-overview-icon {
            background: linear-gradient(135deg, #10B981, #059669);
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
        }

        .stat-overview-card.tournaments-joined .stat-overview-icon {
            background: linear-gradient(135deg, #8B5CF6, #7C3AED);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.4);
        }

        .stat-overview-content {
            flex: 1;
            min-width: 0;
        }

        .stat-overview-value {
            color: var(--text-primary);
            font-size: 1.8rem;
            font-weight: 800;
            margin: 0 0 0.5rem 0;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-overview-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
            font-weight: 500;
            margin: 0;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stat-overview-trend {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.8rem;
            font-weight: 600;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            background: rgba(16, 185, 129, 0.2);
            color: #10B981;
            border: 1px solid rgba(16, 185, 129, 0.3);
            flex-shrink: 0;
        }

        .stat-overview-trend i {
            font-size: 0.7rem;
        }

        /* Profile Menu */
        .profile-menu {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .menu-section {
            background: linear-gradient(180deg, rgba(22,27,34,0.98), rgba(22,27,34,0.92));
            border-radius: 20px;
            padding: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .menu-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--accent-color), #FBBF24);
        }

        .menu-section-title {
            color: var(--text-primary);
            font-size: 1.3rem;
            font-weight: 700;
            margin: 0 0 1.5rem 0;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .menu-section-title i {
            color: var(--accent-color);
            font-size: 1.1rem;
        }

        /* Quick Actions Section */
        .quick-actions-section .quick-actions-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
        }

        .quick-action-card {
            background: linear-gradient(180deg, rgba(22,27,34,0.95), rgba(22,27,34,0.85));
            border-radius: 16px;
            padding: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.08);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            text-decoration: none;
            color: var(--text-primary);
            cursor: pointer;
        }

        .quick-action-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--accent-color), #FBBF24);
        }

        .quick-action-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 25px 50px rgba(0,0,0,0.4);
            border-color: rgba(255, 255, 255, 0.2);
            text-decoration: none;
            color: var(--text-primary);
        }

        .quick-action-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            color: white;
            margin-bottom: 1rem;
        }

        .quick-action-card .earnings-icon {
            background: linear-gradient(135deg, #F59E0B, #D97706);
        }

        .quick-action-card .referral-icon {
            background: linear-gradient(135deg, #EC4899, #DB2777);
        }

        .quick-action-card .stats-icon {
            background: linear-gradient(135deg, #3B82F6, #1D4ED8);
        }

        .quick-action-card .wallet-icon {
            background: linear-gradient(135deg, #10B981, #059669);
        }

        .quick-action-title {
            font-size: 1.1rem;
            font-weight: 700;
            margin: 0 0 0.5rem 0;
            color: var(--text-primary);
        }

        .quick-action-subtitle {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin: 0;
            line-height: 1.4;
        }

        /* Menu Items */
        .menu-items {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .menu-item {
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 16px;
            padding: 1.25rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            text-decoration: none;
            color: var(--text-primary);
        }

        .menu-item:hover {
            background: rgba(255,255,255,0.05);
            border-color: rgba(255,255,255,0.15);
            transform: translateX(8px);
            text-decoration: none;
            color: var(--text-primary);
        }

        .menu-item-content {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .menu-item-icon {
            width: 45px;
            height: 45px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: white;
            background: rgba(255,255,255,0.1);
        }

        .menu-item-icon.earnings-icon {
            background: linear-gradient(135deg, #F59E0B, #D97706);
        }

        .menu-item-icon.referral-icon {
            background: linear-gradient(135deg, #EC4899, #DB2777);
        }

        .menu-item-icon.stats-icon {
            background: linear-gradient(135deg, #3B82F6, #1D4ED8);
        }

        .menu-item-icon.legal-icon {
            background: linear-gradient(135deg, #6B7280, #4B5563);
        }

        .menu-item-icon.logout-icon {
            background: linear-gradient(135deg, #EF4444, #DC2626);
        }

        .menu-item-text h6 {
            font-size: 1rem;
            font-weight: 600;
            margin: 0 0 0.25rem 0;
            color: var(--text-primary);
        }

        .menu-item-text p {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin: 0;
            line-height: 1.4;
        }

        .menu-item-action {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }

        /* Form Switch Styling */
        .form-check-input {
            background-color: rgba(255,255,255,0.1);
            border-color: rgba(255,255,255,0.2);
            width: 3rem;
            height: 1.5rem;
        }

        .form-check-input:checked {
            background-color: var(--accent-color);
            border-color: var(--accent-color);
        }

        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .profile-container {
                padding: 0.75rem;
            }
            
            .profile-header {
                padding: 2rem 1.5rem;
                border-radius: 20px;
                margin-bottom: 1.5rem;
            }
            
            .profile-header-content {
                flex-direction: column;
                gap: 1.5rem;
                text-align: center;
            }
            
            .profile-avatar-section {
                flex-direction: column;
                gap: 1.5rem;
                text-align: center;
            }
            
            .profile-avatar-container {
                width: 80px;
                height: 80px;
            }
            
            .profile-name {
                font-size: 1.8rem;
            }
            
            .profile-email {
                font-size: 1rem;
            }
            
            .profile-stats-overview {
                padding: 1.5rem;
                border-radius: 16px;
                margin-bottom: 1.5rem;
            }
            
            .stats-overview-grid {
                gap: 1rem;
            }
            
            .stat-overview-card {
                padding: 1.25rem;
                flex-direction: column;
                text-align: center;
                gap: 1rem;
            }
            
            .stat-overview-icon {
                width: 50px;
                height: 50px;
                font-size: 1.3rem;
            }
            
            .stat-overview-value {
                font-size: 1.5rem;
            }
            
            .stat-overview-trend {
                align-self: center;
            }
            
            .menu-section {
                padding: 1.5rem;
                border-radius: 16px;
            }
            
            .quick-actions-grid {
                gap: 0.75rem;
            }
            
            .quick-action-card {
                padding: 1.25rem;
                text-align: center;
            }
            
            .quick-action-icon {
                margin: 0 auto 1rem auto;
            }
            
            .menu-item {
                padding: 1rem;
            }
            
            .menu-item-content {
                gap: 0.75rem;
            }
            
            .menu-item-icon {
                width: 40px;
                height: 40px;
                font-size: 1.1rem;
            }
        }

        @media (min-width: 768px) {
            .stats-overview-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .quick-actions-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 1024px) {
            .stats-overview-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .quick-actions-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        /* Enhanced Visual Effects */
        .profile-header::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: float 6s ease-in-out infinite;
            pointer-events: none;
        }

        /* Enhanced Card Interactions */
        .stat-overview-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.5s ease;
        }

        .stat-overview-card:hover::after {
            left: 100%;
        }

        .quick-action-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.5s ease;
        }

        .quick-action-card:hover::after {
            left: 100%;
        }

        /* Enhanced Menu Items */
        .menu-item::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(88, 166, 255, 0.05), transparent);
            transform: translateX(-100%);
            transition: transform 0.6s ease;
        }

        .menu-item:hover::after {
            transform: translateX(100%);
        }

        /* Animation Classes */
        .stat-overview-card.animate-in {
            animation: slideInUp 0.6s ease-out;
        }

        .quick-action-card.animate-in {
            animation: slideInUp 0.6s ease-out 0.1s both;
        }

        .menu-section.animate-in {
            animation: slideInUp 0.6s ease-out 0.2s both;
        }



        /* Enhanced Animations for Mobile */
        @media (max-width: 768px) {
            .referral-card:hover {
                transform: translateY(-4px);
            }
            

            
            @keyframes pulse {
                0% { box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4); }
                50% { box-shadow: 0 8px 25px rgba(102, 126, 234, 0.8); }
                100% { box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4); }
            }
        }

        /* Animation Classes */
        .referral-card.animate-in {
            animation: slideInUp 0.6s ease-out;
        }

        .referral-code-section.animate-in {
            animation: slideInUp 0.6s ease-out 0.1s both;
        }

        .referral-history-section.animate-in {
            animation: slideInUp 0.6s ease-out 0.2s both;
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Loading States */
        .referral-loading {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 3rem;
            color: var(--text-secondary);
        }

        .referral-loading .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(255,255,255,0.1);
            border-top: 3px solid var(--accent-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Enhanced Referral UI Elements */
        .referral-share-options {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .share-option-btn {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 12px;
            padding: 0.75rem 1.25rem;
            color: var(--text-secondary);
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            backdrop-filter: blur(10px);
            text-decoration: none;
        }

        .share-option-btn:hover {
            background: var(--accent-color);
            color: white;
            border-color: var(--accent-color);
            transform: translateY(-2px);
            text-decoration: none;
        }

        .share-option-btn.whatsapp:hover {
            background: #25D366;
            border-color: #25D366;
        }

        .share-option-btn.telegram:hover {
            background: #0088cc;
            border-color: #0088cc;
        }

        .share-option-btn.copy:hover {
            background: #10B981;
            border-color: #10B981;
        }

        /* Success Animation */
        .copy-success {
            animation: copySuccess 0.6s ease-out;
        }

        @keyframes copySuccess {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        /* Enhanced Card Hover Effects */
        .referral-card:hover .referral-icon {
            transform: scale(1.1);
        }

        .referral-icon {
            transition: transform 0.3s ease;
        }

        /* Gradient Text Animation */
        .referral-amount {
            background-size: 200% 200%;
            animation: gradientShift 3s ease infinite;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }



        /* --- Modern Earnings UI Styles --- */
        .earnings-container {
            padding: 1rem;
        }

        .earnings-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
        }

        .earnings-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
            pointer-events: none;
        }

        .earnings-header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            z-index: 1;
        }

        .earnings-title-section {
            flex: 1;
        }

        .earnings-title {
            color: white;
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .earnings-subtitle {
            color: rgba(255,255,255,0.9);
            font-size: 1rem;
            margin: 0;
        }

        .earnings-header-icon {
            width: 60px;
            height: 60px;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            backdrop-filter: blur(10px);
        }

        /* Earnings Overview Grid */
        .earnings-overview-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .earnings-card {
            background: linear-gradient(180deg, rgba(22,27,34,0.95), rgba(22,27,34,0.85));
            border-radius: 16px;
            padding: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.08);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .earnings-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--accent-color), #FBBF24);
        }

        .earnings-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }

        .earnings-card-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .earnings-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            color: white;
        }

        .total-winnings-card .earnings-icon {
            background: linear-gradient(135deg, #2ed573, #1e90ff);
        }

        .referral-earnings-card .earnings-icon {
            background: linear-gradient(135deg, #3498db, #2980b9);
        }

        .net-earnings-card .earnings-icon {
            background: linear-gradient(135deg, #f39c12, #e67e22);
        }

        .earnings-info {
            flex: 1;
        }

        .earnings-label {
            color: var(--text-primary);
            font-size: 1rem;
            font-weight: 600;
            margin: 0 0 0.5rem 0;
        }

        .earnings-amount {
            color: var(--text-primary);
            font-size: 1.5rem;
            font-weight: 700;
        }

        .earnings-card-footer {
            border-top: 1px solid rgba(255,255,255,0.08);
            padding-top: 1rem;
        }

        .earnings-source {
            color: var(--text-secondary);
            font-size: 0.85rem;
            font-weight: 500;
        }

        /* Earnings Actions */
        .earnings-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .btn-view-history,
        .btn-view-tournaments {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border: none;
            border-radius: 12px;
            padding: 1rem;
            color: white;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .btn-view-history:hover,
        .btn-view-tournaments:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        /* Earnings History Section */
        .earnings-history-section {
            background: linear-gradient(180deg, rgba(22,27,34,0.95), rgba(22,27,34,0.85));
            border-radius: 16px;
            padding: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .earnings-history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .history-title {
            color: var(--text-primary);
            font-size: 1.2rem;
            font-weight: 600;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .history-filter {
            display: flex;
            gap: 0.5rem;
        }

        .filter-btn {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 8px;
            padding: 0.5rem 1rem;
            color: var(--text-secondary);
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .filter-btn.active,
        .filter-btn:hover {
            background: var(--accent-color);
            color: white;
            border-color: var(--accent-color);
        }

        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .earnings-header {
                padding: 1.5rem;
                border-radius: 16px;
            }
            
            .earnings-title {
                font-size: 1.5rem;
            }
            
            .earnings-overview-grid {
                gap: 0.75rem;
            }
            
            .earnings-card {
                padding: 1.25rem;
            }
            
            .earnings-actions {
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }
            
            .earnings-history-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .history-filter {
                width: 100%;
                justify-content: space-between;
            }
        }

        @media (min-width: 768px) {
            .earnings-overview-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        /* --- Compact Mobile Earnings UI Styles --- */
        .compact-earnings-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            position: relative;
            overflow: hidden;
        }

        .compact-earnings-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
            pointer-events: none;
        }

        .earnings-main-info {
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            z-index: 1;
        }

        .earnings-title-section {
            flex: 1;
        }

        .earnings-title {
            color: white;
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .earnings-subtitle {
            color: rgba(255,255,255,0.9);
            font-size: 0.9rem;
            margin: 0;
        }

        .earnings-header-icon {
            width: 50px;
            height: 50px;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.3rem;
            backdrop-filter: blur(10px);
        }

        /* Compact Stats Row */
        .compact-earnings-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .compact-earnings-stat {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1rem;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .compact-earnings-stat::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, var(--accent-color), #FBBF24);
        }

        .compact-earnings-stat:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .compact-earnings-stat i {
            font-size: 1.5rem;
            color: var(--accent-color);
            margin-bottom: 0.5rem;
            display: block;
        }

        .compact-earnings-value {
            display: block;
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }

        .compact-earnings-label {
            display: block;
            font-size: 0.75rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        /* Compact Quick Actions */
        .compact-earnings-actions {
            margin-bottom: 1rem;
        }

        .compact-earnings-actions .actions-row {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 0.75rem;
        }

        .compact-earnings-action {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1rem 0.75rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
        }

        .compact-earnings-action:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            border-color: var(--accent-color);
        }

        .compact-earnings-action:active {
            transform: translateY(0);
        }

        .compact-earnings-action i {
            font-size: 1.3rem;
            color: var(--accent-color);
        }

        .compact-earnings-action span {
            font-size: 0.75rem;
            color: var(--text-primary);
            font-weight: 500;
        }

        /* Compact Earnings History */
        .compact-earnings-history {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 1.25rem;
        }

        .compact-earnings-history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            flex-wrap: wrap;
            gap: 0.75rem;
        }

        .compact-earnings-history .history-title {
            color: var(--text-primary);
            font-size: 1.1rem;
            font-weight: 600;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .compact-earnings-history .history-filter {
            display: flex;
            gap: 0.5rem;
        }

        .compact-earnings-history .filter-btn {
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 0.4rem 0.8rem;
            color: var(--text-secondary);
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .compact-earnings-history .filter-btn.active,
        .compact-earnings-history .filter-btn:hover {
            background: var(--accent-color);
            color: white;
            border-color: var(--accent-color);
        }

        .compact-earnings-list {
            max-height: 300px;
            overflow-y: auto;
        }

        .compact-earnings-placeholder {
            padding: 1rem 0;
        }

        /* Mobile Responsiveness for Compact Earnings */
        @media (max-width: 480px) {
            .compact-earnings-header {
                padding: 1.25rem;
                border-radius: 12px;
            }
            
            .earnings-title {
                font-size: 1.2rem;
            }
            
            .earnings-subtitle {
                font-size: 0.8rem;
            }
            
            .compact-earnings-stats {
                gap: 0.5rem;
            }
            
            .compact-earnings-stat {
                padding: 0.75rem;
            }
            
            .compact-earnings-stat i {
                font-size: 1.3rem;
            }
            
            .compact-earnings-value {
                font-size: 1.1rem;
            }
            
            .compact-earnings-label {
                font-size: 0.7rem;
            }
            
            .compact-earnings-actions .actions-row {
                gap: 0.5rem;
            }
            
            .compact-earnings-action {
                padding: 0.75rem 0.5rem;
            }
            
            .compact-earnings-action i {
                font-size: 1.2rem;
            }
            
            .compact-earnings-action span {
                font-size: 0.7rem;
            }
            
            .compact-earnings-history {
                padding: 1rem;
                border-radius: 12px;
            }
            
            .compact-earnings-history-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .compact-earnings-history .history-filter {
                width: 100%;
                justify-content: space-between;
            }
        }

        @media (max-width: 768px) {
            .compact-earnings-stats {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .compact-earnings-actions .actions-row {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        /* --- Existing Styles (keep for compatibility) --- */
        /* ... (The styles below are mostly the same, ensuring things don't break) ... */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { font-size: 16px; }
        body { font-family: 'Poppins', sans-serif; background-color: var(--primary-bg); color: var(--text-primary); padding-top: 70px; padding-bottom: 75px; min-height: 100vh; overscroll-behavior-y: contain; }
        a { color: var(--accent-color); text-decoration: none; } a:hover { color: #FBBF24; }
        .main-content { padding: 15px; } .section { display: none; animation: fadeIn 0.3s ease-in-out; } .section.active { display: block; } @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .section-title { font-size: 1.1rem; font-weight: 600; margin-bottom: 15px; color: var(--text-primary); } .custom-card { background-color: var(--card-bg); border-radius: 10px; padding: 15px; margin-bottom: 15px; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1); border: 1px solid var(--border-color); } .btn-custom { border-radius: 6px; font-size: 0.9rem; font-weight: 500; padding: 8px 15px; border: none; display: inline-flex; align-items: center; justify-content: center; gap: 5px; transition: background-color 0.2s ease, filter 0.2s ease; } .btn-custom-primary { background-color: var(--primary-button-bg); color: var(--text-primary); } .btn-custom-primary:hover { background-color: #2563EB; } .btn-custom-secondary { background-color: var(--secondary-bg); color: var(--text-primary); border: 1px solid var(--border-color); } .btn-custom-secondary:hover { background-color: #334155; } .btn-custom-accent { background: var(--accent-gradient); color: var(--primary-bg); font-weight: 600; } .btn-custom-accent:hover { filter: brightness(1.1); } .btn-custom-link { background: none; border: none; color: var(--primary-button-bg); font-size: 0.9rem; font-weight: 500; padding: 0; cursor: pointer; } .text-accent { color: var(--accent-color); } .text-success { color: var(--success-color); } .text-danger { color: var(--danger-color); } .text-warning { color: var(--warning-color); } .form-control { background-color: var(--primary-bg); border: 1px solid var(--border-color); color: var(--text-primary); border-radius: 6px; } .form-control:focus { background-color: var(--primary-bg); border-color: var(--accent-color); color: var(--text-primary); box-shadow: 0 0 0 0.2rem rgba(88, 166, 255, 0.25); } .form-control::placeholder { color: var(--text-secondary); opacity: 0.7; } .form-label { color: var(--text-secondary); font-size: 0.9rem; } .alert { border-radius: 6px; font-size: 0.9rem; } .list-group-item { background-color: var(--card-bg); color: var(--text-primary); border: none; border-bottom: 1px solid var(--border-color); padding: 15px; font-size: 0.95rem; transition: background-color 0.2s ease; } .list-group-item:hover { background-color: rgba(255, 255, 255, 0.05); } .list-group-item:last-child { border-bottom: none; } .list-group-item i:first-child { color: var(--accent-color); margin-right: 15px; font-size: 1.1rem; width: 20px; text-align: center; } .list-group-item .bi-chevron-right { color: var(--text-secondary); font-size: 0.9rem; } #globalLoaderEl { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.6); display: flex; justify-content: center; align-items: center; z-index: 9999; display: none; } .spinner-border { color: var(--accent-color); width: 3rem; height: 3rem; } .placeholder-glow .placeholder { background-color: rgba(51, 65, 85, 0.5); animation: placeholder-glow 2s ease-in-out infinite; } .placeholder { background-color: rgba(51, 65, 85, 0.5); border-radius: 4px; } @keyframes placeholder-glow { 0% { background-color: rgba(51, 65, 85, 0.5); } 50% { background-color: rgba(51, 65, 85, 0.7); } 100% { background-color: rgba(51, 65, 85, 0.5); } } .interactive-list-item { cursor: pointer; } .referral-code { font-family: monospace; letter-spacing: 1px; user-select: all; } .app-header { position: fixed; top: 0; left: 0; width: 100%; height: 60px; background-color: var(--secondary-bg); display: flex; align-items: center; justify-content: space-between; padding: 0 15px; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2); z-index: 1000; } .header-left { display: flex; align-items: center; gap: 10px; } .header-logo { width: 40px; height: 40px; border-radius: 50%; background-color: #fff; object-fit: cover; border: 1px solid var(--accent-color); } .header-title { font-size: 0.9rem; font-weight: 500; line-height: 1.2; } .header-title span { font-size: 0.75rem; color: var(--text-secondary); display: block; } .header-back-button { background: none; border: none; color: var(--text-primary); font-size: 1.4rem; margin-right: 5px; display: none; padding: 5px; } .header-right { display: flex; align-items: center; gap: 15px; } .notification-icon { font-size: 1.3rem; color: var(--text-primary); position: relative; background: none; border: none; padding: 0; } .notification-badge { position: absolute; top: -3px; right: -5px; background-color: var(--danger-color); color: white; font-size: 0.6rem; width: 15px; height: 15px; border-radius: 50%; display: flex; justify-content: center; align-items: center; font-weight: bold; } .wallet-chip { background: var(--accent-gradient); color: var(--primary-bg); padding: 5px 12px; border-radius: 20px; display: flex; align-items: center; font-size: 0.85rem; font-weight: 700; border: none; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2); cursor: pointer; } .wallet-chip i { margin-right: 5px; font-size: 0.9rem; } .header-game-title { font-size: 1rem; font-weight: 600; color: var(--text-primary); margin-left: 10px; display: none; } .bottom-nav { position: fixed; bottom: 0; left: 0; width: 100%; height: 65px; background-color: var(--bottom-nav-bg); display: flex; justify-content: space-around; align-items: stretch; box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.2); z-index: 1000; border-top: 1px solid var(--border-color); } .nav-item { display: flex; flex-direction: column; align-items: center; justify-content: center; color: var(--text-secondary); text-decoration: none; flex-grow: 1; padding: 8px 0; transition: color 0.2s ease, background-color 0.2s ease; border: none; background: none; cursor: pointer; font-size: 0.7rem; } .nav-item i { font-size: 1.4rem; margin-bottom: 4px; line-height: 1; } .nav-item span { font-size: 0.7rem; font-weight: 500; line-height: 1; } .nav-item.active { color: var(--accent-color); background-color: rgba(88, 166, 255, 0.1); } .swiper-container#promotionSliderEl { width: 100%; height: 200px; border-radius: 10px; margin-bottom: 25px; --swiper-pagination-color: var(--accent-color); --swiper-pagination-bullet-inactive-color: var(--text-secondary); --swiper-pagination-bullet-size: 8px; } .swiper-slide { background-color: var(--secondary-bg); border-radius: 10px; } .swiper-slide img { display: block; width: 100%; height: 100%; object-fit: cover; border-radius: 10px; } .game-card { text-align: center; background-color: var(--card-bg); border-radius: 8px; overflow: hidden; padding: 0; border: 1px solid var(--border-color); cursor: pointer; transition: transform 0.2s ease; } .game-card:hover { transform: translateY(-3px); box-shadow: 0 4px 8px rgba(0,0,0,0.2); } .game-card img { width: 100%; height: 130px; object-fit: cover; display: block; } .game-card span { display: block; padding: 10px 5px; font-weight: 500; font-size: 0.9rem; color: var(--text-primary); } .tournament-tabs { display: flex; justify-content: space-around; background-color: var(--secondary-bg); padding: 5px; border-radius: 8px; margin-bottom: 15px; } .tab-item { color: var(--text-secondary); background: none; border: none; padding: 8px 10px; font-size: 0.85rem; font-weight: 600; border-radius: 6px; flex-grow: 1; text-align: center; cursor: pointer; transition: background-color 0.2s, color 0.2s; } .tab-item.active { background-color: var(--primary-button-bg); color: var(--text-primary); } .tab-item i { margin-right: 5px; } .tournament-card { background-color: var(--card-bg); border-radius: 12px; margin-bottom: 15px; padding: 15px; border: 1px solid var(--border-color); } .tournament-card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; flex-wrap: wrap; gap: 5px; } .tournament-card-tags span { background-color: var(--primary-bg); color: var(--text-secondary); font-size: 0.7rem; font-weight: 500; padding: 3px 8px; border-radius: 4px; display: inline-block; border: 1px solid var(--border-color); margin-right: 4px; margin-bottom: 4px; } .tournament-card-timer { background-color: rgba(255, 255, 255, 0.1); color: var(--text-primary); font-size: 0.75rem; font-weight: 600; padding: 3px 8px; border-radius: 4px; } .tournament-card-title { font-size: 1rem; font-weight: 600; margin-bottom: 5px; display: flex; align-items: center; gap: 8px; color: var(--text-primary); } .tournament-card-title i { color: var(--accent-color); } .tournament-card-info { display: flex; justify-content: space-between; align-items: stretch; border-top: 1px dashed var(--border-color); border-bottom: 1px dashed var(--border-color); padding: 10px 0; margin: 10px 0; font-size: 0.8rem; } .info-item { text-align: center; flex: 1; padding: 0 5px; } .info-item span { display: block; color: var(--text-secondary); font-size: 0.7rem; margin-bottom: 2px; } .info-item strong { color: var(--text-primary); font-weight: 600; font-size: 0.9rem; } .info-item .prize-icon { color: var(--accent-color); font-size: 1.2rem; } .tournament-card-spots { font-size: 0.8rem; color: var(--text-secondary); margin-bottom: 15px; } .tournament-card-spots span { font-weight: 600; } .progress { height: 6px; background-color: var(--primary-bg); border-radius: 3px; overflow: hidden; } .progress-bar { background-color: var(--warning-color); transition: width 0.3s ease; } .tournament-card-actions { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px; } .tournament-card-actions .btn-sm { padding: 8px 10px; font-size: 0.85rem; width: 100%; } .tournament-card-actions .btn-join { background: var(--accent-gradient); color: var(--primary-bg); font-weight: 600; grid-column: 2 / 3; } .tournament-card-actions .btn-details { background-color: var(--secondary-bg); border: 1px solid var(--border-color); grid-column: 1 / 2; } .tournament-card-actions .btn-joined { background-color: var(--success-color); color: var(--text-primary); opacity: 0.8; grid-column: 2 / 3; } .tournament-card-actions .btn-disabled { background-color: var(--secondary-bg); opacity: 0.6; cursor: not-allowed; grid-column: 2 / 3; } .btn-idpass { background: var(--accent-gradient); color: var(--primary-bg); border: none; font-weight: 600; } .wallet-card { background: linear-gradient(145deg, var(--secondary-bg), var(--primary-bg)); border-radius: 10px; padding: 20px; border: 1px solid var(--border-color); } .wallet-card h2 { font-size: 1.2rem; font-weight: 600; margin-bottom: 25px; } .balance-item { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px dashed var(--border-color); } .balance-item:last-child { margin-bottom: 0; border-bottom: none; padding-bottom: 0; } .balance-item-label { font-size: 0.95rem; color: var(--text-secondary); } .balance-item-value { font-size: 1.1rem; font-weight: 600; } .balance-item-action { min-width: 100px; text-align: right; } .balance-item-action .btn-custom-link { font-size: 0.85rem; color: var(--accent-color); padding: 5px; } .balance-item-action .btn-withdraw { background-color: var(--primary-button-bg); color: #fff; font-size: 0.8rem; padding: 5px 12px; border-radius: 5px; border: none; } #recentTransactionsListEl .custom-card { background-color: var(--secondary-bg); } #earnings-section .custom-card { text-align: center; } #earnings-section .display-4 { font-size: 3rem; } #earnings-section p strong { color: var(--text-primary); } .profile-header-card { background: linear-gradient(145deg, var(--secondary-bg), var(--primary-bg)); border-radius: 10px; padding: 20px; display: flex; flex-direction: column; align-items: center; text-align: center; margin-bottom: 20px; border: 1px solid var(--border-color); } .profile-avatar { width: 70px; height: 70px; border-radius: 50%; margin-bottom: 10px; border: 2px solid var(--accent-color); object-fit: cover; background-color: var(--primary-bg); } .profile-name { font-size: 1.1rem; font-weight: 600; margin-bottom: 2px; } .profile-email { font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 15px; word-break: break-all; } .profile-stats { display: flex; justify-content: space-around; width: 100%; border-top: 1px solid var(--border-color); padding-top: 15px; } .stat-item { text-align: center; flex: 1; } .stat-item strong { display: block; font-size: 1rem; font-weight: 600; } .stat-item span { font-size: 0.75rem; color: var(--text-secondary); } .profile-links .list-group { border-radius: 10px; overflow: hidden; border: 1px solid var(--border-color); } .profile-links .form-switch .form-check-input { background-color: var(--secondary-bg); border-color: var(--border-color); background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-4 -4 8 8'%3e%3ccircle r='3' fill='rgba%28255, 255, 255, 0.25%29'/%3e%3c/svg%3e"); } .profile-links .form-switch .form-check-input:checked { background-color: var(--accent-color); border-color: var(--accent-color); background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-4 -4 8 8'%3e%3ccircle r='3' fill='%23fff'/%3e%3c/svg%3e"); } /* --- Modern Login & Signup Styles --- */
.auth-container {
    min-height: calc(100vh - 155px);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 2rem 1rem;
    background: linear-gradient(135deg, var(--primary-bg) 0%, var(--secondary-bg) 100%);
    position: relative;
    overflow: hidden;
}

.auth-container::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: radial-gradient(circle, rgba(88, 166, 255, 0.1) 0%, transparent 70%);
    animation: float 20s ease-in-out infinite;
    pointer-events: none;
}

@keyframes float {
    0%, 100% { transform: translate(0, 0) rotate(0deg); }
    25% { transform: translate(10px, -10px) rotate(1deg); }
    50% { transform: translate(-5px, 5px) rotate(-1deg); }
    75% { transform: translate(-10px, -5px) rotate(0.5deg); }
}

.auth-card {
    background: rgba(26, 32, 44, 0.95);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border: 1px solid rgba(88, 166, 255, 0.2);
    border-radius: 24px;
    padding: 2.5rem;
    width: 100%;
    max-width: 420px;
    box-shadow: 
        0 25px 50px -12px rgba(0, 0, 0, 0.5),
        0 0 0 1px rgba(88, 166, 255, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
    position: relative;
    z-index: 1;
    transition: all 0.3s ease;
}

.auth-card:hover {
    transform: translateY(-5px);
    box-shadow: 
        0 35px 60px -12px rgba(0, 0, 0, 0.6),
        0 0 0 1px rgba(88, 166, 255, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.15);
}

.auth-header {
    text-align: center;
    margin-bottom: 2rem;
}

.auth-logo {
    width: 80px;
    height: 80px;
    background: var(--accent-gradient);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 1.5rem;
    font-size: 2rem;
    color: white;
    box-shadow: 0 8px 32px rgba(88, 166, 255, 0.3);
    border: 3px solid rgba(255, 255, 255, 0.1);
}

.auth-title {
    font-size: 2rem;
    font-weight: 700;
    color: var(--text-primary);
    margin-bottom: 0.5rem;
    background: linear-gradient(135deg, var(--text-primary) 0%, var(--accent-color) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.auth-subtitle {
    color: var(--text-secondary);
    font-size: 1rem;
    font-weight: 400;
}

.auth-form {
    margin-bottom: 1.5rem;
}

.form-group {
    margin-bottom: 1.5rem;
    position: relative;
}

.form-label {
    display: block;
    margin-bottom: 0.5rem;
    color: var(--text-primary);
    font-weight: 500;
    font-size: 0.9rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.form-input {
    width: 100%;
    padding: 1rem 1rem 1rem 3rem;
    background: rgba(13, 17, 23, 0.8);
    border: 2px solid rgba(88, 166, 255, 0.1);
    border-radius: 12px;
    color: var(--text-primary);
    font-size: 1rem;
    transition: all 0.3s ease;
    position: relative;
}

.form-input:focus {
    outline: none;
    border-color: var(--accent-color);
    background: rgba(13, 17, 23, 0.9);
    box-shadow: 0 0 0 4px rgba(88, 166, 255, 0.1);
}

.form-input::placeholder {
    color: var(--text-secondary);
    opacity: 0.7;
}

.input-icon {
    position: absolute;
    left: 1rem;
    top: 50%;
    transform: translateY(-50%);
    color: var(--text-secondary);
    font-size: 1.1rem;
    transition: color 0.3s ease;
}

.form-input:focus + .input-icon {
    color: var(--accent-color);
}

.form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
}

.auth-btn {
    width: 100%;
    padding: 1rem;
    background: var(--accent-gradient);
    border: none;
    border-radius: 12px;
    color: white;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
    margin-bottom: 1rem;
}

.auth-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left 0.5s ease;
}

.auth-btn:hover::before {
    left: 100%;
}

.auth-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(88, 166, 255, 0.3);
}

.auth-btn:active {
    transform: translateY(0);
}

.auth-toggle {
    background: none;
    border: none;
    color: var(--accent-color);
    font-size: 0.9rem;
    cursor: pointer;
    text-decoration: underline;
    transition: color 0.3s ease;
}

.auth-toggle:hover {
    color: #80baff;
}

.auth-footer {
    text-align: center;
    margin-top: 1.5rem;
}

.forgot-password {
    color: var(--text-secondary);
    font-size: 0.9rem;
    text-decoration: none;
    transition: color 0.3s ease;
}

.forgot-password:hover {
    color: var(--accent-color);
}

.form-divider {
    text-align: center;
    margin: 1.5rem 0;
    position: relative;
    color: var(--text-secondary);
    font-size: 0.9rem;
}

.form-divider::before,
.form-divider::after {
    content: '';
    position: absolute;
    top: 50%;
    width: 30%;
    height: 1px;
    background: linear-gradient(90deg, transparent, var(--border-color), transparent);
}

.form-divider::before {
    left: 0;
}

.form-divider::after {
    right: 0;
}

.form-divider span {
    background: rgba(26, 32, 44, 0.95);
    padding: 0 1rem;
    position: relative;
    z-index: 1;
}

.status-message {
    padding: 1rem;
    border-radius: 12px;
    margin-bottom: 1rem;
    font-size: 0.9rem;
    font-weight: 500;
    text-align: center;
    border: 1px solid transparent;
}

.status-message.success {
    background: rgba(34, 134, 54, 0.1);
    border-color: rgba(34, 134, 54, 0.3);
    color: #4ade80;
}

.status-message.error {
    background: rgba(218, 54, 51, 0.1);
    border-color: rgba(218, 54, 51, 0.3);
    color: #f87171;
}

.status-message.info {
    background: rgba(88, 166, 255, 0.1);
    border-color: rgba(88, 166, 255, 0.3);
    color: #60a5fa;
}

/* Mobile Responsiveness */
@media (max-width: 768px) {
    .auth-container {
        padding: 1rem;
        min-height: calc(100vh - 140px);
    }

    .auth-card {
        padding: 2rem 1.5rem;
        margin: 0 0.5rem;
    }

    .auth-title {
        font-size: 1.75rem;
    }

    .form-row {
        grid-template-columns: 1fr;
        gap: 0;
    }

    .form-input {
        padding: 0.875rem 0.875rem 0.875rem 2.5rem;
        font-size: 0.95rem;
    }

    .input-icon {
        left: 0.875rem;
        font-size: 1rem;
    }
}

@media (max-width: 480px) {
    .auth-card {
        padding: 1.5rem 1rem;
        border-radius: 20px;
    }

    .auth-logo {
        width: 70px;
        height: 70px;
        font-size: 1.75rem;
    }

    .auth-title {
        font-size: 1.5rem;
    }

    .form-input {
        padding: 0.75rem 0.75rem 0.75rem 2.25rem;
    }

    .input-icon {
        left: 0.75rem;
    }
} #googleSignInBtnMainEl { display: none; } .modal-content { background-color: var(--secondary-bg); color: var(--text-primary); border: 1px solid var(--border-color); } .modal-header { border-bottom-color: var(--border-color); } .modal-footer { border-top-color: var(--border-color); } .btn-close-white { filter: invert(1) grayscale(100%) brightness(200%); } .modal-body .phonepe-number { color: var(--warning-color); font-weight: bold; user-select: text; } #matchDetailsModalBodyEl pre { background-color: var(--primary-bg); padding: 10px; border-radius: 5px; border: 1px solid var(--border-color); color: var(--text-secondary); font-size: 0.85rem; white-space: pre-wrap; word-wrap: break-word; } #policyModalBodyEl { line-height: 1.6; font-size: 0.95rem; white-space: pre-wrap; } #idPasswordModalEl .copy-btn { padding: 2px 6px; font-size: 0.8rem; margin-left: 8px; vertical-align: middle; } #policyModalBodyEl .copy-btn, #policyModalBodyEl #shareReferralBtn { padding: 4px 10px; font-size: 0.9rem; } #policyModalBodyEl #shareReferralBtn i, #policyModalBodyEl .copy-btn i { margin-right: 5px; } #securityWarning { background-color: var(--danger-color); color: white; padding: 10px 15px; text-align: center; font-size: 0.9rem; position: sticky; top: 60px; z-index: 999; border-bottom: 1px solid #a51d1d; } #securityWarning a { color: #ffdddd; text-decoration: underline; } #securityWarning button { background: none; border: 1px solid white; color: white; padding: 2px 8px; margin-left: 15px; font-size: 0.8rem; border-radius: 4px; cursor: pointer; }
        .tournament-result-area {
            display: none; /* Hidden by default */
            background-color: var(--primary-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            animation: fadeIn 0.5s;
        }
        .tournament-result-area.visible {
            display: block;
        }
        .result-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 15px;
            text-align: center;
        }
        .result-grid-item span {
            font-size: 0.8rem;
            color: var(--text-secondary);
            display: block;
            margin-bottom: 4px;
        }
        .result-grid-item strong {
            font-size: 1.2rem;
            color: var(--text-primary);
        }
        .result-grid-item .bi {
            color: var(--accent-color);
            margin-right: 5px;
        }
        /* Mobile viewport stability + promotion slider sizing */
        html, body { -webkit-text-size-adjust: 100%; text-size-adjust: 100%; }
        #promotionSliderEl { max-width: 100%; overflow: hidden; height: 180px; border-radius: 12px; }
        @media (min-width: 480px) { #promotionSliderEl { height: 200px; } }
        @media (min-width: 768px) { #promotionSliderEl { height: 220px; } }
        #promotionSliderEl .swiper-wrapper, #promotionSliderEl .swiper-slide { height: 100%; }
        #promotionSliderEl .swiper-slide a { display: block; width: 100%; height: 100%; }
        #promotionSliderEl .swiper-slide img { width: 100%; height: 100%; object-fit: cover; display: block; }
        .modal-content { background-color: var(--secondary-bg); color: var(--text-primary); border: 1px solid var(--border-color); } .modal-header { border-bottom-color: var(--border-color); } .modal-footer { border-top-color: var(--border-color); } .btn-close-white { filter: invert(1) grayscale(100%) brightness(200%); } .modal-body .phonepe-number { color: var(--warning-color); font-weight: bold; user-select: text; } #matchDetailsModalBodyEl pre { background-color: var(--primary-bg); padding: 10px; border-radius: 5px; border: 1px solid var(--border-color); color: var(--text-secondary); font-size: 0.85rem; white-space: pre-wrap; word-wrap: break-word; } #policyModalBodyEl { line-height: 1.6; font-size: 0.95rem; white-space: pre-wrap; } #idPasswordModalEl .copy-btn { padding: 2px 6px; font-size: 0.8rem; margin-left: 8px; vertical-align: middle; } #policyModalBodyEl .copy-btn, #policyModalBodyEl #shareReferralBtn { padding: 4px 10px; font-size: 0.9rem; } #policyModalBodyEl #shareReferralBtn i, #policyModalBodyEl .copy-btn i { margin-right: 5px; } #securityWarning { background-color: var(--danger-color); color: white; padding: 10px 15px; text-align: center; font-size: 0.9rem; position: sticky; top: 60px; z-index: 999; border-bottom: 1px solid #a51d1d; } #securityWarning a { color: #ffdddd; text-decoration: underline; } #securityWarning button { background: none; border: 1px solid white; color: white; padding: 2px 8px; margin-left: 15px; font-size: 0.8rem; border-radius: 4px; cursor: pointer; }

        /* Modern Tournament Details Modal Styles */
        .tournament-details-container {
            color: var(--text-primary);
        }

        .tournament-header {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 20px;
            background: linear-gradient(135deg, var(--card-bg) 0%, var(--secondary-bg) 100%);
            border-radius: 12px;
            border: 1px solid var(--border-color);
            margin-bottom: 25px;
        }

        .tournament-icon {
            font-size: 2.5rem;
            color: var(--accent-color);
        }

        .tournament-meta {
            flex: 1;
        }

        .tournament-status {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .status-upcoming {
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            color: #000;
        }

        .status-ongoing {
            background: linear-gradient(135deg, #ff4757, #ff3742);
            color: white;
        }

        .status-completed {
            background: linear-gradient(135deg, #2ed573, #1e90ff);
            color: white;
        }

        .tournament-participants {
            color: var(--text-secondary);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .tournament-info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }

        .info-card {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 15px;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all 0.3s ease;
        }

        .info-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            border-color: var(--accent-color);
        }

        .info-icon {
            font-size: 1.5rem;
            color: var(--accent-color);
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
        }

        .info-content {
            flex: 1;
        }

        .info-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-bottom: 2px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .info-value {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .prize-section {
            background: linear-gradient(135deg, var(--card-bg) 0%, var(--secondary-bg) 100%);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid var(--border-color);
        }

        .section-title {
            color: var(--text-primary);
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .prize-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }

        .prize-item {
            background: var(--primary-bg);
            border-radius: 8px;
            padding: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            border: 1px solid var(--border-color);
        }

        .prize-icon {
            font-size: 1.2rem;
            color: var(--accent-color);
        }

        .prize-content {
            flex: 1;
        }

        .prize-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-bottom: 2px;
        }

        .prize-value {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .rules-section {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid var(--border-color);
            margin-bottom: 20px;
        }

        .rules-content {
            color: var(--text-secondary);
            line-height: 1.6;
            font-size: 0.95rem;
        }

        .prize-description-section,
        .prize-distribution-section {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid var(--border-color);
            margin-bottom: 20px;
        }

        .prize-description-content,
        .prize-distribution-content {
            color: var(--text-secondary);
            line-height: 1.6;
            font-size: 0.95rem;
        }

        .prize-breakdown {
            background: var(--primary-bg);
            border-radius: 8px;
            padding: 15px;
            border: 1px solid var(--border-color);
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.5;
            color: var(--text-secondary);
        }

        .qr-code-actions {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 10px;
        }

        .qr-code-actions button {
            flex: 1;
        }

        .qr-code-fullscreen-modal .modal-dialog {
            max-width: 80%;
        }

        .qr-code-fullscreen-modal .modal-content {
            background-color: transparent;
            border: none;
        }

        .qr-code-fullscreen-modal .modal-body {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 0;
        }

        .qr-code-fullscreen-modal img {
            max-width: 100%;
            max-height: 100%;
        }

        .qr-code-fullscreen-modal .close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: var(--primary-bg);
            color: var(--text-primary);
            border: none;
            border-radius: 50%;
            padding: 5px 10px;
            font-size: 1.2rem;
            cursor: pointer;
        }

        /* Floating Action Button */
        .fab-container {
            position: fixed;
            bottom: 90px;
            right: 20px;
            z-index: 1000;
        }

        .fab-button {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(102, 126, 234, 0.4);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1001;
        }

        .fab-button:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 25px rgba(102, 126, 234, 0.5);
        }

        .fab-button.active {
            transform: rotate(45deg);
        }

        .fab-menu {
            position: absolute;
            bottom: 70px;
            right: 0;
            display: none;
            flex-direction: column;
            gap: 0.75rem;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s ease;
        }

        .fab-menu.active {
            display: flex;
            opacity: 1;
            transform: translateY(0);
        }

        .fab-menu-item {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .fab-menu-item:hover {
            background: var(--accent-color);
            color: white;
            transform: scale(1.1);
        }

        .fab-menu-item span {
            position: absolute;
            right: 60px;
            background: var(--card-bg);
            color: var(--text-primary);
            padding: 0.5rem 0.75rem;
            border-radius: 8px;
            font-size: 0.8rem;
            white-space: nowrap;
            opacity: 0;
            transform: translateX(10px);
            transition: all 0.3s ease;
            border: 1px solid var(--border-color);
            pointer-events: none;
        }

        .fab-menu-item:hover span {
            opacity: 1;
            transform: translateX(0);
        }

        @media (max-width: 768px) {
            .wallet-header {
                padding: 1.5rem;
                margin-bottom: 1.5rem;
                border-radius: 16px;
            }

            .wallet-title {
                font-size: 1.75rem;
            }

            .wallet-subtitle {
                font-size: 0.9rem;
            }

            .wallet-header-icon {
                width: 60px;
                height: 60px;
                font-size: 1.8rem;
            }

            .balance-cards-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .balance-card {
                padding: 1.25rem;
                border-radius: 16px;
            }

            .balance-card-header {
                gap: 0.75rem;
            }

            .balance-icon {
                width: 50px;
                height: 50px;
                font-size: 1.5rem;
            }

            .balance-amount {
                font-size: 1.75rem;
            }

            .btn-history, .btn-withdraw {
                padding: 0.6rem 1rem;
                font-size: 0.85rem;
            }

            .quick-actions-grid {
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }

            .btn-add-amount, .btn-send-money {
                padding: 1rem 1.5rem;
                font-size: 1rem;
            }

            .stats-grid {
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }

            .stat-card {
                padding: 1rem;
            }

            .stat-icon {
                width: 45px;
                height: 45px;
                font-size: 1.2rem;
            }

            .stat-value {
                font-size: 1.3rem;
            }

            .transactions-section {
                padding: 1.5rem;
                border-radius: 16px;
            }

            .transactions-title {
                font-size: 1.2rem;
            }

            .empty-transactions {
                padding: 3rem 1.5rem;
            }

            .empty-icon {
                width: 80px;
                height: 80px;
                font-size: 2rem;
            }

            .empty-title {
                font-size: 1.3rem;
            }

            .fab-container {
                bottom: 80px;
                right: 15px;
            }

            .fab-button {
                width: 55px;
                height: 55px;
                font-size: 1.3rem;
            }

            .fab-menu-item {
                width: 45px;
                height: 45px;
                font-size: 1.1rem;
            }
        }

    </style>
</head>

<body>
     <!-- Firebase Security Rules Warning -->
    <div id="securityWarning" style="display: none;">
        <i class="bi bi-exclamation-triangle-fill"></i> <strong>Security Alert:</strong> Your database rules are insecure (public). Anyone can read/write data.
        <a href="https://firebase.google.com/docs/database/security" target="_blank" rel="noopener noreferrer">Learn how to secure rules.</a>
        <button onclick="this.parentElement.style.display='none'">Dismiss</button>
    </div>

    <!-- Beautiful Modern Header -->
    <header class="beautiful-header">
        <div class="header-background">
            <div class="header-gradient"></div>
            <div class="header-pattern"></div>
        </div>
        
        <div class="header-content">
            <div class="header-left">
                <button class="header-back-button" id="headerBackBtnEl" aria-label="Go back">
                    <i class="bi bi-arrow-left"></i>
                </button>
                
                <div class="header-brand">
                    <div class="header-logo-container">
                        <div class="header-logo-icon">
                            <i class="bi bi-controller"></i>
                        </div>
                    </div>
                    <div class="header-title-container">
                        <div class="header-welcome" id="headerTitleContainerEl">
                            Welcome <span id="headerUserGreetingEl">Guest</span>
                        </div>
                        <div class="header-subtitle">Ready to dominate?</div>
                    </div>
                </div>
                
                <div class="header-game-title" id="headerGameTitleEl">Game Title</div>
            </div>
            
            <div class="header-right">
                <button class="header-notification-btn" id="notificationBtnEl" aria-label="Notifications">
                    <i class="bi bi-bell"></i>
                    <span class="notification-badge" style="display: none;"></span>
                </button>
                
                <button class="header-wallet-btn" id="headerWalletChipEl" style="display: none;">
                    <div class="wallet-icon">
                        <i class="bi bi-wallet2"></i>
                    </div>
                    <div class="wallet-amount">
                        NPR.<span id="headerChipBalanceEl">0</span>
                    </div>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content Area -->
    <main class="main-content">
        <div id="globalLoaderEl"> <div class="spinner-border" role="status"><span class="visually-hidden">Loading...</span></div> </div>

        <!-- Login Section -->
        <section id="login-section" class="section">
            <div class="auth-container">
                <div class="auth-card">
                        <!-- Login Form -->
                    <form id="emailLoginForm" class="auth-form">
                        <div class="auth-header">
                            <div class="auth-logo">
                                <i class="bi bi-controller"></i>
                            </div>
                            <h1 class="auth-title">Welcome Back</h1>
                            <p class="auth-subtitle">Sign in to your gaming account</p>
                        </div>
                        
                        <div class="form-group">
                            <label for="loginEmailInputEl" class="form-label">Email Address</label>
                            <input type="email" class="form-input" id="loginEmailInputEl" placeholder="Enter your email" required>
                            <i class="bi bi-envelope input-icon"></i>
                        </div>
                        
                        <div class="form-group">
                            <label for="loginPasswordInputEl" class="form-label">Password</label>
                            <input type="password" class="form-input" id="loginPasswordInputEl" placeholder="Enter your password" required>
                            <i class="bi bi-lock input-icon"></i>
                        </div>
                        
                        <div id="loginStatusMessageEl" class="status-message" style="display: none;"></div>
                        
                        <button type="button" class="auth-btn" id="loginEmailBtnEl">
                            <span class="btn-text">Sign In</span>
                        </button>
                        
                        <div class="auth-footer">
                            <button type="button" class="auth-toggle" id="showSignupToggleBtnEl">
                                Need an account? Sign Up
                            </button>
                            <br>
                            <a href="#" id="forgotPasswordLinkEl" class="forgot-password">
                                Forgot Password?
                            </a>
                        </div>
                        </form>

                        <!-- Signup Form (Initially Hidden) -->
                    <form id="emailSignupForm" class="auth-form" style="display: none;">
                        <div class="auth-header">
                            <div class="auth-logo">
                                <i class="bi bi-person-plus"></i>
                            </div>
                            <h1 class="auth-title">Join the Game</h1>
                            <p class="auth-subtitle">Create your gaming profile</p>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                    <label for="signupFirstNameInputEl" class="form-label">First Name</label>
                                <input type="text" class="form-input" id="signupFirstNameInputEl" placeholder="First name" required>
                                <i class="bi bi-person input-icon"></i>
                                </div>
                            <div class="form-group">
                                    <label for="signupLastNameInputEl" class="form-label">Last Name</label>
                                <input type="text" class="form-input" id="signupLastNameInputEl" placeholder="Last name" required>
                                <i class="bi bi-person input-icon"></i>
                                </div>
                            </div>
                            
                        <div class="form-group">
                                <label for="signupUsernameInputEl" class="form-label">Username</label>
                            <input type="text" class="form-input" id="signupUsernameInputEl" placeholder="Choose username" required>
                            <i class="bi bi-at input-icon"></i>
                            </div>
                            
                        <div class="form-group">
                            <label for="signupEmailInputEl" class="form-label">Email Address</label>
                            <input type="email" class="form-input" id="signupEmailInputEl" placeholder="Enter your email" required>
                            <i class="bi bi-envelope input-icon"></i>
                        </div>
                        
                        <div class="form-group">
                            <label for="signupPhoneInputEl" class="form-label">Phone Number</label>
                            <input type="tel" class="form-input" id="signupPhoneInputEl" placeholder="Enter phone number" required>
                            <i class="bi bi-phone input-icon"></i>
                    </div>
                        
                        <div class="form-group">
                            <label for="signupPasswordInputEl" class="form-label">Password</label>
                            <input type="password" class="form-input" id="signupPasswordInputEl" placeholder="Create password" required minlength="6">
                            <i class="bi bi-lock input-icon"></i>
                        </div>
                        
                        <div class="form-group">
                            <label for="signupConfirmPasswordInputEl" class="form-label">Confirm Password</label>
                            <input type="password" class="form-input" id="signupConfirmPasswordInputEl" placeholder="Confirm password" required>
                            <i class="bi bi-shield-lock input-icon"></i>
                        </div>
                        
                        <div class="form-group">
                            <label for="signupReferralCodeInputEl" class="form-label">Referral Code (Optional)</label>
                            <input type="text" class="form-input" id="signupReferralCodeInputEl" placeholder="Enter referral code">
                            <i class="bi bi-gift input-icon"></i>
                        </div>
                        
                        <div id="signupStatusMessageEl" class="status-message" style="display: none;"></div>
                        
                        <button type="button" class="auth-btn" id="signupEmailBtnEl">
                            <span class="btn-text">Create Account</span>
                        </button>
                        
                        <div class="auth-footer">
                            <button type="button" class="auth-toggle" id="showLoginToggleBtnEl">
                                Already have account? Sign In
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </section>

        <!-- Home Section -->
        <section id="home-section" class="section">
            <!-- Simple Banner Slider -->
            <div class="simple-banner-section">
                <div class="simple-swiper-container" id="promotionSliderEl">
                    <div class="swiper-wrapper placeholder-glow">
                        <div class="swiper-slide">
                            <div class="simple-banner-card placeholder-glow">
                                <div class="banner-image-placeholder"></div>
                                <div class="banner-content-placeholder">
                                    <div class="title-placeholder"></div>
                                    <div class="description-placeholder"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="swiper-pagination"></div>
                </div>
            </div>
            
            <!-- Simple Games List -->
            <div class="simple-games-section">
                <div class="simple-section-header">
                    <h3 class="section-title">
                        <i class="bi bi-controller"></i>
                        Games
                    </h3>
                </div>
                <div class="simple-games-list" id="gamesListEl">
                    <!-- Placeholder Game Items -->
                    <div class="simple-game-item placeholder-glow">
                        <div class="game-icon-placeholder"></div>
                        <div class="game-name-placeholder"></div>
                    </div>
                    <div class="simple-game-item placeholder-glow">
                        <div class="game-icon-placeholder"></div>
                        <div class="game-name-placeholder"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Tournaments Section -->
        <section id="tournaments-section" class="section">
            <div class="tournament-tabs"> <button class="tab-item active" data-status="upcoming"><i class="bi bi-calendar-event-fill"></i> Upcoming</button> <button class="tab-item" data-status="ongoing"><i class="bi bi-play-circle-fill"></i> Ongoing</button> <button class="tab-item" data-status="completed"><i class="bi bi-trophy-fill"></i> Results</button> </div>
            <div id="tournamentsListContainerEl" class="mt-3 placeholder-glow"> <div class="tournament-card placeholder-glow mb-3"> <span class="placeholder col-6" style="height: 18px;"></span> <span class="placeholder col-12 mt-2" style="height: 24px;"></span> <span class="placeholder col-10 mt-2" style="height: 16px;"></span> <div class="d-flex justify-content-between mt-3"> <span class="placeholder col-4" style="height: 30px; border-radius: 6px;"></span> <span class="placeholder col-4" style="height: 30px; border-radius: 6px;"></span> </div> </div> </div>
            <p id="noTournamentsMessageEl" class="text-secondary text-center mt-4" style="display: none;">No tournaments found.</p>
        </section>

        <!-- Wallet Section -->
        <section id="wallet-section" class="section">
            <!-- Compact Mobile Wallet Header -->
            <div class="compact-wallet-header">
                <div class="wallet-main-info">
                    <div class="wallet-title-section">
                        <h2 class="wallet-title">
                            <i class="bi bi-wallet2"></i>
                            My Wallet
                        </h2>
                        <p class="wallet-subtitle">Manage your funds and track transactions</p>
                    </div>
                    <div class="wallet-header-icon">
                        <i class="bi bi-credit-card"></i>
                    </div>
                </div>
            </div>
            
            <!-- Compact Balance Cards -->
            <div class="compact-balance-cards">
                <div class="compact-balance-card deposit">
                    <div class="balance-card-content">
                        <div class="balance-icon">
                            <i class="bi bi-bank"></i>
                        </div>
                        <div class="balance-info">
                            <span class="balance-label">Deposit Balance</span>
                            <span class="balance-amount" id="walletTotalBalanceEl">NPR.0</span>
                        </div>
                    </div>
                    <button class="compact-balance-action" id="allTransactionsBtnEl">
                        <i class="bi bi-clock-history"></i>
                        <span>History</span>
                    </button>
                </div>
                
                <div class="compact-balance-card winning">
                    <div class="balance-card-content">
                        <div class="balance-icon">
                            <i class="bi bi-trophy"></i>
                        </div>
                        <div class="balance-info">
                            <span class="balance-label">Winning Cash</span>
                            <span class="balance-amount" id="walletWinningCashEl">NPR.0</span>
                        </div>
                    </div>
                    <button class="compact-balance-action" id="withdrawBtnEl">
                        <i class="bi bi-cash-coin"></i>
                        <span>Withdraw</span>
                    </button>
                </div>
                
                <div class="compact-balance-card bonus">
                    <div class="balance-card-content">
                        <div class="balance-icon">
                            <i class="bi bi-gift"></i>
                        </div>
                        <div class="balance-info">
                            <span class="balance-label">Bonus Cash</span>
                            <span class="balance-amount" id="walletBonusCashEl">NPR.0</span>
                        </div>
                    </div>
                    <div class="compact-balance-info">
                        <small>Referral rewards</small>
                    </div>
                </div>
            </div>
            
            <!-- Compact Quick Actions -->
            <div class="compact-wallet-actions">
                <div class="actions-row">
                    <button class="compact-wallet-action" id="addAmountWalletBtnEl">
                        <i class="bi bi-plus-circle"></i>
                        <span>Add Amount</span>
                    </button>
                    <button class="compact-wallet-action" id="sendMoneyBtnEl">
                        <i class="bi bi-arrow-up-circle"></i>
                        <span>Send Money</span>
                    </button>
                </div>
            </div>
            
            <!-- Compact Wallet Stats -->
            <div class="compact-wallet-stats">
                <div class="compact-stats-section-header">
                    <h3 class="stats-section-title">
                        <i class="bi bi-graph-up"></i>
                        Wallet Overview
                    </h3>
                </div>
                <div class="compact-stats-grid">
                    <div class="compact-stat-item">
                        <i class="bi bi-wallet2"></i>
                        <span class="compact-stat-value" id="totalBalanceEl">NPR.0</span>
                        <span class="compact-stat-label">Total Balance</span>
                    </div>
                    <div class="compact-stat-item">
                        <i class="bi bi-calendar-check"></i>
                        <span class="compact-stat-value" id="monthlyEarningsEl">NPR.0</span>
                        <span class="compact-stat-label">This Month</span>
                    </div>
                    <div class="compact-stat-item">
                        <i class="bi bi-arrow-up-right"></i>
                        <span class="compact-stat-value" id="totalWithdrawalsEl">NPR.0</span>
                        <span class="compact-stat-label">Total Withdrawn</span>
                    </div>
                </div>
            </div>
            
            <!-- Compact Recent Transactions -->
            <div class="compact-transactions">
                <div class="compact-transactions-header">
                    <h3 class="transactions-title">
                        <i class="bi bi-clock-history"></i>
                        Recent Transactions
                    </h3>
                    <div class="transactions-count">
                        <span id="transactionsCountEl">0</span> transactions
                    </div>
                </div>
                
                <div class="compact-transactions-list" id="recentTransactionsListEl">
                    <!-- Transaction placeholders -->
                    <div class="compact-transaction-placeholder">
                        <div class="placeholder-item">
                            <div class="placeholder-icon"></div>
                            <div class="placeholder-content">
                                <div class="placeholder-title"></div>
                                <div class="placeholder-subtitle"></div>
                            </div>
                            <div class="placeholder-amount"></div>
                        </div>
                    </div>
                </div>
                
                <div id="noTransactionsMessageEl" class="compact-empty-transactions" style="display: none;">
                    <div class="empty-icon">
                        <i class="bi bi-receipt"></i>
                    </div>
                    <h4 class="empty-title">No Transactions Yet</h4>
                    <p class="empty-subtitle">Your transaction history will appear here</p>
                </div>
            </div>
        </section>



        <!-- Earnings Section -->
        <section id="earnings-section" class="section">
            <!-- Compact Mobile Earnings Header -->
            <div class="compact-earnings-header">
                <div class="earnings-main-info">
                    <div class="earnings-title-section">
                        <h2 class="earnings-title">
                            <i class="bi bi-graph-up"></i>
                            My Earnings
                        </h2>
                        <p class="earnings-subtitle">Track your tournament winnings and referral rewards</p>
                    </div>
                    <div class="earnings-header-icon">
                        <i class="bi bi-coin"></i>
                    </div>
                </div>
            </div>
            
            <!-- Compact Stats Row -->
            <div class="compact-earnings-stats">
                <div class="compact-earnings-stat">
                    <i class="bi bi-trophy"></i>
                    <span class="compact-earnings-value" id="earningsTotalEl">NPR.0</span>
                    <span class="compact-earnings-label">Tournament Winnings</span>
                </div>
                <div class="compact-earnings-stat">
                    <i class="bi bi-people"></i>
                    <span class="compact-earnings-value" id="earningsReferralEl">NPR.0</span>
                    <span class="compact-earnings-label">Referral Earnings</span>
                </div>
                <div class="compact-earnings-stat">
                    <i class="bi bi-calculator"></i>
                    <span class="compact-earnings-value" id="netEarningsEl">NPR.0</span>
                    <span class="compact-earnings-label">Net Earnings</span>
                </div>
            </div>
            
            <!-- Compact Quick Actions -->
            <div class="compact-earnings-actions">
                <div class="actions-row">
                    <div class="compact-earnings-action" data-section="referral-section">
                        <i class="bi bi-clock-history"></i>
                        <span>Referral History</span>
                    </div>
                    <div class="compact-earnings-action" data-section="tournaments-section">
                        <i class="bi bi-trophy"></i>
                        <span>My Tournaments</span>
                    </div>
                    <div class="compact-earnings-action" data-section="wallet-section">
                        <i class="bi bi-wallet2"></i>
                        <span>Withdraw</span>
                    </div>
                    <div class="compact-earnings-action" data-section="stats-section">
                        <i class="bi bi-graph-up"></i>
                        <span>Analytics</span>
                    </div>
                </div>
            </div>
            
            <!-- Compact Earnings History -->
            <div class="compact-earnings-history">
                <div class="compact-earnings-history-header">
                    <h3 class="history-title">
                        <i class="bi bi-clock-history"></i>
                        Recent Earnings
                    </h3>
                    <div class="history-filter">
                        <button class="filter-btn active" data-filter="all">All</button>
                        <button class="filter-btn" data-filter="tournaments">Tournaments</button>
                        <button class="filter-btn" data-filter="referrals">Referrals</button>
                    </div>
                </div>
                
                <div class="compact-earnings-list" id="earningsHistoryList">
                    <!-- Earnings history items will be populated here -->
                    <div class="compact-earnings-placeholder">
                        <div class="placeholder-item">
                            <div class="placeholder-icon"></div>
                            <div class="placeholder-content">
                                <div class="placeholder-title"></div>
                                <div class="placeholder-subtitle"></div>
                            </div>
                            <div class="placeholder-amount"></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Referral Section -->
        <section id="referral-section" class="section">
            <!-- Compact Mobile Referral Header -->
            <div class="compact-referral-header">
                <div class="referral-main-info">
                    <div class="referral-title-section">
                        <h2 class="referral-title">
                            <i class="bi bi-person-plus"></i>
                            Refer & Earn
                        </h2>
                        <p class="referral-subtitle">Share your code and earn rewards</p>
                    </div>
                    <div class="referral-header-icon">
                        <i class="bi bi-gift"></i>
                    </div>
                </div>
            </div>
            
            <!-- Compact Stats Row -->
            <div class="compact-referral-stats">
                <div class="compact-referral-stat">
                    <i class="bi bi-coin"></i>
                    <span class="compact-referral-value" id="referralEarningsEl">NPR.0</span>
                    <span class="compact-referral-label">Total Earnings</span>
                </div>
                <div class="compact-referral-stat">
                    <i class="bi bi-people"></i>
                    <span class="compact-referral-value" id="referralCountEl">0</span>
                    <span class="compact-referral-label">Successful Referrals</span>
                </div>
            </div>
            
            <!-- Compact Referral Code Section -->
            <div class="compact-referral-code">
                <div class="compact-referral-code-header">
                    <h3 class="referral-code-title">
                        <i class="bi bi-link-45deg"></i>
                        Your Referral Code
                    </h3>
                    <button class="btn-copy-code" id="copyReferralCodeBtn">
                        <i class="bi bi-clipboard"></i>
                        Copy
                    </button>
                </div>
                <div class="compact-referral-code-display" id="userReferralCodeEl">
                    <span class="placeholder col-4"></span>
                </div>
                <p class="referral-code-subtitle">Share this code with friends to earn rewards!</p>
                
                <!-- Compact Share Options -->
                <div class="compact-share-options">
                    <div class="share-options-row">
                        <a href="#" class="compact-share-btn whatsapp" id="shareWhatsappBtn">
                            <i class="bi bi-whatsapp"></i>
                            <span>WhatsApp</span>
                        </a>
                        <a href="#" class="compact-share-btn telegram" id="shareTelegramBtn">
                            <i class="bi bi-telegram"></i>
                            <span>Telegram</span>
                        </a>
                    </div>
                    <div class="share-options-row">
                        <button class="compact-share-btn copy" id="shareCopyBtn">
                            <i class="bi bi-clipboard"></i>
                            <span>Copy Link</span>
                        </button>
                        <button class="compact-share-btn more" id="shareMoreBtn">
                            <i class="bi bi-share"></i>
                            <span>More</span>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Compact Referral History -->
            <div class="compact-referral-history">
                <div class="compact-referral-history-header">
                    <h3 class="history-title">
                        <i class="bi bi-clock-history"></i>
                        Referral History
                    </h3>
                    <button class="btn-refresh" id="refreshReferralHistoryBtn">
                        <i class="bi bi-arrow-clockwise"></i>
                        Refresh
                    </button>
                </div>
                
                <div class="compact-referral-history-list" id="referralHistoryListEl">
                    <!-- Referral history items will be populated here -->
                    <div class="compact-referral-history-placeholder">
                        <div class="placeholder-item">
                            <div class="placeholder-icon"></div>
                            <div class="placeholder-content">
                                <div class="placeholder-title"></div>
                                <div class="placeholder-subtitle"></div>
                            </div>
                            <div class="placeholder-amount"></div>
                        </div>
                    </div>
                </div>
                
                <!-- Empty State -->
                <div id="noReferralHistoryEl" class="compact-empty-referral-state" style="display: none;">
                    <i class="bi bi-person-plus"></i>
                    <h4>No Referrals Yet</h4>
                    <p>You haven't referred anyone yet.<br>Share your code to start earning rewards!</p>
                </div>
            </div>
        </section>

        <!-- Leaderboard Section -->
        <section id="leaderboard-section" class="section">
            <div class="leaderboard-container">
                <!-- Leaderboard Header -->
                <div class="leaderboard-header">
                    <div class="leaderboard-header-content">
                        <div class="leaderboard-title-section">
                            <h2 class="leaderboard-title">
                                <i class="bi bi-trophy-fill"></i>
                                Leaderboard
                            </h2>
                            <p class="leaderboard-subtitle">See who's on top</p>
                        </div>
                        <div class="leaderboard-header-icon">
                            <i class="bi bi-award-fill"></i>
                        </div>
                    </div>
                </div>

                <!-- Leaderboard Tabs -->
                <div class="leaderboard-tabs">
                    <button class="tab-item active" data-leaderboard-type="earnings"><i class="bi bi-coin"></i> Top Earners</button>
                    <button class="tab-item" data-leaderboard-type="wins"><i class="bi bi-trophy"></i> Most Wins</button>
                    <button class="tab-item" data-leaderboard-type="tournaments"><i class="bi bi-calendar-event"></i> Most Tournaments</button>
                </div>
                
                <!-- Leaderboard List -->
                <div id="leaderboardListEl" class="leaderboard-list">
                    <!-- Leaderboard items will be populated here -->
                    <div class="leaderboard-placeholder">
                        <div class="placeholder-item">
                            <div class="placeholder-icon"></div>
                            <div class="placeholder-content">
                                <div class="placeholder-title"></div>
                                <div class="placeholder-subtitle"></div>
                            </div>
                            <div class="placeholder-amount"></div>
                        </div>
                    </div>
                </div>
                
                <p id="noLeaderboardMessageEl" class="text-secondary text-center mt-4" style="display: none;">No leaderboard data available.</p>
            </div>
        </section>

        <!-- Stats Section -->
        <section id="stats-section" class="section">
            <!-- Compact Mobile Stats Header -->
            <div class="compact-stats-header">
                <div class="stats-main-info">
                    <div class="stats-title-section">
                        <h2 class="stats-title">
                            <i class="bi bi-bar-chart"></i>
                            My Stats
                        </h2>
                        <p class="stats-subtitle">Track your performance and earnings</p>
                    </div>
                    <div class="stats-header-icon">
                        <i class="bi bi-graph-up"></i>
                    </div>
                </div>
            </div>
            
            <!-- Compact Performance Stats -->
            <div class="compact-performance-stats">
                <div class="compact-stats-section-header">
                    <h3 class="stats-section-title">
                        <i class="bi bi-speedometer2"></i>
                        Performance Overview
                    </h3>
                </div>
                <div class="compact-stats-grid">
                    <div class="compact-stat-item">
                        <i class="bi bi-calendar-event"></i>
                        <span class="compact-stat-value" id="statsTournamentsJoined">0</span>
                        <span class="compact-stat-label">Tournaments Joined</span>
                        <div class="compact-stat-trend positive">
                            <i class="bi bi-arrow-up"></i>
                            <span>Active player</span>
                        </div>
                    </div>
                    <div class="compact-stat-item">
                        <i class="bi bi-controller"></i>
                        <span class="compact-stat-value" id="statsMatchesPlayed">0</span>
                        <span class="compact-stat-label">Matches Played</span>
                        <div class="compact-stat-trend positive">
                            <i class="bi bi-arrow-up"></i>
                            <span>Experience gained</span>
                        </div>
                    </div>
                    <div class="compact-stat-item">
                        <i class="bi bi-trophy"></i>
                        <span class="compact-stat-value" id="statsMatchesWon">0</span>
                        <span class="compact-stat-label">Matches Won</span>
                        <div class="compact-stat-trend positive">
                            <i class="bi bi-arrow-up"></i>
                            <span>Victories</span>
                        </div>
                    </div>
                    <div class="compact-stat-item">
                        <i class="bi bi-percent"></i>
                        <span class="compact-stat-value" id="statsWinRate">0%</span>
                        <span class="compact-stat-label">Win Rate</span>
                        <div class="compact-win-rate-progress">
                            <div class="progress" style="height: 8px;">
                                <div class="progress-bar" id="statsWinRateProgress" role="progressbar" style="width: 0%"></div>
                            </div>
                            <div class="win-rate-label">Success rate</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Compact Financial Stats -->
            <div class="compact-financial-stats">
                <div class="compact-stats-section-header">
                    <h3 class="stats-section-title">
                        <i class="bi bi-coin"></i>
                        Financial Overview
                    </h3>
                </div>
                <div class="compact-stats-grid">
                    <div class="compact-stat-item">
                        <i class="bi bi-trophy"></i>
                        <span class="compact-stat-value" id="statsTournamentWinnings">NPR.0</span>
                        <span class="compact-stat-label">Tournament Winnings</span>
                        <div class="compact-stat-trend positive">
                            <i class="bi bi-arrow-up"></i>
                            <span>Prize money</span>
                        </div>
                    </div>
                    <div class="compact-stat-item">
                        <i class="bi bi-people"></i>
                        <span class="compact-stat-value" id="statsReferralWinnings">NPR.0</span>
                        <span class="compact-stat-label">Referral Winnings</span>
                        <div class="compact-stat-trend positive">
                            <i class="bi bi-arrow-up"></i>
                            <span>Referral rewards</span>
                        </div>
                    </div>
                    <div class="compact-stat-item">
                        <i class="bi bi-cash-stack"></i>
                        <span class="compact-stat-value" id="statsEntryFees">NPR.0</span>
                        <span class="compact-stat-label">Entry Fees</span>
                        <div class="compact-stat-trend neutral">
                            <i class="bi bi-dash"></i>
                            <span>Investment</span>
                        </div>
                    </div>
                    <div class="compact-stat-item">
                        <i class="bi bi-calculator"></i>
                        <span class="compact-stat-value" id="statsNetEarnings">NPR.0</span>
                        <span class="compact-stat-label">Net Earnings</span>
                        <div class="compact-stat-trend positive">
                            <i class="bi bi-arrow-up"></i>
                            <span>Profit</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Compact Quick Summary -->
            <div class="compact-quick-summary">
                <div class="compact-summary-header">
                    <h3 class="stats-section-title">
                        <i class="bi bi-lightning-charge"></i>
                        Quick Summary
                    </h3>
                </div>
                <div class="compact-summary-content">
                    <div class="compact-summary-item">
                        <span class="summary-label">Best Performance:</span>
                        <span class="summary-value" id="statsBestPerformance">-</span>
                    </div>
                    <div class="compact-summary-item">
                        <span class="summary-label">Total Play Time:</span>
                        <span class="summary-value" id="statsTotalPlayTime">-</span>
                    </div>
                    <div class="compact-summary-item">
                        <span class="summary-label">Favorite Game:</span>
                        <span class="summary-value" id="statsFavoriteGame">-</span>
                    </div>
                </div>
            </div>
        </section>

         <!-- Debug Stats Section (for testing) -->
         <section id="debug-stats-section" class="section" style="display: none;">
             <h2 class="section-title">Debug Stats</h2>
             <div class="custom-card">
                 <h6 class="mb-3">Test Stats Updates</h6>
                 <div class="row g-2">
                     <div class="col-6">
                         <button class="btn btn-sm btn-primary w-100" onclick="updateUserStats('tournamentsJoined', 1)">
                             +1 Tournament
                         </button>
                     </div>
                     <div class="col-6">
                         <button class="btn btn-sm btn-success w-100" onclick="updateUserStats('matchesPlayed', 1)">
                             +1 Match Played
                         </button>
                     </div>
                     <div class="col-6">
                         <button class="btn btn-sm btn-warning w-100" onclick="updateUserStats('matchesWon', 1)">
                             +1 Match Won
                         </button>
                     </div>
                     <div class="col-6">
                         <button class="btn btn-sm btn-info w-100" onclick="updateUserStats('entryFeesPaid', 50)">
                             +NPR.50 Entry Fee
                         </button>
                     </div>
                 </div>
                 <small class="text-muted mt-2 d-block">Use these buttons to test stats updates</small>
                 <hr>
                 <button class="btn btn-sm btn-warning w-100" onclick="syncTournamentsJoined()">
                     Sync Tournaments Joined
                 </button>
                 <button class="btn btn-sm btn-danger w-100" onclick="fixMatchesPlayed()">
                     Fix Matches Played
                 </button>
                 <small class="text-muted mt-2 d-block">This will recalculate stats based on actual joined tournaments (excluding canceled ones for matches played)</small>
             </div>
         </section>

         <!-- Profile Section -->
        <section id="profile-section" class="section">
            <!-- Compact Mobile Profile Header -->
            <div class="compact-profile-header">
                <div class="profile-main-info">
                    <div class="profile-avatar-container">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNzAiIGhlaWdodD0iNzAiIHZpZXdCb3g9IjAgMCA3MCA3MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMzUiIGN5PSIzNSIgcj0iMzUiIGZpbGw9IiMzMDM2M0QiLz4KPHN2ZyB4PSIyMCIgeT0iMjAiIHdpZHRoPSIzMCIgaGVpZ2h0PSIzMCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSIjOEE5NDlFIj4KPHBhdGggZD0iTTEyIDEyYzIuMjEgMCA0LTEuNzkgNC00cy0xLjc5LTQtNC00LTQgMS43OS00IDQgMS43OSA0IDQgNHptMCAyYy0yLjY3IDAtOCAxLjM0LTggNHYyaDE2di0yYzAtMi42Ni01LjMzLTQtOC00eiIvPgo8L3N2Zz4KPC9zdmc+" alt="Avatar" class="profile-avatar" id="profileAvatarEl">
                        <button class="edit-avatar-btn" id="editProfileBtnEl">
                            <i class="bi bi-pencil"></i>
                        </button>
                    </div>
                    <div class="profile-info">
                        <h2 class="profile-name" id="profileNameEl">User Name</h2>
                        <p class="profile-email" id="profileEmailEl">user@example.com</p>
                        <div class="profile-status">
                            <span class="status-indicator online">
                                <i class="bi bi-circle-fill"></i>
                                Online
                            </span>
                        </div>
                    </div>
                </div>
                
                <!-- Compact Stats Row -->
                <div class="compact-stats-row">
                    <div class="compact-stat">
                        <i class="bi bi-trophy"></i>
                        <span class="compact-stat-value" id="profileTotalMatchesEl">0</span>
                        <span class="compact-stat-label">Matches</span>
                    </div>
                    <div class="compact-stat">
                        <i class="bi bi-award"></i>
                        <span class="compact-stat-value" id="profileWonMatchesEl">0</span>
                        <span class="compact-stat-label">Won</span>
                    </div>
                    <div class="compact-stat">
                        <i class="bi bi-coin"></i>
                        <span class="compact-stat-value" id="profileTotalEarningsEl">NPR.0</span>
                        <span class="compact-stat-label">Earnings</span>
                    </div>
                    <div class="compact-stat">
                        <i class="bi bi-calendar-event"></i>
                        <span class="compact-stat-value" id="profileTournamentsJoinedEl">0</span>
                        <span class="compact-stat-label">Tournaments</span>
                    </div>
                </div>
            </div>
            
            <!-- Compact Quick Actions -->
            <div class="compact-quick-actions">
                <div class="actions-row">
                    <div class="compact-action" data-section="earnings-section">
                        <i class="bi bi-coin"></i>
                        <span>Earnings</span>
                    </div>
                    <div class="compact-action" data-section="referral-section">
                        <i class="bi bi-person-plus"></i>
                        <span>Refer & Earn</span>
                    </div>
                    <div class="compact-action" data-section="stats-section">
                        <i class="bi bi-graph-up"></i>
                        <span>Stats</span>
                    </div>
                    <div class="compact-action" data-section="wallet-section">
                        <i class="bi bi-wallet2"></i>
                        <span>Wallet</span>
                    </div>
                </div>
            </div>
            
            <!-- Compact Menu Section -->
            <div class="compact-menu-section">
                <!-- Settings Row -->
                <div class="compact-menu-row">
                    <div class="compact-menu-item">
                        <i class="bi bi-bell"></i>
                        <span>Notifications</span>
                        <div class="toggle-switch">
                            <input type="checkbox" id="notificationSwitchEl" checked>
                            <label for="notificationSwitchEl"></label>
                        </div>
                    </div>
                    <div class="compact-menu-item" data-policy="privacy">
                        <i class="bi bi-shield-lock"></i>
                        <span>Privacy</span>
                        <i class="bi bi-chevron-right"></i>
                    </div>
                </div>
                
                <!-- Legal Row -->
                <div class="compact-menu-row">
                    <div class="compact-menu-item" data-policy="terms">
                        <i class="bi bi-file-text"></i>
                        <span>Terms</span>
                        <i class="bi bi-chevron-right"></i>
                    </div>
                    <div class="compact-menu-item" data-policy="refund">
                        <i class="bi bi-arrow-repeat"></i>
                        <span>Refund</span>
                        <i class="bi bi-chevron-right"></i>
                    </div>
                </div>
                
                <!-- Support Row -->
                <div class="compact-menu-row">
                    <div class="compact-menu-item" data-policy="fairPlay">
                        <i class="bi bi-patch-check"></i>
                        <span>Fair Play</span>
                        <i class="bi bi-chevron-right"></i>
                    </div>
                    <div class="compact-menu-item logout-item" id="logoutProfileBtnEl">
                        <i class="bi bi-box-arrow-right"></i>
                        <span>Logout</span>
                        <i class="bi bi-chevron-right"></i>
                    </div>
                </div>
            </div>
        </section>

        <!-- Support Section -->
        <section id="support-section" class="section">
            <!-- Mobile App Style Header -->
            <div class="mobile-app-header">
                <div class="header-content">
                    <div class="header-icon">
                        <i class="bi bi-headset"></i>
                    </div>
                    <div class="header-text">
                        <h1 class="app-title">Support</h1>
                        <p class="app-subtitle">Get help anytime</p>
                    </div>
                </div>
            </div>
            
            <!-- Mobile App Style Stats -->
            <div class="mobile-stats-container">
                <div class="stat-item">
                    <div class="stat-icon-wrapper active">
                        <i class="bi bi-clock"></i>
                    </div>
                    <div class="stat-info">
                        <span class="stat-number" id="supportActiveTicketsEl">0</span>
                        <span class="stat-label">Active</span>
                    </div>
                </div>
                <div class="stat-item">
                    <div class="stat-icon-wrapper resolved">
                        <i class="bi bi-check-circle"></i>
                    </div>
                    <div class="stat-info">
                        <span class="stat-number" id="supportResolvedTicketsEl">0</span>
                        <span class="stat-label">Resolved</span>
                    </div>
                </div>
                <div class="stat-item">
                    <div class="stat-icon-wrapper response">
                        <i class="bi bi-lightning"></i>
                    </div>
                    <div class="stat-info">
                        <span class="stat-number">< 2h</span>
                        <span class="stat-label">Response</span>
                    </div>
                </div>
            </div>
            
            <!-- Mobile App Style Create Ticket -->
            <div class="mobile-create-ticket">
                <div class="create-ticket-content">
                    <div class="ticket-icon">
                        <i class="bi bi-plus-circle"></i>
                    </div>
                    <div class="ticket-text">
                        <h3>Need Help?</h3>
                        <p>Create a support ticket and get help from our experts</p>
                    </div>
                </div>
                <button class="mobile-create-btn" id="createTicketBtnEl">
                    <i class="bi bi-plus"></i>
                    Create Ticket
                </button>
            </div>
            
            <!-- Mobile App Style Tickets List -->
            <div class="mobile-tickets-section">
                <div class="section-header">
                    <div class="header-left">
                        <i class="bi bi-ticket-detailed"></i>
                        <h3>My Tickets</h3>
                    </div>
                    <button class="mobile-refresh-btn" id="refreshTicketsBtnEl">
                        <i class="bi bi-arrow-clockwise"></i>
                    </button>
                </div>
                
                <div id="supportTicketsListEl" class="tickets-container">
                    <!-- Tickets will be loaded here -->
                </div>
                
                <div id="noTicketsMessageEl" class="mobile-empty-state" style="display: none;">
                    <div class="empty-icon">
                        <i class="bi bi-chat-dots"></i>
                    </div>
                    <h4>No tickets yet</h4>
                    <p>Create your first support ticket to get started!</p>
                    <button class="mobile-empty-btn" id="createFirstTicketBtnEl">
                        <i class="bi bi-plus"></i>
                        Create First Ticket
                    </button>
                </div>
            </div>
        </section>

        <!-- My Contests Section -->
        <section id="my-contests-section" class="section">
            <!-- Tournament Style Tabs -->
            <div class="tournament-tabs">
                <button class="tab-item active" data-status="upcoming">
                    <i class="bi bi-calendar-event-fill"></i> Upcoming
                </button>
                <button class="tab-item" data-status="ongoing">
                    <i class="bi bi-play-circle-fill"></i> Ongoing
                </button>
                <button class="tab-item" data-status="completed">
                    <i class="bi bi-trophy-fill"></i> Results
                </button>
            </div>

            <!-- Contests Container -->
            <div class="contests-container">
                <div id="myContestsPageListEl" class="contests-grid">
                    <!-- Enhanced Placeholder Contest Card -->
                    <div class="contest-card placeholder-glow">
                        <div class="contest-header">
                            <div class="contest-title-section">
                                <div class="placeholder" style="height: 20px; width: 60%; border-radius: 8px;"></div>
                                <div class="placeholder" style="height: 16px; width: 40%; border-radius: 6px; margin-top: 8px;"></div>
                            </div>
                            <div class="placeholder" style="height: 32px; width: 80px; border-radius: 16px;"></div>
                        </div>
                        <div class="contest-content">
                            <div class="contest-info">
                                <div class="placeholder" style="height: 16px; width: 100%; border-radius: 4px; margin-bottom: 8px;"></div>
                                <div class="placeholder" style="height: 16px; width: 80%; border-radius: 4px; margin-bottom: 8px;"></div>
                                <div class="placeholder" style="height: 16px; width: 90%; border-radius: 4px;"></div>
                            </div>
                            <div class="contest-prize">
                                <div class="placeholder" style="height: 24px; width: 70%; border-radius: 6px; margin-bottom: 8px;"></div>
                                <div class="placeholder" style="height: 14px; width: 50%; border-radius: 4px;"></div>
                            </div>
                        </div>
                        <div class="contest-actions">
                            <div class="placeholder" style="height: 40px; width: 100%; border-radius: 8px;"></div>
                        </div>
                    </div>
                </div>
                <p id="noMyContestsPageMessageEl" class="no-contests-message" style="display: none;">
                    <i class="bi bi-emoji-frown"></i>
                    <span>No contests found in this category.</span>
                    <small>Join some tournaments to see them here!</small>
                </p>
            </div>
        </section>

    </main>

    <!-- Modals -->
    <div class="modal fade" id="policyModalEl" tabindex="-1">
        <div class="modal-dialog modal-dialog-scrollable modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="policyModalTitleEl">Details</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="policyModalBodyEl" style="min-height: 300px;"></div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="addAmountModalEl" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="bi bi-wallet-fill me-2"></i> Add Money</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <!-- Step 1: Amount Input -->
                    <div id="depositStep1">
                        <h6 class="mb-3 text-light fw-bold">Step 1: Enter Amount</h6>
                        <div class="mb-3">
                            <label for="depositAmountInputEl" class="form-label text-light fw-bold">Amount (NPR.)</label>
                            <input type="number" class="form-control" id="depositAmountInputEl" placeholder="Enter amount" min="1" required>
                        </div>
                        <div class="mb-3">
                            <p class="small text-secondary">Pay QR/Your Payment app to:</p>
                            <p class="text-center text-warning"><strong>QR ID/Number:</strong> <span class="phonepe-number" id="upiIdDisplayStep1">YOUR_QR_ID_HERE</span></p>
                            
                            <!-- QR Code Display -->
                            <div id="qrCodeDisplayContainer" class="text-center mt-3" style="display: none;">
                                <p class="small text-secondary mb-2">Or scan QR code:</p>
                                <img id="qrCodeDisplayImg" class="img-fluid rounded" style="max-height: 150px; max-width: 150px; border: 2px solid var(--border-color);">
                                
                                <!-- QR Code Actions -->
                                <div class="qr-code-actions mt-2">
                                    <button type="button" class="btn btn-sm btn-outline-primary me-2" id="openQrFullscreenBtn" title="Open in Full Screen">
                                        <i class="bi bi-arrows-fullscreen me-1"></i>Full Screen
                                    </button>
                                    <button type="button" class="btn btn-sm btn-outline-success" id="saveQrCodeBtn" title="Save QR Code">
                                        <i class="bi bi-download me-1"></i>Save
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="d-grid gap-2">
                            <button type="button" class="btn btn-primary fw-bold" id="proceedToPaymentBtnEl">
                                <i class="bi bi-credit-card me-2"></i>Proceed to Payment
                            </button>
                        </div>
                    </div>

                    <!-- Step 2: Payment Instructions -->
                    <div id="depositStep2" style="display: none;">
                        <h6 class="mb-3 text-light fw-bold">Step 2: Complete Payment</h6>
                        <div class="alert alert-warning">
                            <i class="bi bi-exclamation-triangle me-2"></i>
                            <strong class="text-dark">Payment Instructions:</strong>
                            <ol class="mt-2 mb-0 text-dark">
                                <li>Copy the QR ID below or use any QR app</li>
                                <li>Pay NPR.<span id="paymentAmountEl" class="fw-bold text-danger">0</span> to the QR ID shown</li>
                                <li>Take a screenshot of the successful payment</li>
                                <li>Click "Payment Done" and upload the screenshot</li>
                            </ol>
                        </div>
                        
                        <!-- QR ID Display with Copy Button -->
                        <div class="mb-3">
                            <label class="form-label fw-bold text-light">QR ID to Pay:</label>
                            <div class="input-group">
                                <input type="text" class="form-control bg-light text-dark fw-bold" id="upiIdDisplayEl" value="YOUR_QR_ID_HERE" readonly>
                                <button class="btn btn-warning" type="button" id="copyUpiIdBtnEl" title="Copy QR ID">
                                    <i class="bi bi-clipboard"></i>
                                </button>
                            </div>
                            <small class="text-light">You can copy this QR ID and pay from any phone</small>
                        </div>
                        
                        <div class="d-grid gap-2">
                            <button type="button" class="btn btn-success fw-bold" id="paymentDoneBtnEl">
                                <i class="bi bi-check-circle me-2"></i>Payment Done
                            </button>
                            <button type="button" class="btn btn-secondary fw-bold" id="backToStep1BtnEl">
                                <i class="bi bi-arrow-left me-2"></i>Back
                            </button>
                        </div>
                    </div>

                    <!-- Step 3: Upload Screenshot -->
                    <div id="depositStep3" style="display: none;">
                        <h6 class="mb-3 text-light fw-bold">Step 3: Upload Payment Screenshot</h6>
                        <div class="mb-3">
                            <label for="paymentScreenshotInputEl" class="form-label text-light fw-bold">Payment Screenshot</label>
                            <input type="file" class="form-control" id="paymentScreenshotInputEl" accept="image/*" required>
                                                          <div class="form-text text-light">Upload a clear screenshot of your payment transaction</div>
                        </div>
                        <div id="screenshotPreviewEl" class="mb-3" style="display: none;">
                            <img id="screenshotPreviewImgEl" class="img-fluid rounded" style="max-height: 200px;">
                        </div>
                        <div id="depositStatusMessageEl" class="alert mt-3" style="display: none;"></div>
                        <div class="d-grid gap-2">
                            <button type="button" class="btn btn-primary fw-bold" id="submitDepositBtnEl">
                                <i class="bi bi-upload me-2"></i>Submit Deposit Request
                            </button>
                            <button type="button" class="btn btn-secondary fw-bold" id="backToStep2BtnEl">
                                <i class="bi bi-arrow-left me-2"></i>Back
                            </button>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary fw-bold" data-bs-dismiss="modal">Cancel</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- QR Code Fullscreen Modal -->
    <div class="modal fade" id="qrCodeFullscreenModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="bi bi-qr-code me-2"></i>QR Code - Full Screen
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body text-center">
                    <img id="qrCodeFullscreenImg" class="img-fluid" style="max-width: 100%; max-height: 70vh;">
                    <div class="mt-3">
                        <p class="text-muted mb-2">Scan this QR code with any QR app to make payment</p>
                        <button type="button" class="btn btn-success" id="saveQrCodeFullscreenBtn">
                            <i class="bi bi-download me-2"></i>Save QR Code
                        </button>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="modal fade" id="withdrawModalEl" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="bi bi-cash-coin me-2"></i> Withdraw Funds</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p class="small text-secondary">Withdrawable balance: <strong class="text-light" id="withdrawModalBalanceEl">NPR.0.00</strong></p>
                    <div class="mb-3">
                        <label for="withdrawAmountInputEl" class="form-label">Amount (Min NPR.<span id="minWithdrawAmountEl">50</span>)</label>
                        <input type="number" class="form-control" id="withdrawAmountInputEl" placeholder="Enter amount">
                        <div class="form-text" id="withdrawLimitsHelp"></div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Withdrawal Method</label>
                        <div id="withdrawMethodsContainer"></div>
                        <input type="text" class="form-control mt-2" id="withdrawMethodInputEl" placeholder="Enter details">
                    </div>
                    <div id="withdrawStatusMessageEl" class="alert mt-3" style="display: none;"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-custom btn-custom-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-custom btn-custom-primary" id="submitWithdrawRequestBtnEl">Submit Request</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="matchDetailsModalEl" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="matchDetailsModalTitleEl">Match Details</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="matchDetailsModalBodyEl"></div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="idPasswordModalEl" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Room ID & Password</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body text-center">
                    <p class="small text-secondary">ID/Pass shown shortly before match start.</p>
                    <div class="my-3 p-3" style="background: var(--primary-bg); border-radius: 8px;">
                        <p class="mb-1">Room ID:</p>
                        <h4 id="roomIdDisplayEl" class="text-accent referral-code placeholder-glow d-inline-block"><span class="placeholder col-6"></span></h4>
                        <button class="btn btn-sm btn-outline-warning ms-2 copy-btn" data-target="#roomIdDisplayEl" title="Copy Room ID"><i class="bi bi-clipboard"></i></button>
                    </div>
                    <div class="my-3 p-3" style="background: var(--primary-bg); border-radius: 8px;">
                        <p class="mb-1">Password:</p>
                        <h4 id="roomPasswordDisplayEl" class="text-accent referral-code placeholder-glow d-inline-block"><span class="placeholder col-6"></span></h4>
                        <button class="btn btn-sm btn-outline-warning ms-2 copy-btn" data-target="#roomPasswordDisplayEl" title="Copy Password"><i class="bi bi-clipboard"></i></button>
                    </div>
                    <p class="small text-warning"><i class="bi bi-exclamation-triangle"></i> Don't share ID/Password.</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Tournament Results Modal -->
    <div class="modal fade" id="tournamentResultsModalEl" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="tournamentResultsModalTitleEl">Tournament Results</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="tournamentResultsContentEl">
                        <div class="text-center p-4">
                            <div class="spinner-border text-primary" role="status">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                            <p class="mt-2 text-secondary">Loading tournament results...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- *** MODIFIED: In-Game Name Modal *** -->
    <div class="modal fade" id="inGameNameModalEl" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="inGameNameModalTitleEl">Confirm Your In-Game Details</h5>
                </div>
                <div class="modal-body">
                    <p class="small text-secondary" id="inGameNameModalDescriptionEl">Please provide your details for the tournament.</p>
                    <form id="inGameNameFormEl">
                        <input type="hidden" id="inGameNameTournamentIdInputEl">
                        <input type="hidden" id="tournamentModeInputEl">
                        
                        <!-- Solo Mode Fields -->
                        <div id="soloFields">
                            <div class="mb-3">
                                <label for="inGameNameInputEl" class="form-label">In-Game Name (IGN)</label>
                                <input type="text" class="form-control" id="inGameNameInputEl" required>
                            </div>
                            <div class="mb-3">
                                <label for="inGameUidInputEl" class="form-label">In-Game UID / ID</label>
                                <input type="text" class="form-control" id="inGameUidInputEl" required>
                            </div>
                        </div>
                        
                        <!-- Duo Mode Fields -->
                        <div id="duoFields" style="display: none;">
                            <h6 class="text-primary mb-3">Player 1 (You)</h6>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="duoPlayer1NameInputEl" class="form-label">In-Game Name</label>
                                    <input type="text" class="form-control" id="duoPlayer1NameInputEl" required>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="duoPlayer1UidInputEl" class="form-label">In-Game UID</label>
                                    <input type="text" class="form-control" id="duoPlayer1UidInputEl" required>
                                </div>
                            </div>
                            <h6 class="text-success mb-3">Player 2 (Teammate)</h6>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="duoPlayer2NameInputEl" class="form-label">In-Game Name</label>
                                    <input type="text" class="form-control" id="duoPlayer2NameInputEl" required>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="duoPlayer2UidInputEl" class="form-label">In-Game UID</label>
                                    <input type="text" class="form-control" id="duoPlayer2UidInputEl" required>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Squad Mode Fields -->
                        <div id="squadFields" style="display: none;">
                            <h6 class="text-primary mb-3">Player 1 (You)</h6>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="squadPlayer1NameInputEl" class="form-label">In-Game Name</label>
                                    <input type="text" class="form-control" id="squadPlayer1NameInputEl" required>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="squadPlayer1UidInputEl" class="form-label">In-Game UID</label>
                                    <input type="text" class="form-control" id="squadPlayer1UidInputEl" required>
                                </div>
                            </div>
                            <h6 class="text-success mb-3">Player 2</h6>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="squadPlayer2NameInputEl" class="form-label">In-Game Name</label>
                                    <input type="text" class="form-control" id="squadPlayer2NameInputEl" required>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="squadPlayer2UidInputEl" class="form-label">In-Game UID</label>
                                    <input type="text" class="form-control" id="squadPlayer2UidInputEl" required>
                                </div>
                            </div>
                            <h6 class="text-warning mb-3">Player 3</h6>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="squadPlayer3NameInputEl" class="form-label">In-Game Name</label>
                                    <input type="text" class="form-control" id="squadPlayer3NameInputEl" required>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="squadPlayer3UidInputEl" class="form-label">In-Game UID</label>
                                    <input type="text" class="form-control" id="squadPlayer3UidInputEl" required>
                                </div>
                            </div>
                            <h6 class="text-info mb-3">Player 4</h6>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="squadPlayer4NameInputEl" class="form-label">In-Game Name</label>
                                    <input type="text" class="form-control" id="squadPlayer4NameInputEl" required>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="squadPlayer4UidInputEl" class="form-label">In-Game UID</label>
                                    <input type="text" class="form-control" id="squadPlayer4UidInputEl" required>
                                </div>
                            </div>
                        </div>
                        
                        <div id="inGameNameStatusMessageEl" class="alert" style="display: none;"></div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-custom btn-custom-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-custom btn-custom-primary" id="saveInGameNameBtnEl">Confirm & Join</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Profile Modal -->
    <div class="modal fade" id="editProfileModalEl" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Edit Profile</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="editProfileFormEl">
                        <div class="text-center mb-3">
                            <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOTAiIGhlaWdodD0iOTAiIHZpZXdCb3g9IjAgMCA5MCA5MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iNDUiIGN5PSI0NSIgcj0iNDUiIGZpbGw9IiMzMDM2M0QiLz4KPHN2ZyB4PSIyNSIgeT0iMjUiIHdpZHRoPSI0MCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSIjOEE5NDlFIj4KPHBhdGggZD0iTTEyIDEyYzIuMjEgMCA0LTEuNzkgNC00cy0xLjc5LTQtNC00LTQgMS43OS00IDQgMS43OSA0IDQgNHptMCAyYy0yLjY3IDAtOCAxLjM0LTggNHYyaDE2di0yYzAtMi42Ni01LjMzLTQtOC00eiIvPgo8L3N2Zz4KPC9zdmc+" alt="Avatar Preview" class="profile-avatar" id="editProfileAvatarPreviewEl" style="width: 90px; height: 90px;">
                        </div>
                        <div class="mb-3">
                            <label for="editProfilePhotoInputEl" class="form-label">Change Profile Photo</label>
                            <input type="file" class="form-control" id="editProfilePhotoInputEl" accept="image/*">
                            <div class="form-text">Uploading a new photo will replace the old one.</div>
                            <div class="imgbb-upload-status mt-2"></div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="editProfileFirstNameInputEl" class="form-label">First Name</label>
                                <input type="text" class="form-control" id="editProfileFirstNameInputEl" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="editProfileLastNameInputEl" class="form-label">Last Name</label>
                                <input type="text" class="form-control" id="editProfileLastNameInputEl" required>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="editProfileUsernameInputEl" class="form-label">Username</label>
                            <input type="text" class="form-control" id="editProfileUsernameInputEl" required>
                            <small class="text-muted">This is your unique identifier</small>
                        </div>
                        <div class="mb-3">
                            <label for="editProfileDisplayNameInputEl" class="form-label">Display Name</label>
                            <input type="text" class="form-control" id="editProfileDisplayNameInputEl" required>
                        </div>
                        <div id="editProfileStatusMessageEl" class="alert" style="display: none;"></div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-custom btn-custom-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-custom btn-custom-primary" id="saveProfileBtnEl">Save Changes</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Create Support Ticket Modal -->
    <div class="modal fade" id="createTicketModalEl" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="bi bi-headset me-2"></i>
                        Create Support Ticket
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="createTicketFormEl">
                        <div class="mb-3">
                            <label for="ticketSubjectInputEl" class="form-label">Subject</label>
                            <input type="text" class="form-control" id="ticketSubjectInputEl" placeholder="Brief description of your issue" required>
                        </div>
                        <div class="mb-3">
                            <label for="ticketCategoryInputEl" class="form-label">Category</label>
                            <select class="form-control" id="ticketCategoryInputEl" required>
                                <option value="">Select a category</option>
                                <option value="technical">Technical Issue</option>
                                <option value="payment">Payment Problem</option>
                                <option value="tournament">Tournament Related</option>
                                <option value="account">Account Issue</option>
                                <option value="general">General Inquiry</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="ticketPriorityInputEl" class="form-label">Priority</label>
                            <select class="form-control" id="ticketPriorityInputEl" required>
                                <option value="low">Low</option>
                                <option value="medium" selected>Medium</option>
                                <option value="high">High</option>
                                <option value="urgent">Urgent</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="ticketDescriptionInputEl" class="form-label">Description</label>
                            <textarea class="form-control" id="ticketDescriptionInputEl" rows="4" placeholder="Please provide detailed information about your issue..." required></textarea>
                        </div>
                        <div id="createTicketStatusMessageEl" class="alert" style="display: none;"></div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-custom btn-custom-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-custom btn-custom-primary" id="submitTicketBtnEl">Create Ticket</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Support Chat Modal -->
    <div class="modal fade" id="supportChatModalEl" tabindex="-1" data-bs-backdrop="static">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="bi bi-chat-dots me-2"></i>
                        Support Chat - <span id="chatTicketSubjectEl">Ticket Subject</span>
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <!-- Ticket Info -->
                    <div class="ticket-info mb-3 p-3" style="background: var(--primary-bg); border-radius: 8px; border: 1px solid var(--border-color);">
                        <div class="row">
                            <div class="col-md-6">
                                <small class="text-secondary">Ticket ID: <span id="chatTicketIdEl" class="text-accent"></span></small>
                            </div>
                            <div class="col-md-6 text-end">
                                <span class="badge" id="chatTicketStatusEl">Status</span>
                            </div>
                        </div>
                        <div class="row mt-2">
                            <div class="col-md-6">
                                <small class="text-secondary">Category: <span id="chatTicketCategoryEl"></span></small>
                            </div>
                            <div class="col-md-6 text-end">
                                <small class="text-secondary">Priority: <span id="chatTicketPriorityEl"></span></small>
                            </div>
                        </div>
                    </div>

                    <!-- Chat Messages -->
                    <div class="chat-container" style="height: 400px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 8px; padding: 15px; background: var(--primary-bg);">
                        <div id="chatMessagesEl">
                            <!-- Messages will be populated here -->
                        </div>
                    </div>

                    <!-- Chat Input -->
                    <div class="chat-input mt-3">
                        <div class="input-group">
                            <input type="text" class="form-control" id="chatMessageInputEl" placeholder="Type your message..." maxlength="500">
                            <button class="btn btn-custom btn-custom-primary" type="button" id="sendChatMessageBtnEl">
                                <i class="bi bi-send"></i>
                            </button>
                        </div>
                        <small class="text-secondary">Press Enter to send</small>
                    </div>

                    <!-- Ticket Actions -->
                    <div class="ticket-actions mt-3 text-end">
                        <button class="btn btn-sm btn-custom btn-custom-success" id="resolveTicketBtnEl" style="display: none;">
                            <i class="bi bi-check-circle me-2"></i>Resolve Ticket
                        </button>
                        <button class="btn btn-sm btn-custom btn-custom-secondary" id="closeTicketBtnEl">
                            <i class="bi bi-x-circle me-2"></i>Close Chat
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>




    <!-- Deposit History Modal -->
    <div class="modal fade" id="depositHistoryModalEl" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="bi bi-clock-history me-2"></i>
                        Deposit History
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="deposit-history-container">
                        <div class="deposit-history-filters mb-3">
                            <div class="row">
                                <div class="col-md-6">
                                    <label for="depositStatusFilter" class="form-label">Filter by Status</label>
                                    <select class="form-select" id="depositStatusFilter">
                                        <option value="all">All Status</option>
                                        <option value="pending">Pending</option>
                                        <option value="approved">Approved</option>
                                        <option value="rejected">Rejected</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label for="depositDateFilter" class="form-label">Filter by Date</label>
                                    <select class="form-select" id="depositDateFilter">
                                        <option value="all">All Time</option>
                                        <option value="today">Today</option>
                                        <option value="week">This Week</option>
                                        <option value="month">This Month</option>
                                        <option value="year">This Year</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="deposit-history-content">
                            <div id="depositHistoryListEl" class="deposit-history-list">
                                <!-- Deposit history items will be loaded here -->
                            </div>
                            
                            <div id="depositHistoryEmptyEl" class="empty-deposits" style="display: none;">
                                <div class="empty-icon">
                                    <i class="bi bi-receipt"></i>
                                </div>
                                <h4 class="empty-title">No Deposits Found</h4>
                                <p class="empty-subtitle">Your deposit history will appear here</p>
                            </div>
                            
                            <div id="depositHistoryLoadingEl" class="deposit-history-loading">
                                <div class="spinner-border text-primary" role="status">
                                    <span class="visually-hidden">Loading...</span>
                                </div>
                                <p class="mt-2">Loading deposit history...</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <button class="nav-item active" data-section="home-section"><i class="bi bi-house-door-fill"></i><span>Home</span></button>
        <button class="nav-item" data-section="my-contests-section"><i class="bi bi-trophy-fill"></i><span>My Contests</span></button>
        <button class="nav-item" data-section="leaderboard-section"><i class="bi bi-award"></i><span>Leaderboard</span></button>
        <button class="nav-item" data-section="support-section"><i class="bi bi-headset"></i><span>Support</span></button>
        <button class="nav-item" data-section="profile-section"><i class="bi bi-person-fill"></i><span>Profile</span></button>
    </nav>

    <!-- JS Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

    <!-- Firebase SDK & App Logic -->
    <script type="module">
        // Firebase Imports
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        import { getDatabase, ref, get, set, update, push, query, orderByChild, equalTo, onValue, runTransaction, off, limitToLast, serverTimestamp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-database.js"; // Added serverTimestamp
        import { getAuth, GoogleAuthProvider, signInWithPopup, signOut, onAuthStateChanged, createUserWithEmailAndPassword, signInWithEmailAndPassword, sendPasswordResetEmail } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js";

        // ===============================================================
        // ================= !!! IMPORTANT !!! ===========================
        // Replace the placeholder values below with your actual Firebase project configuration.
        // You can find these details in your Firebase project settings:
        // Project settings > General > Your apps > Web app > SDK setup and configuration > Config
        // ===============================================================
        const firebaseConfig = {
 apiKey: "AIzaSyCGrSGtJDZ10Sp_WCd1gnVO5zkfZVJE5fA",
 authDomain: "win-98-e1681.firebaseapp.com",
 databaseURL: "https://win-98-e1681-default-rtdb.firebaseio.com",
 projectId: "win-98-e1681",
 storageBucket: "win-98-e1681.firebasestorage.app",
 messagingSenderId: "758395077705",
 appId: "1:758395077705:web:b9c065cd0904a3dd22eb98",
 measurementId: "G-JSQCHCBL3V"
};
        const IMGBB_API_KEY = '484e36ae8bdffeaeec2a8e1a416e024b'; // <-- IMPORTANT: Replace with your actual ImgBB API key
         // ===============================================================
         // ===============================================================

        // Initialize Firebase
        let app, db, auth;
        try {
            // Check if placeholder values are still present
            if (firebaseConfig.apiKey === "YOUR_API_KEY" || firebaseConfig.projectId === "YOUR_PROJECT_ID") {
                console.warn("Firebase config using placeholder values. Replace them with your actual project details.");
                // Optionally prevent initialization or show a UI warning here
                // For this example, we'll allow initialization but log the warning.
            }
            app = initializeApp(firebaseConfig);
            db = getDatabase(app);
            auth = getAuth(app);
            console.log("Firebase Initialized (check config if using placeholders)");
        } catch (error) {
            console.error("Firebase initialization failed:", error);
            document.body.innerHTML = `<div class="alert alert-danger m-5 position-fixed top-0 start-0 end-0" style="z-index: 10000;">Critical Error: Could not connect. Check Firebase config & console. Error: ${error.message}</div>`;
        }

        // --- DOM Elements Cache ---
         const getElement = (id) => document.getElementById(id);
         const querySel = (selector) => document.querySelector(selector);
         const querySelAll = (selector) => document.querySelectorAll(selector);
         const elements = {
             sections: null, // Will be initialized after DOM loads
             bottomNavItems: null, // Will be initialized after DOM loads
             globalLoader: null, // Will be initialized after DOM loads
             headerBackBtn: getElement('headerBackBtnEl'), headerTitleContainer: getElement('headerTitleContainerEl'), headerGameTitle: getElement('headerGameTitleEl'), headerWalletChip: getElement('headerWalletChipEl'), headerChipBalance: getElement('headerChipBalanceEl'), headerUserGreeting: getElement('headerUserGreetingEl'), appLogo: getElement('appLogoEl'), notificationBtn: getElement('notificationBtnEl'), notificationBadge: querySel('.notification-badge'),
             loginSection: getElement('login-section'),
             // Login Form Elements
             emailLoginForm: getElement('emailLoginForm'),
             loginEmailInput: getElement('loginEmailInputEl'),
             loginPasswordInput: getElement('loginPasswordInputEl'),
             loginEmailBtn: getElement('loginEmailBtnEl'),
             showSignupToggleBtn: getElement('showSignupToggleBtnEl'),
             loginStatusMessage: getElement('loginStatusMessageEl'),
             forgotPasswordLink: getElement('forgotPasswordLinkEl'),
             // Signup Form Elements
             emailSignupForm: getElement('emailSignupForm'),
             signupFirstNameInput: getElement('signupFirstNameInputEl'),
             signupLastNameInput: getElement('signupLastNameInputEl'),
             signupUsernameInput: getElement('signupUsernameInputEl'),
             signupEmailInput: getElement('signupEmailInputEl'),
             signupPhoneInput: getElement('signupPhoneInputEl'),
             signupPasswordInput: getElement('signupPasswordInputEl'),
             signupConfirmPasswordInput: getElement('signupConfirmPasswordInputEl'),
             signupReferralCodeInput: getElement('signupReferralCodeInputEl'), // <<< Added Referral Code Input Element
             signupEmailBtn: getElement('signupEmailBtnEl'),
             showLoginToggleBtn: getElement('showLoginToggleBtnEl'),
             signupStatusMessage: getElement('signupStatusMessageEl'),
             homeSection: getElement('home-section'), promotionSlider: getElement('promotionSliderEl'), gamesList: getElement('gamesListEl'), myContestsList: getElement('myContestsListEl'), noContestsMessage: getElement('noContestsMessageEl'), homeTotalEarnings: getElement('homeTotalEarnings'), homeTournamentsJoined: getElement('homeTournamentsJoined'), homeMatchesPlayed: getElement('homeMatchesPlayed'), homeWinRate: getElement('homeWinRate'),
             tournamentsSection: getElement('tournaments-section'), tournamentsListContainer: getElement('tournamentsListContainerEl'), noTournamentsMessage: getElement('noTournamentsMessageEl'), tournamentTabs: querySelAll('.tournament-tabs .tab-item'),
             walletSection: getElement('wallet-section'), walletTotalBalance: getElement('walletTotalBalanceEl'), walletWinningCash: getElement('walletWinningCashEl'), walletBonusCash: getElement('walletBonusCashEl'), allTransactionsBtn: getElement('allTransactionsBtnEl'), withdrawBtn: getElement('withdrawBtnEl'), addAmountWalletBtn: getElement('addAmountWalletBtnEl'), recentTransactionsList: getElement('recentTransactionsListEl'), noTransactionsMessage: getElement('noTransactionsMessageEl'), totalBalanceEl: getElement('totalBalanceEl'), monthlyEarningsEl: getElement('monthlyEarningsEl'), totalWithdrawalsEl: getElement('totalWithdrawalsEl'), transactionsCountEl: getElement('transactionsCountEl'),
             earningsSection: getElement('earnings-section'), 
            earningsTotal: getElement('earningsTotalEl'), 
            earningsReferral: getElement('earningsReferralEl'), 
            netEarnings: getElement('netEarningsEl'),
            viewEarningsHistoryBtn: getElement('viewReferralHistoryBtn'),
            viewTournamentsBtn: getElement('viewTournamentsBtn'),
            earningsHistoryList: getElement('earningsHistoryList'),
             referralSection: getElement('referral-section'), referralEarnings: getElement('referralEarningsEl'), referralCount: getElement('referralCountEl'), userReferralCode: getElement('userReferralCodeEl'), copyReferralCodeBtn: getElement('copyReferralCodeBtn'), referralHistoryList: getElement('referralHistoryListEl'), noReferralHistory: getElement('noReferralHistoryEl'), referralCountText: getElement('referralCountText'), viewReferralHistoryBtn: getElement('viewReferralHistoryBtn'), refreshReferralHistoryBtn: getElement('refreshReferralHistoryBtn'), debugReferralBtn: getElement('debugReferralBtn'),
             leaderboardSection: getElement('leaderboard-section'), leaderboardList: getElement('leaderboardListEl'), noLeaderboardMessage: getElement('noLeaderboardMessageEl'), leaderboardTabs: querySelAll('#leaderboard-section .tab-item'),
             statsSection: getElement('stats-section'), statsTournamentsJoined: getElement('statsTournamentsJoined'), statsMatchesPlayed: getElement('statsMatchesPlayed'), statsMatchesWon: getElement('statsMatchesWon'), statsWinRate: getElement('statsWinRate'), statsWinRateProgress: getElement('statsWinRateProgress'), statsTournamentWinnings: getElement('statsTournamentWinnings'), statsReferralWinnings: getElement('statsReferralWinnings'), statsEntryFees: getElement('statsEntryFees'), statsNetEarnings: getElement('statsNetEarnings'),
                            profileSection: getElement('profile-section'), profileAvatar: getElement('profileAvatarEl'), profileName: getElement('profileNameEl'), profileEmail: getElement('profileEmailEl'), profileTotalMatches: getElement('profileTotalMatchesEl'), profileWonMatches: getElement('profileWonMatchesEl'), profileTotalEarnings: getElement('profileTotalEarningsEl'), profileTournamentsJoined: getElement('profileTournamentsJoinedEl'), logoutProfileBtn: getElement('logoutProfileBtnEl'), policyLinks: querySelAll('.profile-links a[data-policy], .profile-links button[data-policy]'), notificationSwitch: getElement('notificationSwitchEl'),
             policyModalInstance: getElement('policyModalEl') ? new bootstrap.Modal(getElement('policyModalEl')) : null, policyModalTitle: getElement('policyModalTitleEl'), policyModalBody: getElement('policyModalBodyEl'),
             addAmountModalInstance: getElement('addAmountModalEl') ? new bootstrap.Modal(getElement('addAmountModalEl')) : null, modalUserEmail: getElement('modalUserEmailEl'),
             // Deposit Modal Elements
             depositStep1: getElement('depositStep1'),
             depositStep2: getElement('depositStep2'),
             depositStep3: getElement('depositStep3'),
             depositAmountInput: getElement('depositAmountInputEl'),
             paymentAmountEl: getElement('paymentAmountEl'),
             proceedToPaymentBtn: getElement('proceedToPaymentBtnEl'),
             paymentDoneBtn: getElement('paymentDoneBtnEl'),
             backToStep1Btn: getElement('backToStep1BtnEl'),
             paymentScreenshotInput: getElement('paymentScreenshotInputEl'),
             screenshotPreviewEl: getElement('screenshotPreviewEl'),
             screenshotPreviewImg: getElement('screenshotPreviewImgEl'),
             depositStatusMessage: getElement('depositStatusMessageEl'),
             submitDepositBtn: getElement('submitDepositBtnEl'),
             backToStep2Btn: getElement('backToStep2BtnEl'),
             upiIdDisplay: getElement('upiIdDisplayEl'),
             copyUpiIdBtn: getElement('copyUpiIdBtnEl'),
             qrCodeDisplayContainer: getElement('qrCodeDisplayContainer'),
             qrCodeDisplayImg: getElement('qrCodeDisplayImg'),
             upiIdDisplayStep1: getElement('upiIdDisplayStep1'),
             openQrFullscreenBtn: getElement('openQrFullscreenBtn'),
             saveQrCodeBtn: getElement('saveQrCodeBtn'),
             qrCodeFullscreenModal: getElement('qrCodeFullscreenModal'),
             qrCodeFullscreenImg: getElement('qrCodeFullscreenImg'),
             saveQrCodeFullscreenBtn: getElement('saveQrCodeFullscreenBtn'),
             withdrawModalInstance: getElement('withdrawModalEl') ? new bootstrap.Modal(getElement('withdrawModalEl')) : null, withdrawModalBalance: getElement('withdrawModalBalanceEl'), withdrawAmountInput: getElement('withdrawAmountInputEl'), withdrawMethodInput: getElement('withdrawMethodInputEl'), minWithdrawAmount: getElement('minWithdrawAmountEl'), withdrawStatusMessage: getElement('withdrawStatusMessageEl'), submitWithdrawRequestBtn: getElement('submitWithdrawRequestBtnEl'),
             matchDetailsModalInstance: getElement('matchDetailsModalEl') ? new bootstrap.Modal(getElement('matchDetailsModalEl')) : null, matchDetailsModalTitle: getElement('matchDetailsModalTitleEl'), matchDetailsModalBody: getElement('matchDetailsModalBodyEl'),
             idPasswordModalInstance: getElement('idPasswordModalEl') ? new bootstrap.Modal(getElement('idPasswordModalEl')) : null, roomIdDisplay: getElement('roomIdDisplayEl'), roomPasswordDisplay: getElement('roomPasswordDisplayEl'),
             tournamentResultsModalInstance: getElement('tournamentResultsModalEl') ? new bootstrap.Modal(getElement('tournamentResultsModalEl')) : null, tournamentResultsModalTitle: getElement('tournamentResultsModalTitleEl'), tournamentResultsContent: getElement('tournamentResultsContentEl'),
             securityWarning: getElement('securityWarning'),
             // In-Game Name Modal
             inGameNameModalInstance: getElement('inGameNameModalEl') ? new bootstrap.Modal(getElement('inGameNameModalEl')) : null,
             inGameNameModalTitleEl: getElement('inGameNameModalTitleEl'),
             inGameNameModalDescriptionEl: getElement('inGameNameModalDescriptionEl'),
             inGameNameForm: getElement('inGameNameFormEl'),
             inGameNameTournamentIdInput: getElement('inGameNameTournamentIdInputEl'),
             tournamentModeInput: getElement('tournamentModeInputEl'),
             inGameNameInput: getElement('inGameNameInputEl'),
             inGameUidInput: getElement('inGameUidInputEl'),
             inGameNameStatusMessage: getElement('inGameNameStatusMessageEl'),
             saveInGameNameBtn: getElement('saveInGameNameBtnEl'),
            // Edit Profile Modal
            editProfileBtn: getElement('editProfileBtnEl'),
            editProfileModalInstance: getElement('editProfileModalEl') ? new bootstrap.Modal(getElement('editProfileModalEl')) : null,
            editProfileAvatarPreview: getElement('editProfileAvatarPreviewEl'),
            editProfilePhotoInput: getElement('editProfilePhotoInputEl'),
            editProfileFirstNameInput: getElement('editProfileFirstNameInputEl'),
            editProfileLastNameInput: getElement('editProfileLastNameInputEl'),
            editProfileUsernameInput: getElement('editProfileUsernameInputEl'),
            editProfileDisplayNameInput: getElement('editProfileDisplayNameInputEl'),
            editProfileStatusMessage: getElement('editProfileStatusMessageEl'),
            saveProfileBtn: getElement('saveProfileBtnEl'),
             // My Contests Page
             myContestsSection: getElement('my-contests-section'),
             myContestsPageList: getElement('myContestsPageListEl'),
             noMyContestsPageMessage: getElement('noMyContestsPageMessageEl'),
             myContestsTabs: querySelAll('#my-contests-section .tournament-tabs .tab-item'),
             // Support Elements
             supportActiveTicketsEl: getElement('supportActiveTicketsEl'),
             supportResolvedTicketsEl: getElement('supportResolvedTicketsEl'),
             supportTicketsListEl: getElement('supportTicketsListEl'),
             noTicketsMessageEl: getElement('noTicketsMessageEl'),
             createTicketBtnEl: getElement('createTicketBtnEl'),
             refreshTicketsBtnEl: getElement('refreshTicketsBtnEl'),
             submitTicketBtnEl: getElement('submitTicketBtnEl'),
             sendChatMessageBtnEl: getElement('sendChatMessageBtnEl'),
             resolveTicketBtnEl: getElement('resolveTicketBtnEl'),
             closeTicketBtnEl: getElement('closeTicketBtnEl'),
             // Deposit History Modal
             depositHistoryModalInstance: getElement('depositHistoryModalEl') ? new bootstrap.Modal(getElement('depositHistoryModalEl')) : null,
             depositHistoryList: getElement('depositHistoryListEl'),
             depositHistoryEmpty: getElement('depositHistoryEmptyEl'),
             depositHistoryLoading: getElement('depositHistoryLoadingEl'),
             depositStatusFilter: getElement('depositStatusFilter'),
             depositDateFilter: getElement('depositDateFilter')
         };

        // --- App State ---
        let currentUser = null; let userProfile = {}; let currentSectionId = 'login-section'; let dbListeners = {};
        let swiperInstance; let currentTournamentGameId = null; let appSettings = {};
        let validReferrerUid = null; // <<< To store referrer UID temporarily
        let signupPhoneNumber = null; // <<< To store phone number during signup
        let signupFirstName = null; // <<< To store first name during signup
        let signupLastName = null; // <<< To store last name during signup
        let signupUsername = null; // <<< To store username during signup

        // --- Performance Cache ---
        let promotionsCache = null;
        let gamesCache = null;
        let settingsCache = null;
        let lastPromotionsLoad = 0;
        let lastGamesLoad = 0;
        let lastSettingsLoad = 0;
        const CACHE_DURATION = 60000; // 1 minute cache

        // --- QR Code Functions ---
        function openQrCodeFullscreen() {
            if (elements.qrCodeFullscreenImg && elements.qrCodeDisplayImg) {
                elements.qrCodeFullscreenImg.src = elements.qrCodeDisplayImg.src;
                const modal = new bootstrap.Modal(elements.qrCodeFullscreenModal);
                modal.show();
            }
        }
        
        function saveQrCodeImage() {
            const qrCodeImg = elements.qrCodeDisplayImg || elements.qrCodeFullscreenImg;
            if (!qrCodeImg || !qrCodeImg.src) {
                alert('QR code image not available');
                return;
            }
            
            try {
                // Create a temporary link element
                const link = document.createElement('a');
                link.href = qrCodeImg.src;
                link.download = 'qr-code-payment.png';
                
                // Append to body, click, and remove
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                // Show success message
                if (elements.qrCodeFullscreenModal) {
                    const modal = bootstrap.Modal.getInstance(elements.qrCodeFullscreenModal);
                    if (modal) {
                        // Show temporary success message
                        const saveBtn = elements.saveQrCodeFullscreenBtn;
                        const originalText = saveBtn.innerHTML;
                        saveBtn.innerHTML = '<i class="bi bi-check-circle me-2"></i>Saved!';
                        saveBtn.classList.remove('btn-success');
                        saveBtn.classList.add('btn-outline-success');
                        
                        setTimeout(() => {
                            saveBtn.innerHTML = originalText;
                            saveBtn.classList.remove('btn-outline-success');
                            saveBtn.classList.add('btn-success');
                        }, 2000);
                    }
                }
            } catch (error) {
                console.error('Error saving QR code:', error);
                alert('Failed to save QR code. Please try again.');
            }
        }
        
        // --- Utility Functions ---
        const showLoader = (show) => { if (elements.globalLoader) elements.globalLoader.style.display = show ? 'flex' : 'none'; };
        function showStatusMessage(element, message, type = 'danger', autohide = true) { if (!element) return; element.innerHTML = message; element.className = `alert alert-${type} mt-3`; element.style.display = 'block'; element.setAttribute('role', 'alert'); if (autohide) { setTimeout(() => { if (element.innerHTML === message) element.style.display = 'none'; }, 5000); } }
        function clearStatusMessage(element) { if (!element) return; element.style.display = 'none'; element.innerHTML = ''; element.removeAttribute('role'); }
        function copyToClipboard(targetSelector) { // <<< Modified to accept selector
             if (!targetSelector) { alert('Copy target not defined.'); return; }
             const targetElement = querySel(targetSelector);
             if (!targetElement) { alert('Element to copy from not found.'); return; }
             const textToCopy = targetElement.textContent;
             if (!textToCopy || textToCopy === 'N/A' || textToCopy.includes('placeholder')) { alert('Nothing to copy.'); return; }
             navigator.clipboard.writeText(textToCopy).then(() => alert('Copied!')).catch(err => { console.error('Failed to copy:', err); alert('Failed to copy.'); });
        }
        function shareReferral(code) { if (!navigator.share) { alert('Web Share not supported. Copy the code manually.'); return; } if (!code || code === 'N/A') { alert('Referral code not available.'); return; } navigator.share({ title: 'Join Me on Gaming Tournament!', text: `Join using my referral code: ${code} & get rewards! App: ${window.location.origin}`, url: window.location.origin }).catch((error) => console.log('Error sharing', error)); }
        function generateReferralCode(length = 8) { const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'; let result = ''; for (let i = 0; i < length; i++) result += chars.charAt(Math.floor(Math.random() * chars.length)); return result; }
        function getTimeRemaining(startTime) { if (!startTime) return 'TBA'; const now = Date.now(); const diff = startTime - now; if (diff <= 0) return 'Starting Soon'; const days = Math.floor(diff / 86400000); const hours = Math.floor((diff % 86400000) / 3600000); const minutes = Math.floor((diff % 3600000) / 60000); let o = ''; if (days > 0) o += `${days}d `; if (hours > 0 || days > 0) o += `${hours}h `; o += `${minutes}m`; return o.trim() || 'Now'; }
        const removePlaceholders = (parentElement) => { if (!parentElement) return; parentElement.classList.remove('placeholder-glow'); parentElement.querySelectorAll('.placeholder').forEach(el => el.remove()); };
        
        function sanitizeHTML(str) {
            if (str == null) return '';
            str = String(str);
            const temp = document.createElement('div');
            temp.textContent = str;
            return temp.innerHTML;
        }

        // --- UI Functions ---
         function showSection(sectionId) {
             console.log('showSection called with:', sectionId);
             console.log('auth:', !!auth, 'sectionId:', sectionId, 'elements.sections:', elements.sections);
             if (!auth || !sectionId || !elements.sections) { console.error("Cannot show section", sectionId); return; }
             const targetSection = getElement(sectionId); 
             console.log('targetSection found:', !!targetSection);
             if (!targetSection) { console.error(`Section element "${sectionId}" not found.`); showSection(currentUser ? 'home-section' : 'login-section'); return; }
             const protectedSections = ['home-section', 'wallet-section', 'earnings-section', 'referral-section', 'stats-section', 'profile-section', 'tournaments-section'];
             const isLoggedIn = !!currentUser;
             if (protectedSections.includes(sectionId) && !isLoggedIn) { showSection('login-section'); return; }
             if (sectionId === 'login-section' && isLoggedIn) { showSection('home-section'); return; }
             
             // Batch DOM operations to reduce reflows
             requestAnimationFrame(() => {
                 elements.sections.forEach(sec => sec.classList.remove('active')); 
                 targetSection.classList.add('active'); 
                 currentSectionId = sectionId;
                 updateHeaderForSection(sectionId);
                 elements.bottomNavItems.forEach(item => item.classList.toggle('active', item.dataset.section === sectionId));
             });
                      // Load data *after* section is made active
         console.log(`Loading data for section: ${sectionId}`);
         switch (sectionId) {
             case 'home-section': 
                 // Load home data in parallel for better performance
                 Promise.all([
                     loadPromotions(),
                     loadGames(),
                     loadMyContests()
                 ]).catch(err => console.error("Home data load error:", err));
                 break;
             case 'wallet-section': loadWalletData(); break;
             case 'profile-section': loadProfileData(); break;
             case 'earnings-section': loadEarningsData(); break;
             case 'referral-section': loadReferralData(); break;
             case 'support-section': loadUserSupportTickets(); break;
             case 'leaderboard-section': loadLeaderboardData(); break;
             case 'stats-section': loadStatsData(); break;
             case 'tournaments-section':
                if(currentTournamentGameId) {
                     const activeTab = querySel('.tournament-tabs .tab-item.active')?.dataset.status || 'upcoming';
                     filterTournaments(currentTournamentGameId, activeTab);
                } else {
                     elements.tournamentsListContainer.innerHTML = '<p class="text-secondary text-center mt-4">Select a game from Home page first.</p>';
                }
                break;
            case 'my-contests-section':
                loadMyContestsPage('upcoming');
                break;
         }
             // Ensure login/signup form state is correct when showing login section
             if (sectionId === 'login-section') { toggleLoginForm(true); } // Default to showing login form
             window.scrollTo(0, 0);
         }
         function updateHeaderForSection(sectionId) {
             const showBackButton = (sectionId === 'tournaments-section'); const defaultTitleVisible = !showBackButton; const gameTitleVisible = showBackButton;
             if (elements.headerBackBtn) elements.headerBackBtn.style.display = showBackButton ? 'inline-block' : 'none';
             if (elements.headerTitleContainer) elements.headerTitleContainer.style.display = defaultTitleVisible ? 'flex' : 'none';
             if (elements.headerGameTitle) elements.headerGameTitle.style.display = gameTitleVisible ? 'block' : 'none';
             if (gameTitleVisible && currentTournamentGameId && elements.headerGameTitle) {
                 const gameName = appSettings?.games?.[currentTournamentGameId]?.name || `Game`;
                 elements.headerGameTitle.textContent = gameName;
              }
             else if (defaultTitleVisible && elements.headerUserGreeting) { const nameToShow = userProfile?.displayName?.split(' ')[0] || (currentUser ? currentUser.email?.split('@')[0] : 'Guest') || 'Guest'; elements.headerUserGreeting.textContent = nameToShow; }
         }
         function updateGlobalUI(isLoggedIn) {
             if (elements.headerWalletChip) { elements.headerWalletChip.style.display = isLoggedIn ? 'flex' : 'none'; if (isLoggedIn) elements.headerWalletChip.onclick = () => showSection('wallet-section'); else elements.headerWalletChip.onclick = null; }
             if (!isLoggedIn && elements.headerUserGreeting) elements.headerUserGreeting.textContent = 'Guest';
             if (!isLoggedIn && elements.headerChipBalance) elements.headerChipBalance.textContent = '0';
             elements.bottomNavItems.forEach(item => { const section = item.dataset.section; item.style.display = (section === 'home-section' || isLoggedIn) ? 'flex' : 'none'; });
         }
         function populateUserInfo(user, profile) {
             if (!user || !profile) return;
             const displayName = profile.displayName || user.displayName || user.email?.split('@')[0] || 'User';
             const photoURL = profile.photoURL || user.photoURL || `https://ui-avatars.com/api/?name=${encodeURIComponent(displayName)}&background=0F172A&color=E2E8F0&bold=true&size=70`;
             const balance = (profile.balance || 0); const winningCash = (profile.winningCash || 0); const bonusCash = (profile.bonusCash || 0);
             const totalEarnings = (profile.totalEarnings || 0); const referralEarnings = (profile.referralEarnings || 0);
             const formatCurrency = (amount) => `NPR.${amount.toFixed(2)}`;
             
             if (elements.headerUserGreeting) elements.headerUserGreeting.textContent = displayName.split(' ')[0];
             if (elements.headerChipBalance) elements.headerChipBalance.textContent = Math.floor(balance + winningCash + bonusCash);
             if (elements.walletTotalBalance) { elements.walletTotalBalance.textContent = formatCurrency(balance); removePlaceholders(elements.walletTotalBalance.closest('.placeholder-glow')); }
             if (elements.walletWinningCash) { elements.walletWinningCash.textContent = formatCurrency(winningCash); removePlaceholders(elements.walletWinningCash.closest('.placeholder-glow')); }
             if (elements.walletBonusCash) { elements.walletBonusCash.textContent = formatCurrency(bonusCash); removePlaceholders(elements.walletBonusCash.closest('.placeholder-glow')); }
             
             // Update wallet stats section elements
             if (elements.totalBalanceEl) { elements.totalBalanceEl.textContent = formatCurrency(balance + winningCash + bonusCash); }
             if (elements.monthlyEarningsEl) { elements.monthlyEarningsEl.textContent = formatCurrency(totalEarnings); }
             if (elements.totalWithdrawalsEl) { elements.totalWithdrawalsEl.textContent = formatCurrency(profile.totalWithdrawals || 0); }
             
             // Update homepage stats
             if (elements.homeTotalEarnings) { elements.homeTotalEarnings.textContent = formatCurrency(totalEarnings + referralEarnings); }
             if (elements.withdrawModalBalance) elements.withdrawModalBalance.textContent = formatCurrency(winningCash);
             if (elements.profileAvatar) elements.profileAvatar.src = photoURL;
             if (elements.profileName) { elements.profileName.textContent = displayName; removePlaceholders(elements.profileName.closest('.placeholder-glow')); }
             if (elements.profileEmail) { elements.profileEmail.textContent = user.email || 'N/A'; removePlaceholders(elements.profileEmail.closest('.placeholder-glow')); }
             
             // Calculate and update profile stats using the new function
             calculateUserStats(profile).then(userStats => {
                 if (elements.profileTotalMatches) { 
                     elements.profileTotalMatches.textContent = userStats.matchesPlayed; 
                     removePlaceholders(elements.profileTotalMatches.closest('.placeholder-glow')); 
                 }
                 if (elements.profileWonMatches) { 
                     elements.profileWonMatches.textContent = userStats.matchesWon; 
                     removePlaceholders(elements.profileWonMatches.closest('.placeholder-glow')); 
                 }
                 if (elements.profileTournamentsJoined) { 
                     elements.profileTournamentsJoined.textContent = userStats.tournamentsJoined; 
                     removePlaceholders(elements.profileTournamentsJoined.closest('.placeholder-glow')); 
                 }
                 
                 // Update homepage stats
                 if (elements.homeTournamentsJoined) { elements.homeTournamentsJoined.textContent = userStats.tournamentsJoined; }
                 if (elements.homeMatchesPlayed) { elements.homeMatchesPlayed.textContent = userStats.matchesPlayed; }
                 if (elements.homeWinRate) { elements.homeWinRate.textContent = `${userStats.winRate}%`; }
             }).catch(error => {
                 console.error("Error calculating profile stats:", error);
                 // Fallback to old values if calculation fails
                 if (elements.profileTotalMatches) { 
                     elements.profileTotalMatches.textContent = profile.totalMatches || 0; 
                     removePlaceholders(elements.profileTotalMatches.closest('.placeholder-glow')); 
                 }
                 if (elements.profileWonMatches) { 
                     elements.profileWonMatches.textContent = profile.wonMatches || 0; 
                     removePlaceholders(elements.profileWonMatches.closest('.placeholder-glow')); 
                 }
                 if (elements.profileTournamentsJoined) { 
                     elements.profileTournamentsJoined.textContent = profile.tournamentsJoined || 0; 
                     removePlaceholders(elements.profileTournamentsJoined.closest('.placeholder-glow')); 
                 }
             });
             
             if (elements.profileTotalEarnings) { elements.profileTotalEarnings.textContent = formatCurrency(totalEarnings); removePlaceholders(elements.profileTotalEarnings.closest('.placeholder-glow')); }
             if (elements.earningsTotal) { elements.earningsTotal.textContent = formatCurrency(totalEarnings); removePlaceholders(elements.earningsTotal.closest('.placeholder-glow')); }
             if (elements.earningsReferral) { elements.earningsReferral.textContent = formatCurrency(referralEarnings); removePlaceholders(elements.earningsReferral.closest('.placeholder-glow')); }
        
        // Calculate and display net earnings (total - entry fees)
        const netEarnings = totalEarnings + referralEarnings;
        if (elements.netEarnings) { 
            elements.netEarnings.textContent = formatCurrency(netEarnings); 
            removePlaceholders(elements.netEarnings.closest('.placeholder-glow')); 
        }
             if (elements.referralEarnings) { elements.referralEarnings.textContent = formatCurrency(referralEarnings); removePlaceholders(elements.referralEarnings.closest('.placeholder-glow')); }
             if (elements.modalUserEmail) elements.modalUserEmail.textContent = user.email || 'N/A';
         }
        function toggleLoginForm(showLogin) {
            if (!elements.emailLoginForm || !elements.emailSignupForm) return;
            clearStatusMessage(elements.loginStatusMessage);
            clearStatusMessage(elements.signupStatusMessage);
            elements.emailLoginForm.style.display = showLogin ? 'block' : 'none';
            elements.emailSignupForm.style.display = showLogin ? 'none' : 'block';
            // Reset forms when toggling
            elements.emailLoginForm.reset();
            elements.emailSignupForm.reset();
        }

        // --- Firebase Auth Functions ---
         async function signUpWithEmail() {
             if (!auth) return;
             const firstName = elements.signupFirstNameInput.value.trim();
             const lastName = elements.signupLastNameInput.value.trim();
             const username = elements.signupUsernameInput.value.trim();
             const em = elements.signupEmailInput.value.trim();
             const phone = elements.signupPhoneInput.value.trim();
             const pw = elements.signupPasswordInput.value;
             const cpw = elements.signupConfirmPasswordInput.value;
             const refCode = elements.signupReferralCodeInput.value.trim(); // <<< Get Referral Code

             if (!firstName || !lastName || !username || !em || !phone || !pw || !cpw) { showStatusMessage(elements.signupStatusMessage, 'Fill all required fields.', 'warning'); return; }
             if (pw !== cpw) { showStatusMessage(elements.signupStatusMessage, 'Passwords don\'t match.', 'warning'); return; }
             if (pw.length < 6) { showStatusMessage(elements.signupStatusMessage, 'Password min 6 chars.', 'warning'); return; }

             showLoader(true); clearStatusMessage(elements.signupStatusMessage);
             validReferrerUid = null; // Reset potential referrer
             signupPhoneNumber = phone; // Store phone number for profile creation
             signupFirstName = firstName; // Store first name for profile creation
             signupLastName = lastName; // Store last name for profile creation
             signupUsername = username; // Store username for profile creation

             try {
                 // --- Validate Referral Code (if provided) BEFORE creating user ---
                 if (refCode) {
                     const usersRef = ref(db, 'users');
                     const q = query(usersRef, orderByChild('referralCode'), equalTo(refCode));
                     const snapshot = await get(q);
                     if (snapshot.exists()) {
                         const referrerData = snapshot.val();
                         const referrerId = Object.keys(referrerData)[0];
                         const referrerProfile = referrerData[referrerId];
                         if (referrerId && referrerProfile.email) {
                             validReferrerUid = referrerId;
                         } else {
                             showStatusMessage(elements.signupStatusMessage, 'Invalid referral code.', 'warning');
                             showLoader(false);
                             return;
                         }
                     } else {
                         showStatusMessage(elements.signupStatusMessage, 'Referral code not found.', 'warning');
                         showLoader(false);
                         return;
                     }
                 }

                 // --- Create the user ---
                 await createUserWithEmailAndPassword(auth, em, pw);
                 // Success: onAuthStateChanged will handle profile creation now, using validReferrerUid if set.

             } catch (e) {
                 console.error("Signup Error:", e); let m = `Signup failed.`; switch (e.code) { case 'auth/email-already-in-use': m = 'Email already registered.'; break; case 'auth/weak-password': m = 'Password too weak.'; break; case 'auth/invalid-email': m = 'Invalid email.'; break; case 'auth/network-request-failed': m = 'Network error.'; break; default: m = `Error: ${e.message}`; } showStatusMessage(elements.signupStatusMessage, m, 'danger');
             } finally {
                 showLoader(false);
             }
         }
         async function loginWithEmail() {
             if (!auth) return;
             const em = elements.loginEmailInput.value.trim();
             const pw = elements.loginPasswordInput.value;
             if (!em || !pw) { showStatusMessage(elements.loginStatusMessage, 'Enter email & password.', 'warning'); return; }
             showLoader(true); clearStatusMessage(elements.loginStatusMessage);
             try { await signInWithEmailAndPassword(auth, em, pw); }
             catch (e) { console.error("Login Error:", e); let m = `Login failed.`; switch (e.code) { case 'auth/user-not-found': case 'auth/wrong-password': case 'auth/invalid-credential': m = 'Invalid email or password.'; break; case 'auth/invalid-email': m = 'Invalid email format.'; break; case 'auth/too-many-requests': m = 'Too many attempts. Reset pass or wait.'; break; case 'auth/network-request-failed': m = 'Network error.'; break; case 'auth/user-disabled': m = 'Account disabled.'; break; default: m = `Error: ${e.message}`; } showStatusMessage(elements.loginStatusMessage, m, 'danger'); }
             finally { showLoader(false); }
         }
         async function resetPassword() {
             if (!auth) return;
             const em = elements.loginEmailInput.value.trim();
             if (!em) { showStatusMessage(elements.loginStatusMessage, 'Enter email for password reset.', 'warning'); return; }
             showLoader(true); clearStatusMessage(elements.loginStatusMessage);
             try { await sendPasswordResetEmail(auth, em); showStatusMessage(elements.loginStatusMessage, 'Password reset email sent! Check inbox/spam.', 'success', false); }
             catch (e) { console.error("Reset Pass Error:", e); let m = `Failed to send email.`; switch (e.code) { case 'auth/user-not-found': case 'auth/invalid-email': m = 'Email not found.'; break; case 'auth/network-request-failed': m = 'Network error.'; break; default: m = `Error: ${e.message}`; } showStatusMessage(elements.loginStatusMessage, m, 'danger'); }
             finally { showLoader(false); }
         }
         async function logoutUser() { 
             if (!auth) return; 
             try { 
                 showLoader(true); 
                 clearCache(); // Clear cache on logout
                 await signOut(auth); 
             } catch (e) { 
                 console.error("Sign Out Error:", e); 
                 alert(`Logout failed: ${e.message}`); 
                 showLoader(false); 
             } 
         }

        // --- Auth State Change Handler --- [UPDATED FOR REFERRAL]
         async function handleAuthStateChange(user) {
             if (!auth || !db) { console.error("Firebase not ready in auth change"); showLoader(false); return; }
             showLoader(true); detachAllDbListeners(); currentUser = user;
             const localReferrerUid = validReferrerUid; // Capture the value before resetting
             validReferrerUid = null; // Reset for next signup attempt

             if (user) { // Logged In
                 console.log("Auth State: Logged In", user.uid); const userRef = ref(db, 'users/' + user.uid);
                 try {
                     const snapshot = await get(userRef);
                     if (snapshot.exists()) { // Existing user
                         userProfile = snapshot.val(); const updates = {};
                         if (user.displayName && (!userProfile.displayName || userProfile.displayName !== user.displayName)) updates.displayName = user.displayName;
                         if (user.email && !userProfile.email) updates.email = user.email;
                         if (Object.keys(updates).length > 0) { await update(userRef, updates); userProfile = { ...userProfile, ...updates }; }
                     } else { // New user
                         console.log("New user, creating profile...");
                         const newUserProfile = {
                             uid: user.uid, 
                             firstName: signupFirstName || user.displayName?.split(' ')[0] || user.email?.split('@')[0] || 'User',
                             lastName: signupLastName || user.displayName?.split(' ')[1] || '',
                             username: signupUsername || user.email?.split('@')[0] || 'user',
                             displayName: signupFirstName && signupLastName ? `${signupFirstName} ${signupLastName}` : user.displayName || user.email?.split('@')[0] || 'User', 
                             email: user.email || null, 
                             phoneNumber: signupPhoneNumber, 
                             photoURL: user.photoURL || null,
                             balance: appSettings.newUserBalance || 0, winningCash: 0, bonusCash: appSettings.newUserBonus || 0,
                             totalMatches: 0, wonMatches: 0, totalEarnings: 0, referralEarnings: 0, createdAt: Date.now(),
                             referralCode: generateReferralCode(), joinedTournaments: {}, isAdmin: false,
                             // <<< Add referredBy field if valid referrer was found during signup >>>
                             ...(localReferrerUid && { referredBy: localReferrerUid })
                         };
                         await set(userRef, newUserProfile);
                         userProfile = newUserProfile;

                         // Award signup bonus to new user (if any)
                         if (newUserProfile.bonusCash > 0) {
                             await recordTransaction(user.uid, 'signup_bonus', newUserProfile.bonusCash, `Welcome Bonus`);
                         }

                         // --- Award bonus to referrer (if any) ---
                         if (localReferrerUid && appSettings.referralBonus > 0) {
                             console.log(`Awarding referral bonus of ${appSettings.referralBonus} to referrer: ${localReferrerUid}`);
                             await processReferralBonus(localReferrerUid, user.uid, newUserProfile.displayName || newUserProfile.email);
                         }
                         // --- End Referrer Bonus Award ---
                     }
                     signupPhoneNumber = null; // Reset phone number after profile creation
                     signupFirstName = null; // Reset first name after profile creation
                     signupLastName = null; // Reset last name after profile creation
                     signupUsername = null; // Reset username after profile creation
                     populateUserInfo(user, userProfile); setupRealtimeListeners(user.uid); updateGlobalUI(true);
                     
                     // Update contest counts after profile is loaded
                     updateContestCounts();
                     
                     // Load home stats for all users
                     loadHomeStats();
             
                     
                     const targetSection = (currentSectionId === 'login-section' || !getElement(currentSectionId)) ? 'home-section' : currentSectionId;
                     showSection(targetSection);
                 } catch (error) { console.error("Profile handling error:", error); alert("Error loading profile. Logging out. " + error.message); try { await logoutUser(); } catch (logoutErr) {} }
             } else { // Logged Out
                 console.log("Auth State: Logged Out"); currentUser = null; userProfile = {}; updateGlobalUI(false); showSection('login-section');
             }
             showLoader(false);
}

// --- Database Interaction Functions ---
async function loadAppSettings() {
    console.log("Loading App Settings...");
    
    // Check cache first
    const now = Date.now();
    if (settingsCache && (now - lastSettingsLoad) < CACHE_DURATION) {
        console.log("Using cached app settings");
        return;
    }
    
    try {
        const settingsRef = ref(db, 'settings');
        const snapshot = await get(settingsRef);
        if (snapshot.exists()) {
             appSettings = snapshot.val() || {};
             console.log("App Settings Loaded:", appSettings);

            // Apply settings to UI
            if (appSettings.logoUrl && elements.appLogo) elements.appLogo.src = appSettings.logoUrl;
            const rules = appSettings.withdrawalRules || {};
            const methods = appSettings.withdrawalMethods || [];
            if (elements.minWithdrawAmount) elements.minWithdrawAmount.textContent = (rules.minPerRequest ?? appSettings.minWithdraw ?? 50);
            // Build methods UI
            const methodsBox = document.getElementById('withdrawMethodsContainer');
            if (methodsBox) {
                methodsBox.innerHTML = methods.map((m, idx) => `<div class="form-check"><input class="form-check-input" type="radio" name="withdrawMethod" id="wm_${idx}" value="${m.label}" ${idx===0?'checked':''}><label class="form-check-label" for="wm_${idx}">${m.label}</label></div>`).join('') || '<p class="text-secondary">id:98********@eSewa/@NTC?.</p>';
                const first = methods[0];
                if (first && elements.withdrawMethodInput) elements.withdrawMethodInput.placeholder = first.placeholder || '';
            }
            const help = document.getElementById('withdrawLimitsHelp');
            if (help) help.textContent = `Max per request: NPR.${(rules.maxPerRequest||0)}  Max per day: NPR.${(rules.dailyMaxAmount||0)}  Cooldown: ${(rules.cooldownMinutes||0)} min`;

             // Update modal content dynamically based on settings
             const upiIdEl = document.querySelector('.phonepe-number');
             if (upiIdEl) {
                 upiIdEl.textContent = appSettings.upiDetails || '[!!! YOUR QR ID/NUMBER HERE !!!]';
            
            // Display QR code if available
            if (appSettings.qrCodeUrl && elements.qrCodeDisplayImg && elements.qrCodeDisplayContainer) {
                elements.qrCodeDisplayImg.src = appSettings.qrCodeUrl;
                elements.qrCodeDisplayContainer.style.display = 'block';
            } else if (elements.qrCodeDisplayContainer) {
                elements.qrCodeDisplayContainer.style.display = 'none';
            }
            
            // Update QR ID in step 1 of add money modal
            if (elements.upiIdDisplayStep1) {
                elements.upiIdDisplayStep1.textContent = appSettings.upiDetails || '[!!! YOUR QR ID/NUMBER HERE !!!]';
            }
             }
             const contactInfoPEl = document.querySelector('.modal-body p strong#modalUserEmailEl')?.closest('p');
             if(contactInfoPEl && appSettings.supportContact) {
                  contactInfoPEl.innerHTML = contactInfoPEl.innerHTML.replace('[!!! ADMIN CONTACT INFO HERE !!!]', appSettings.supportContact);
             } else if (contactInfoPEl) {
                  contactInfoPEl.innerHTML = contactInfoPEl.innerHTML.replace(appSettings.supportContact || 'some_previous_value', '[!!! ADMIN CONTACT INFO HERE !!!]');
             }

             // Cache the settings
             settingsCache = appSettings;
             lastSettingsLoad = now;

        } else {
             console.warn("App Settings not found in database!");
             appSettings = {};
             const upiIdEl = document.querySelector('.phonepe-number');
             if (upiIdEl) upiIdEl.textContent = '[!!! YOUR QR ID/NUMBER HERE !!!]';
             const contactInfoPEl = document.querySelector('.modal-body p strong#modalUserEmailEl')?.closest('p');
             if(contactInfoPEl) contactInfoPEl.innerHTML = contactInfoPEl.innerHTML.replace(/.*/, '<strong><i class="bi bi-exclamation-triangle-fill text-warning"></i> IMPORTANT:</strong> After payment, contact admin via [!!! ADMIN CONTACT INFO HERE !!!] with registered Email (<strong id="modalUserEmailEl">...</strong>) & payment screenshot. Amount added manually after verification.');
        }
    } catch (e) {
        console.error("Settings load failed", e);
         appSettings = {};
    }
}

// Cache clearing function
function clearCache() {
    statsCache = null;
    promotionsCache = null;
    gamesCache = null;
    settingsCache = null;
    leaderboardCache = null;
    lastStatsCalculation = 0;
    lastPromotionsLoad = 0;
    lastGamesLoad = 0;
    lastSettingsLoad = 0;
    lastLeaderboardLoad = 0;
    console.log("Cache cleared");
}

// --- Leaderboard Functions ---
let leaderboardCache = null;
let lastLeaderboardLoad = 0;
let currentLeaderboardType = 'earnings';

async function loadLeaderboardData() {
    console.log("Loading Leaderboard Data...");
    if (!currentUser) return;
    
    // Check cache first
    const now = Date.now();
    if (leaderboardCache && (now - lastLeaderboardLoad) < CACHE_DURATION) {
        console.log("Using cached leaderboard data");
        displayLeaderboard(leaderboardCache);
        return;
    }
    
    try {
        const usersRef = ref(db, 'users');
        const snapshot = await get(usersRef);
        const users = snapshot.val() || {};
        
        // Convert to array and calculate stats
        const userStats = Object.entries(users).map(([uid, user]) => ({
            uid,
            displayName: user.displayName || 'Unknown Player',
            photoURL: user.photoURL || `https://ui-avatars.com/api/?name=${encodeURIComponent(user.displayName || 'U')}&background=0F172A&color=E2E8F0&bold=true&size=40`,
            totalEarnings: (user.totalEarnings || 0) + (user.referralEarnings || 0),
            wonMatches: user.wonMatches || 0,
            tournamentsJoined: user.tournamentsJoined || 0,
            totalMatches: user.totalMatches || 0
        }));
        
        // Sort by current leaderboard type
        const sortedUsers = userStats.sort((a, b) => {
            switch (currentLeaderboardType) {
                case 'earnings':
                    return b.totalEarnings - a.totalEarnings;
                case 'wins':
                    return b.wonMatches - a.wonMatches;
                case 'tournaments':
                    return b.tournamentsJoined - a.tournamentsJoined;
                default:
                    return b.totalEarnings - a.totalEarnings;
            }
        });
        
        // Cache the result
        leaderboardCache = sortedUsers;
        lastLeaderboardLoad = now;
        
        displayLeaderboard(sortedUsers);
        
    } catch (error) {
        console.error("Error loading leaderboard:", error);
        elements.leaderboardList.innerHTML = '<p class="text-danger text-center">Error loading leaderboard.</p>';
    }
}

function displayLeaderboard(users) {
    if (!elements.leaderboardList) return;
    
    elements.leaderboardList.innerHTML = '';
    elements.noLeaderboardMessage.style.display = 'none';
    
    if (users.length === 0) {
        elements.noLeaderboardMessage.style.display = 'block';
        return;
    }
    
    users.forEach((user, index) => {
        const rank = index + 1;
        const rankClass = rank <= 3 ? `text-${rank === 1 ? 'warning' : rank === 2 ? 'secondary' : 'danger'}` : '';
        const rankIcon = rank <= 3 ? `<i class="bi bi-${rank === 1 ? 'trophy-fill' : rank === 2 ? 'award-fill' : 'award'}"></i>` : '';
        
        const value = getLeaderboardValue(user, currentLeaderboardType);
        const valueText = formatLeaderboardValue(value, currentLeaderboardType);
        
        const card = document.createElement('div');
        card.className = 'custom-card mb-2';
        card.innerHTML = `
            <div class="d-flex align-items-center">
                <div class="me-3 ${rankClass}" style="font-size: 1.2rem; font-weight: bold; min-width: 30px;">
                    ${rankIcon} ${rank}
                </div>
                <img src="${user.photoURL}" alt="${user.displayName}" class="rounded-circle" style="width: 40px; height: 40px; object-fit: cover;">
                <div class="flex-grow-1 ms-3">
                    <div class="fw-bold">${user.displayName}</div>
                    <small class="text-secondary">
                        ${user.totalMatches} matches  ${user.wonMatches} wins
                    </small>
                </div>
                <div class="text-end">
                    <div class="fw-bold ${rankClass}">${valueText}</div>
                    <small class="text-secondary">${getLeaderboardTypeLabel(currentLeaderboardType)}</small>
                </div>
            </div>
        `;
        
        elements.leaderboardList.appendChild(card);
    });
}

function getLeaderboardValue(user, type) {
    switch (type) {
        case 'earnings':
            return user.totalEarnings;
        case 'wins':
            return user.wonMatches;
        case 'tournaments':
            return user.tournamentsJoined;
        default:
            return user.totalEarnings;
    }
}

function formatLeaderboardValue(value, type) {
    switch (type) {
        case 'earnings':
            return `NPR.${value.toFixed(2)}`;
        case 'wins':
        case 'tournaments':
            return value.toString();
        default:
            return value.toString();
    }
}

function getLeaderboardTypeLabel(type) {
    switch (type) {
        case 'earnings':
            return 'Total Earnings';
        case 'wins':
            return 'Wins';
        case 'tournaments':
            return 'Tournaments';
        default:
            return 'Earnings';
    }
}

function loadHomePageData() {
    console.log("Loading Home Page Data...");
    if (!currentUser) {
         console.log("User not logged in, skipping home data load.");
         if(elements.promotionSlider?.querySelector('.swiper-wrapper')) elements.promotionSlider.querySelector('.swiper-wrapper').innerHTML = '';
         if(elements.gamesList) elements.gamesList.innerHTML = '';
         if(elements.myContestsList) elements.myContestsList.innerHTML = '<p class="text-secondary text-center">Login to view contests.</p>';
         return;
     }
    
    // Load home stats and activity for all users
    loadHomeStats();
    }

async function loadPromotions() {
     console.log("Loading Promotions...");
     if (!elements.promotionSlider) return;
     
     // Check cache first
     const now = Date.now();
     if (promotionsCache && (now - lastPromotionsLoad) < CACHE_DURATION) {
         console.log("Using cached promotions");
         return;
     }
     
     const sliderWrapper = elements.promotionSlider.querySelector('.swiper-wrapper');
     if (!sliderWrapper) return;
     sliderWrapper.classList.add('placeholder-glow');
     sliderWrapper.innerHTML = `<div class="swiper-slide"><span class="placeholder" style="height: 100%; border-radius: 10px; display: block; width: 100%;"></span></div>`;

     const promoRef = ref(db, 'promotions');
     try {
         const snapshot = await get(promoRef);
         const promotions = snapshot.val() || {};
         const activePromotions = Object.values(promotions).filter(p => p.imageUrl);
         console.log(`Found ${activePromotions.length} active promotions.`);

         removePlaceholders(elements.promotionSlider);
         sliderWrapper.innerHTML = '';

         if (activePromotions.length > 0) {
             elements.promotionSlider.style.display = 'block';
             activePromotions.forEach(promo => {
                 const slide = document.createElement('div');
                 slide.className = 'swiper-slide';
                 slide.innerHTML = promo.link ? `<a href="${promo.link}" target="_blank"><img src="${promo.imageUrl}" alt="Promo"></a>` : `<img src="${promo.imageUrl}" alt="Promo">`;
                 sliderWrapper.appendChild(slide);
             });
             if (swiperInstance) swiperInstance.destroy(true, true);
            swiperInstance = new Swiper(elements.promotionSlider, {
                 loop: activePromotions.length > 1,
                 autoplay: { delay: 3500, disableOnInteraction: false },
                 pagination: { el: '.swiper-pagination', clickable: true },
                slidesPerView: 1,
                centeredSlides: false,
                autoHeight: false,
                resizeObserver: true
             });
         } else {
             elements.promotionSlider.style.display = 'none';
         }
         
         // Cache the promotions
         promotionsCache = activePromotions;
         lastPromotionsLoad = now;
         
     } catch (e) {
         console.error("Promo load failed:", e);
         removePlaceholders(elements.promotionSlider);
         sliderWrapper.innerHTML = '<p class="text-danger text-center small p-3">Could not load promotions.</p>';
         elements.promotionSlider.style.display = 'block';
     }
}

async function loadGames() {
    console.log("Loading Games...");
    if (!elements.gamesList) return;
    
    // Check cache first
    const now = Date.now();
    if (gamesCache && (now - lastGamesLoad) < CACHE_DURATION) {
        console.log("Using cached games");
        return;
    }
    
    elements.gamesList.classList.add('placeholder-glow');
    elements.gamesList.innerHTML = `<div class="col-6"><div class="game-card custom-card"><span class="placeholder d-block" style="height: 130px;"></span><span class="placeholder d-block mt-2 col-8 mx-auto" style="height: 20px;"></span></div></div> <div class="col-6"><div class="game-card custom-card"><span class="placeholder d-block" style="height: 130px;"></span><span class="placeholder d-block mt-2 col-8 mx-auto" style="height: 20px;"></span></div></div>`;

    const gamesRef = ref(db, 'games');
    try {
        const snapshot = await get(gamesRef);
        const games = snapshot.val() || {};
         const activeGames = Object.entries(games)
                                .filter(([, game]) => game.imageUrl && game.name)
                                .sort(([, gameA], [, gameB]) => (gameA.order || 0) - (gameB.order || 0));
        console.log(`Found ${activeGames.length} active games.`);

        removePlaceholders(elements.gamesList);
        elements.gamesList.innerHTML = '';

        if (activeGames.length > 0) {
             if (!appSettings.games) appSettings.games = {};
            activeGames.forEach(([gameId, game]) => {
                 appSettings.games[gameId] = { name: game.name };
                const gameItem = document.createElement('div');
                gameItem.className = 'simple-game-item';
                gameItem.dataset.gameId = gameId;
                gameItem.dataset.gameName = game.name;
                gameItem.innerHTML = `
                    <div class="game-icon">
                        <img src="${game.imageUrl}" alt="${game.name}">
                    </div>
                    <div class="game-name">${game.name}</div>
                `;
                
                gameItem.addEventListener('click', () => {
                    currentTournamentGameId = gameId;
                    loadTournamentsForGame(gameId, game.name);
                });
                
                elements.gamesList.appendChild(gameItem);
            });
        } else {
            elements.gamesList.innerHTML = '<p class="text-secondary text-center">No games available.</p>';
        }
        
        // Cache the games
        gamesCache = activeGames;
        lastGamesLoad = now;
        
    } catch (e) {
        console.error("Games load failed:", e);
        removePlaceholders(elements.gamesList);
        elements.gamesList.innerHTML = '<p class="text-danger text-center col-12">Could not load games.</p>';
    }
}

async function loadHomeStats() {
    console.log("Loading Home Stats...");
    
    try {
        // Load tournaments count
        const tournamentsRef = ref(db, 'tournaments');
        const tournamentsSnapshot = await get(tournamentsRef);
        const tournaments = tournamentsSnapshot.val() || {};
        const totalTournaments = Object.keys(tournaments).length;
        const activeTournaments = Object.values(tournaments).filter(t => t.status === 'ongoing').length;
        
        // Load total players count (from user profiles)
        const usersRef = ref(db, 'users');
        const usersSnapshot = await get(usersRef);
        const users = usersSnapshot.val() || {};
        const totalPlayers = Object.keys(users).length;
        
        // Calculate total prize pool
        let totalPrizePool = 0;
        Object.values(tournaments).forEach(t => {
            if (t.prizePool) {
                totalPrizePool += parseInt(t.prizePool) || 0;
            }
        });
        

        

        
        console.log(`Home stats loaded: ${totalTournaments} tournaments, ${totalPlayers} players, NPR.${totalPrizePool} prize pool`);
        
    } catch (e) {
        console.error("Home stats load failed:", e);
    }
}



function loadTournamentsForGame(gameId, gameName) {
     console.log(`Loading tournaments for game: ${gameName} (ID: ${gameId})`);
     if (!elements.tournamentsSection) return;
     currentTournamentGameId = gameId;
     elements.tournamentTabs.forEach(t => t.classList.remove('active'));
     querySel('.tournament-tabs .tab-item[data-status="upcoming"]')?.classList.add('active');
     showSection('tournaments-section'); // This will call filterTournaments
     filterTournaments(gameId, 'upcoming');
}

async function filterTournaments(gameId, status) {
    console.log(`Filtering tournaments for game ${gameId} with status ${status}`);
    if (!elements.tournamentsListContainer) return;
    elements.tournamentsListContainer.innerHTML = ''; // Clear previous list
    elements.tournamentsListContainer.classList.add('placeholder-glow');
    elements.tournamentsListContainer.innerHTML = `<div class="tournament-card placeholder-glow mb-3"><span class="placeholder col-6"></span><span class="placeholder col-12 mt-2"></span><span class="placeholder col-10 mt-2"></span><div class="d-flex justify-content-between mt-3"><span class="placeholder col-4 h-30"></span><span class="placeholder col-4 h-30"></span></div></div>`; // Show placeholders
    elements.noTournamentsMessage.style.display = 'none'; // Hide 'no tournaments' message
    try {
        const tQuery = query(ref(db, 'tournaments'), orderByChild('gameId'), equalTo(gameId));
        const s = await get(tQuery);
        const allT = s.val() || {};
        const fT = Object.entries(allT).filter(([, t]) => t.status === status).sort(([, tA], [, tB]) => (tA.startTime || 0) - (tB.startTime || 0));
        console.log(`Found ${fT.length} tournaments matching criteria.`);

        removePlaceholders(elements.tournamentsListContainer);
        elements.tournamentsListContainer.innerHTML = ''; // Clear placeholders again

        if (fT.length > 0) {
            fT.forEach(([tId, t]) => {
                const card = createTournamentCardElement(tId, t);
                elements.tournamentsListContainer.appendChild(card);
            });
        } else {
            elements.noTournamentsMessage.style.display = 'block';
            elements.noTournamentsMessage.textContent = `No ${status} tournaments found.`;
        }
    } catch (e) {
        console.error(`Tournaments filter failed (${status}):`, e);
        removePlaceholders(elements.tournamentsListContainer);
        elements.tournamentsListContainer.innerHTML = '<p class="text-danger tc mt-4">Could not load tournaments.</p>';
        elements.noTournamentsMessage.style.display = 'none';
    }
}

function createTournamentCardElement(tId, t) {
     const card = document.createElement('div'); card.className = 'tournament-card'; card.dataset.tournamentId = tId;
     const eFee = t.entryFee || 0; const pkPrize = t.perKillPrize || 0; const pPool = t.prizePool || 0;
     const sTime = t.startTime ? new Date(t.startTime) : null; const sTimeLoc = sTime ? sTime.toLocaleString([], { dateStyle: 'short', timeStyle: 'short' }) : 'TBA';
     const regP = t.registeredPlayers || {}; const regC = Object.keys(regP).length; const maxP = t.maxPlayers || 0;

     const spotsL = maxP > 0 ? Math.max(0, maxP - regC) : Infinity; const isF = maxP > 0 && spotsL <= 0;
     const isJ = currentUser && userProfile?.joinedTournaments?.[tId];
     const canJ = !isJ && !isF && t.status === 'upcoming'; let timerTxt = t.status?.toUpperCase() || 'N/A';
     if (t.status === 'upcoming' && sTime) timerTxt = getTimeRemaining(t.startTime); else if (t.status === 'ongoing') timerTxt = 'LIVE'; else if (t.status === 'completed' || t.status === 'result') timerTxt = 'ENDED';
     let spotsTxt = 'Unlimited Spots'; let progP = 0; if (maxP > 0) { spotsTxt = `<span class="${spotsL <= 5 ? 'text-danger' : 'text-accent'}">${spotsL}</span> Spots Left (${regC}/${maxP})`; progP = Math.min(100, (regC / maxP) * 100); }
     let actBtn = ''; let idPassBtn = ''; 
     
     const isFinished = t.status === 'completed' || t.status === 'result';

     if (isJ) { 
         if (isFinished) {
            actBtn = `<button class="btn btn-custom btn-sm btn-custom-accent btn-view-result" data-tournament-id="${tId}"><i class="bi bi-award-fill"></i> View Result</button>`;
         } else {
             actBtn = `<button class="btn btn-custom btn-sm btn-joined" disabled><i class="bi bi-check-circle-fill"></i> Joined</button>`;
         }
        if (t.status === 'ongoing' || (t.status === 'upcoming' && t.showIdPass && sTime && Date.now() > sTime.getTime() - 900000)) { idPassBtn = `<button class="btn btn-custom btn-idpass w-100 mt-2 btn-sm" data-tournament-id="${tId}"><i class="bi bi-key-fill"></i> View ID & Pass</button>`; } 
     } else if (canJ) { 
        actBtn = `<button class="btn btn-custom btn-sm btn-custom-accent btn-join" data-tournament-id="${tId}" data-fee="${eFee}">NPR.${eFee} Join <i class="bi bi-arrow-right-short"></i></button>`; 
     } else { 
        let disR = isFinished ? 'VIEW RESULT' : (t.status !== 'upcoming' ? t.status?.toUpperCase() : (isF ? 'Full' : 'Closed'));
        if (isFinished) {
             actBtn = `<button class="btn btn-custom btn-sm btn-custom-secondary btn-view-result" data-tournament-id="${tId}"><i class="bi bi-award"></i> View Result</button>`;
        } else {
             actBtn = `<button class="btn btn-custom btn-sm btn-disabled" disabled>${disR || 'N/A'}</button>`; 
        }
     }
    
    // Result Area HTML (initially hidden)
    const playerResult = isJ && isFinished ? (regP[currentUser.uid] || {}) : null;
    let resultAreaHtml = '';
    if (isFinished) {
        resultAreaHtml = `
            <div class="tournament-result-area" id="result-area-${tId}">
                ${playerResult ? `
                    <h4 class="section-title fs-6 text-center mb-3">Your Performance</h4>
                    <div class="result-grid">
                        <div class="result-grid-item"><span><i class="bi bi-bar-chart-steps"></i> Rank</span><strong>${playerResult.rank || 'N/A'}</strong></div>
                        <div class="result-grid-item"><span><i class="bi bi-crosshair"></i> Kills</span><strong>${playerResult.kills || 0}</strong></div>
                        <div class="result-grid-item"><span><i class="bi bi-gem"></i> Prize</span><strong>NPR.${(playerResult.prize || 0).toFixed(2)}</strong></div>
                    </div>
                ` : '<p class="text-secondary text-center small">Full results are available. You did not participate.</p>'}
            </div>
        `;
    }

     card.innerHTML = `<div class="tournament-card-header"><div class="tournament-card-tags">${t.mode ? `<span>${t.mode}</span>` : ''}${t.map ? `<span>${t.map}</span>` : ''}${t.tags ? (Array.isArray(t.tags) ? t.tags.map(tag => `<span>${tag}</span>`).join('') : Object.values(t.tags).map(tag => `<span>${tag}</span>`).join('')) : ''}</div><div class="tournament-card-timer">${timerTxt}</div></div><h3 class="tournament-card-title">${t.icon ? `<i class="${t.icon}"></i>` : '<i class="bi bi-joystick text-accent"></i>'} ${t.name || 'Tournament'}</h3><p class="small text-secondary mb-2"><i class="bi bi-calendar-event"></i> ${sTimeLoc}</p><div class="tournament-card-info"><div class="info-item"><span>Prize Pool</span><strong><i class="bi bi-trophy-fill text-accent prize-icon"></i> NPR.${pPool}</strong></div><div class="info-item"><span>Per Kill</span><strong>NPR.${pkPrize}</strong></div><div class="info-item"><span>Entry Fee</span><strong class="${eFee > 0 ? 'text-info' : ''}">${eFee > 0 ? `NPR.${eFee}` : 'Free'}</strong></div></div><div class="tournament-card-spots">${spotsTxt}${maxP > 0 ? `<div class="progress mt-1" style="height: 6px;"><div class="progress-bar bg-warning" role="progressbar" style="width: ${progP}%"></div></div>` : ''}</div><div class="tournament-card-actions"><button class="btn btn-custom btn-custom-secondary btn-sm btn-view-players" data-tournament-id="${tId}" data-tournament-name="${t.name || 'Tournament'}"><i class="bi bi-people"></i> View ${regC} Players</button>${actBtn}</div>${idPassBtn}${resultAreaHtml}`;
     const jBtn = card.querySelector('.btn-join'); if (jBtn) jBtn.addEventListener('click', handleJoinTournamentClick);
     const vpBtn = card.querySelector('.btn-view-players'); if (vpBtn) vpBtn.addEventListener('click', function() {
         const tournamentId = this.dataset.tournamentId;
         const tournamentName = this.dataset.tournamentName;
         showRegisteredPlayers(tournamentId, tournamentName);
     });
     const ipBtn = card.querySelector('.btn-idpass'); if (ipBtn) ipBtn.addEventListener('click', handleIdPasswordClick);
    const vrBtn = card.querySelector('.btn-view-result'); if (vrBtn) vrBtn.addEventListener('click', handleTournamentResultsClick);
    const fullDetailsBtn = card.querySelector('.btn-full-details'); if(fullDetailsBtn) fullDetailsBtn.addEventListener('click', handleMatchDetailsClick);
    
    // Add click functionality to the entire card (but not on buttons)
    card.addEventListener('click', function(event) {
        // Don't trigger if clicking on buttons or interactive elements
        if (event.target.closest('button') || event.target.closest('a') || event.target.closest('input')) {
            return;
        }
        
        // Create a proper event object for the function
        const mockEvent = {
            currentTarget: {
                dataset: {
                    tournamentId: tId
                }
            }
        };
        
        // Open tournament details modal
        handleMatchDetailsClick(mockEvent);
    });
    
    // Add cursor pointer to indicate clickable
    card.style.cursor = 'pointer';
    
     return card;
}

// New function to create modern contest cards for My Contests section
function createModernContestCard(tId, t) {
    const card = document.createElement('div');
    card.className = 'contest-card';
    card.dataset.tournamentId = tId;
    
    const eFee = t.entryFee || 0;
    const pkPrize = t.perKillPrize || 0;
    const pPool = t.prizePool || 0;
    const sTime = t.startTime ? new Date(t.startTime) : null;
    const sTimeLoc = sTime ? sTime.toLocaleString([], { dateStyle: 'short', timeStyle: 'short' }) : 'TBA';
    const regP = t.registeredPlayers || {};
    const regC = Object.keys(regP).length;
    const maxP = t.maxPlayers || 0;
    
    const spotsL = maxP > 0 ? Math.max(0, maxP - regC) : Infinity;
    const isF = maxP > 0 && spotsL <= 0;
    const isJ = currentUser && userProfile?.joinedTournaments?.[tId];
    const canJ = !isJ && !isF && t.status === 'upcoming';
    
    let timerTxt = t.status?.toUpperCase() || 'N/A';
    if (t.status === 'upcoming' && sTime) {
        timerTxt = getTimeRemaining(t.startTime);
    } else if (t.status === 'ongoing') {
        timerTxt = 'LIVE';
    } else if (t.status === 'completed' || t.status === 'result') {
        timerTxt = 'ENDED';
    }
    
    let spotsTxt = 'Unlimited Spots';
    let progP = 0;
    if (maxP > 0) {
        spotsTxt = `${spotsL} Spots Left (${regC}/${maxP})`;
        progP = Math.min(100, (regC / maxP) * 100);
    }
    
    let actBtn = '';
    let idPassBtn = '';
    const isFinished = t.status === 'completed' || t.status === 'result';
    
    if (isJ) {
        if (isFinished) {
            actBtn = `<button class="contest-action-btn btn-view-result" data-tournament-id="${tId}"><i class="bi bi-award-fill"></i> View Result</button>`;
        } else {
            actBtn = `<button class="contest-action-btn btn-joined" disabled><i class="bi bi-check-circle-fill"></i> Joined</button>`;
        }
        if (t.status === 'ongoing' || (t.status === 'upcoming' && t.showIdPass && sTime && Date.now() > sTime.getTime() - 900000)) {
            idPassBtn = `<button class="contest-action-btn btn-view-idpass" data-tournament-id="${tId}"><i class="bi bi-key-fill"></i> View ID & Pass</button>`;
        }
    } else if (canJ) {
        actBtn = `<button class="contest-action-btn btn-join" data-tournament-id="${tId}" data-fee="${eFee}">NPR.${eFee} Join <i class="bi bi-arrow-right-short"></i></button>`;
    } else {
        let disR = isFinished ? 'VIEW RESULT' : (t.status !== 'upcoming' ? t.status?.toUpperCase() : (isF ? 'Full' : 'Closed'));
        if (isFinished) {
            actBtn = `<button class="contest-action-btn btn-view-result" data-tournament-id="${tId}"><i class="bi bi-award"></i> View Result</button>`;
        } else {
            actBtn = `<button class="contest-action-btn btn-disabled" disabled>${disR || 'N/A'}</button>`;
        }
    }
    
    // Create tags HTML
    const tags = [];
    if (t.mode) tags.push(t.mode);
    if (t.map) tags.push(t.map);
    if (t.tags) {
        if (Array.isArray(t.tags)) {
            tags.push(...t.tags);
        } else {
            tags.push(...Object.values(t.tags));
        }
    }
    const tagsHtml = tags.map(tag => `<span class="contest-tag">${tag}</span>`).join('');
    
    // Status class
    let statusClass = 'status-upcoming';
    if (t.status === 'ongoing') statusClass = 'status-active';
    else if (t.status === 'completed' || t.status === 'result') statusClass = 'status-completed';
    
    card.innerHTML = `
        <div class="contest-header">
            <div class="contest-title-section">
                <h3 class="contest-title">
                    <i class="${t.icon || 'bi bi-joystick'}"></i>
                    ${t.name || 'Tournament'}
                </h3>
                <div class="contest-game">
                    <i class="bi bi-calendar-event"></i>
                    ${sTimeLoc}
                </div>
            </div>
            <div class="contest-status ${statusClass}">
                ${timerTxt}
            </div>
        </div>
        
        <div class="contest-content">
            <div class="contest-info">
                <div class="info-item">
                    <span>Prize Pool</span>
                    <strong><i class="bi bi-trophy-fill"></i> NPR.${pPool}</strong>
                </div>
                <div class="info-item">
                    <span>Per Kill</span>
                    <strong>NPR.${pkPrize}</strong>
                </div>
                <div class="info-item">
                    <span>Entry Fee</span>
                    <strong class="${eFee > 0 ? 'text-info' : ''}">${eFee > 0 ? `NPR.${eFee}` : 'Free'}</strong>
                </div>
                <div class="info-item">
                    <span>Spots</span>
                    <strong><i class="bi bi-people"></i> ${spotsTxt}</strong>
                </div>
            </div>
            
            <div class="contest-prize">
                <div class="prize-amount">NPR.${pPool}</div>
                <div class="prize-label">Total Prize</div>
                ${maxP > 0 ? `
                    <div class="progress mt-2" style="height: 6px; width: 100%;">
                        <div class="progress-bar" role="progressbar" style="width: ${progP}%; background: linear-gradient(90deg, #667eea, #764ba2);"></div>
                    </div>
                ` : ''}
            </div>
        </div>
        
        <div class="contest-actions">
            <button class="contest-action-btn btn-view-players" data-tournament-id="${tId}" data-tournament-name="${t.name || 'Tournament'}">
                <i class="bi bi-people"></i> View ${regC} Players
            </button>
            ${actBtn}
        </div>
        
        ${idPassBtn ? `<div class="contest-actions mt-2">${idPassBtn}</div>` : ''}
        
        ${tagsHtml ? `<div class="contest-tags mt-2">${tagsHtml}</div>` : ''}
    `;
    
    // Add event listeners
    const jBtn = card.querySelector('.btn-join');
    if (jBtn) jBtn.addEventListener('click', handleJoinTournamentClick);
    
    const vpBtn = card.querySelector('.btn-view-players');
    if (vpBtn) vpBtn.addEventListener('click', function() {
        const tournamentId = this.dataset.tournamentId;
        const tournamentName = this.dataset.tournamentName;
        showRegisteredPlayers(tournamentId, tournamentName);
    });
    
    const ipBtn = card.querySelector('.btn-idpass, .btn-view-idpass');
    if (ipBtn) ipBtn.addEventListener('click', handleIdPasswordClick);
    
    const vrBtn = card.querySelector('.btn-view-result');
    if (vrBtn) vrBtn.addEventListener('click', handleTournamentResultsClick);
    
    // Add click functionality to the entire card (but not on buttons)
    card.addEventListener('click', function(event) {
        if (event.target.closest('button') || event.target.closest('a') || event.target.closest('input')) {
            return;
        }
        
        const mockEvent = {
            currentTarget: {
                dataset: {
                    tournamentId: tId
                }
            }
        };
        
        handleMatchDetailsClick(mockEvent);
    });
    
    card.style.cursor = 'pointer';
    
    return card;
}

// Function to handle modern contest tab switching
function initializeModernContestTabs() {
    const filterTabs = document.querySelectorAll('.filter-tab');
    const contestsContainer = document.getElementById('myContestsPageListEl');
    
    if (!filterTabs.length || !contestsContainer) return;
    
    filterTabs.forEach(tab => {
        tab.addEventListener('click', function() {
            const statusGroup = this.dataset.statusGroup;
            
            // Update active tab
            filterTabs.forEach(t => t.classList.remove('active'));
            this.classList.add('active');
            
            // Load contests for the selected status group
            loadMyContestsPage(statusGroup);
            
            // Update tab counts
            updateContestCounts();
        });
    });
}

// Function to update contest counts in the header
function updateContestCounts() {
    if (!currentUser || !userProfile?.joinedTournaments) return;
    
    const joinedIds = Object.keys(userProfile.joinedTournaments);
    let activeCount = 0;
    let completedCount = 0;
    
    // Count contests by status
    joinedIds.forEach(id => {
        const tournament = userProfile.joinedTournaments[id];
        if (tournament) {
            if (tournament.status === 'upcoming' || tournament.status === 'ongoing') {
                activeCount++;
            } else if (tournament.status === 'completed' || tournament.status === 'result') {
                completedCount++;
            }
        }
    });
    
    // Update header counts
    const activeCountEl = document.getElementById('activeContestsCount');
    const completedCountEl = document.getElementById('completedContestsCount');
    
    if (activeCountEl) activeCountEl.textContent = activeCount;
    if (completedCountEl) completedCountEl.textContent = completedCount;
    
    // Update tab counts
    const activeTabCountEl = document.getElementById('activeTabCount');
    const completedTabCountEl = document.getElementById('completedTabCount');
    
    if (activeTabCountEl) activeTabCountEl.textContent = `${activeCount} contest${activeCount !== 1 ? 's' : ''}`;
    if (completedTabCountEl) completedTabCountEl.textContent = `${completedCount} contest${completedCount !== 1 ? 's' : ''}`;
}

async function loadMyContests() {
     console.log("Loading My Contests...");
     if (!currentUser || !elements.myContestsList) { if(elements.myContestsList) removePlaceholders(elements.myContestsList); if(elements.myContestsList) elements.myContestsList.innerHTML = ''; if (elements.noContestsMessage) elements.noContestsMessage.style.display = 'block'; return; }
     const joinedIds = Object.keys(userProfile.joinedTournaments || {});
     elements.myContestsList.classList.add('placeholder-glow');
     elements.myContestsList.innerHTML = `<div class="tournament-card placeholder-glow mb-3"><span class="placeholder col-6"></span><span class="placeholder col-12 mt-2"></span><span class="placeholder col-10 mt-2"></span><div class="d-flex justify-content-between mt-3"><span class="placeholder col-4 h-30"></span><span class="placeholder col-4 h-30"></span></div></div>`; // Placeholder
     if (elements.noContestsMessage) elements.noContestsMessage.style.display = 'none';
     if (joinedIds.length === 0) { removePlaceholders(elements.myContestsList); elements.myContestsList.innerHTML = ''; if (elements.noContestsMessage) elements.noContestsMessage.style.display = 'block'; console.log("No joined contests found for user."); return; }
     console.log(`Found ${joinedIds.length} joined contest IDs.`);
     try {
         const contestPromises = joinedIds.map(id => get(ref(db, `tournaments/${id}`)));
         const snapshots = await Promise.all(contestPromises);
         removePlaceholders(elements.myContestsList);
         elements.myContestsList.innerHTML = ''; // Clear placeholders
         const contestCards = [];
         snapshots.forEach((snapshot, index) => {
             if (snapshot.exists()) {
                 const t = snapshot.val();
                 // Filter to show only upcoming or ongoing in "My Contests"
                 if (t.status === 'upcoming' || t.status === 'ongoing') {
                     const tId = joinedIds[index];
                     contestCards.push({ startTime: t.startTime || 0, card: createTournamentCardElement(tId, t) });
                 }
             } else {
                 console.warn(`Joined tournament ${joinedIds[index]} not found in tournaments node.`);
                 // Optionally remove the invalid entry from user's profile here
                 // update(ref(db, `users/${currentUser.uid}/joinedTournaments/${joinedIds[index]}`), null);
             }
         });
         contestCards.sort((a, b) => a.startTime - b.startTime); // Sort by start time
         if (contestCards.length > 0) {
             contestCards.forEach(item => elements.myContestsList.appendChild(item.card));
         } else if (elements.noContestsMessage) {
             elements.noContestsMessage.style.display = 'block';
             elements.noContestsMessage.textContent = "No upcoming/ongoing joined contests.";
         }
     } catch (e) { console.error("My contests load failed:", e); removePlaceholders(elements.myContestsList); elements.myContestsList.innerHTML = '<p class="text-danger tc">Could not load contests.</p>'; }
}

async function loadMyContestsPage(statusGroup = 'upcoming') {
    console.log(`Loading My Contests page for status: ${statusGroup}`);
    if (!currentUser || !elements.myContestsPageList) {
        if(elements.myContestsPageList) removePlaceholders(elements.myContestsPageList);
        if(elements.myContestsPageList) elements.myContestsPageList.innerHTML = '';
        if (elements.noMyContestsPageMessage) {
            elements.noMyContestsPageMessage.textContent = "Login to see your contests.";
            elements.noMyContestsPageMessage.style.display = 'block';
        }
        return;
    }

    const joinedIds = Object.keys(userProfile.joinedTournaments || {});
    elements.myContestsPageList.classList.add('placeholder-glow');
    elements.myContestsPageList.innerHTML = `<div class="tournament-card placeholder-glow mb-3"><span class="placeholder col-6"></span><span class="placeholder col-12 mt-2"></span><span class="placeholder col-10 mt-2"></span><div class="d-flex justify-content-between mt-3"><span class="placeholder col-6 h-30"></span><span class="placeholder col-6 h-30"></span></div></div>`;
    if (elements.noMyContestsPageMessage) elements.noMyContestsPageMessage.style.display = 'none';

    if (joinedIds.length === 0) {
        removePlaceholders(elements.myContestsPageList);
        elements.myContestsPageList.innerHTML = '';
        if (elements.noMyContestsPageMessage) {
            elements.noMyContestsPageMessage.textContent = "You haven't joined any contests yet.";
            elements.noMyContestsPageMessage.style.display = 'block';
        }
        console.log("No joined contests found for user.");
        return;
    }

    try {
        const contestPromises = joinedIds.map(id => get(ref(db, `tournaments/${id}`)));
        const snapshots = await Promise.all(contestPromises);
        removePlaceholders(elements.myContestsPageList);
        elements.myContestsPageList.innerHTML = ''; // Clear placeholders

        const contestCards = [];
        snapshots.forEach((snapshot, index) => {
            if (snapshot.exists()) {
                const t = snapshot.val();
                const tId = joinedIds[index];

                if (statusGroup === 'upcoming' && t.status === 'upcoming') {
                    contestCards.push({ startTime: t.startTime || 0, card: createModernContestCard(tId, t) });
                } else if (statusGroup === 'ongoing' && t.status === 'ongoing') {
                    contestCards.push({ startTime: t.startTime || 0, card: createModernContestCard(tId, t) });
                } else if (statusGroup === 'completed' && (t.status === 'completed' || t.status === 'result' || t.status === 'cancelled')) {
                    contestCards.push({ startTime: t.startTime || 0, card: createModernContestCard(tId, t) });
                }
            }
        });

        // Sort upcoming by ascending start time, ongoing and completed by descending start time
        if (statusGroup === 'upcoming') {
            contestCards.sort((a, b) => a.startTime - b.startTime);
        } else {
            contestCards.sort((a, b) => b.startTime - a.startTime);
        }

        if (contestCards.length > 0) {
            contestCards.forEach(item => elements.myContestsPageList.appendChild(item.card));
        } else if (elements.noMyContestsPageMessage) {
            elements.noMyContestsPageMessage.style.display = 'block';
            elements.noMyContestsPageMessage.textContent = `No ${statusGroup} contests found.`;
        }
    } catch (e) {
        console.error("My Contests Page load failed:", e);
        removePlaceholders(elements.myContestsPageList);
        elements.myContestsPageList.innerHTML = '<p class="text-danger tc">Could not load your contests.</p>';
    }
}

function loadWalletData() {
     console.log("Loading Wallet Data...");
     if (!currentUser) return;
     loadRecentTransactions();
    loadMyContests();
     // Balance display is handled by populateUserInfo via the realtime listener
}
function loadProfileData() {
     console.log("Loading Profile Data...");
     if (!currentUser) return;
    loadMyContests();
     // Profile header data is handled by populateUserInfo via the realtime listener
     // Ensure placeholders are removed if data already exists
     if (userProfile?.displayName) { removePlaceholders(elements.profileName?.closest('.placeholder-glow')); removePlaceholders(elements.profileEmail?.closest('.placeholder-glow')); removePlaceholders(elements.profileTotalMatches?.closest('.placeholder-glow')); removePlaceholders(elements.profileWonMatches?.closest('.placeholder-glow')); removePlaceholders(elements.profileTotalEarnings?.closest('.placeholder-glow')); }
 }
        function initializeEarningsHistoryFilters() {
            const filterBtns = document.querySelectorAll('.filter-btn');
            filterBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    // Remove active class from all buttons
                    filterBtns.forEach(b => b.classList.remove('active'));
                    // Add active class to clicked button
                    this.classList.add('active');
                    
                    const filter = this.getAttribute('data-filter');
                    filterEarningsHistory(filter);
                });
            });
        }

        function filterEarningsHistory(filter) {
            // This function will filter earnings history based on the selected filter
            // For now, it just shows all items
            console.log('Filtering earnings history by:', filter);
            // TODO: Implement actual filtering logic
        }

        function loadEarningsData() {
    console.log("Loading Earnings Data...");
    console.log("Current user:", currentUser);
    console.log("User profile:", userProfile);
     if (!currentUser) return;
     
     // Format currency function
     const formatCurrency = (amount) => `NPR.${(amount || 0).toFixed(2)}`;
     
     // Load total earnings
     if (typeof userProfile?.totalEarnings !== 'undefined') {
         console.log("Total earnings found:", userProfile.totalEarnings);
         if (elements.earningsTotal) {
             elements.earningsTotal.textContent = formatCurrency(userProfile.totalEarnings);
             removePlaceholders(elements.earningsTotal.closest('.placeholder-glow'));
         }
     } else {
         console.log("Total earnings not found in userProfile");
         if (elements.earningsTotal) {
             elements.earningsTotal.textContent = formatCurrency(0);
         }
     }
     
     // Load referral earnings
     if (typeof userProfile?.referralEarnings !== 'undefined') {
         console.log("Referral earnings found:", userProfile.referralEarnings);
         if (elements.earningsReferral) {
             elements.earningsReferral.textContent = formatCurrency(userProfile.referralEarnings);
             removePlaceholders(elements.earningsReferral.closest('.placeholder-glow'));
         }
     } else {
         console.log("Referral earnings not found in userProfile");
         if (elements.earningsReferral) {
             elements.earningsReferral.textContent = formatCurrency(0);
         }
     }
     
     // Calculate and display net earnings
     const totalEarnings = userProfile.totalEarnings || 0;
     const referralEarnings = userProfile.referralEarnings || 0;
     const netEarnings = totalEarnings + referralEarnings;
     
     if (elements.netEarnings) {
         elements.netEarnings.textContent = formatCurrency(netEarnings);
         removePlaceholders(elements.netEarnings.closest('.placeholder-glow'));
     }
     
     loadEarningsHistory();
}

async function loadReferralData() {
    console.log("Loading Referral Data...");
    console.log("Current user:", currentUser);
    console.log("User profile:", userProfile);
    if (!currentUser) return;
    
    // Load referral code
    if (userProfile?.referralCode) {
        console.log("Referral code found:", userProfile.referralCode);
        elements.userReferralCode.textContent = userProfile.referralCode;
        removePlaceholders(elements.userReferralCode.closest('.placeholder-glow'));
        console.log("User referral code:", userProfile.referralCode);
    } else {
        console.log("No referral code found for user");
    }
    
                     // Load referral stats
                 if (typeof userProfile?.referralEarnings !== 'undefined') {
                     console.log("Referral earnings found:", userProfile.referralEarnings);
                     const formatCurrency = (amount) => `NPR.${amount.toFixed(2)}`;
                     elements.referralEarnings.textContent = formatCurrency(userProfile.referralEarnings || 0);
                     elements.earningsReferral.textContent = formatCurrency(userProfile.referralEarnings || 0);
        
        // Calculate and display net earnings
        const totalEarnings = userProfile.totalEarnings || 0;
        const referralEarnings = userProfile.referralEarnings || 0;
        const netEarnings = totalEarnings + referralEarnings;
        
        if (elements.netEarnings) {
            elements.netEarnings.textContent = formatCurrency(netEarnings);
            removePlaceholders(elements.netEarnings.closest('.placeholder-glow'));
        }
                     removePlaceholders(elements.referralEarnings.closest('.placeholder-glow'));
                 } else {
                     console.log("Referral earnings not found in userProfile");
                 }
    
            // Load referral count and history
        loadReferralHistory();
        
        // Ensure user has a referral code
        if (!userProfile?.referralCode) {
            console.log("User missing referral code, generating one...");
            const newReferralCode = generateReferralCode();
            try {
                await update(ref(db, `users/${currentUser.uid}`), {
                    referralCode: newReferralCode
                });
                userProfile.referralCode = newReferralCode;
                elements.userReferralCode.textContent = newReferralCode;
                console.log("Generated new referral code:", newReferralCode);
            } catch (error) {
                console.error("Error generating referral code:", error);
            }
        }
        
        // Debug: Log current user profile data
        console.log("Current user profile:", {
            uid: currentUser.uid,
            referralCode: userProfile?.referralCode,
            referralEarnings: userProfile?.referralEarnings,
            referredBy: userProfile?.referredBy
        });
        
        // Check if referral data is properly stored in Firebase
        try {
            const userRef = ref(db, `users/${currentUser.uid}`);
            const userSnap = await get(userRef);
            if (userSnap.exists()) {
                const userData = userSnap.val();
                console.log("Firebase user data:", {
                    referralCode: userData.referralCode,
                    referralEarnings: userData.referralEarnings,
                    referredBy: userData.referredBy
                });
            }
        } catch (error) {
            console.error("Error checking Firebase data:", error);
        }
}

async function loadReferralHistory() {
    console.log("Loading Referral History...");
    if (!currentUser || !elements.referralHistoryList) return;
    
    elements.referralHistoryList.innerHTML = '';
    elements.referralHistoryList.classList.add('placeholder-glow');
    
    // Add placeholder
    elements.referralHistoryList.innerHTML = `
        <div class="d-flex justify-content-between align-items-center p-3 border-bottom">
            <div>
                <span class="placeholder col-4" style="height: 16px;"></span>
                <br>
                <span class="placeholder col-6" style="height: 14px;"></span>
            </div>
            <span class="placeholder col-2" style="height: 20px;"></span>
        </div>
    `;
    
    try {
        // Get users who were referred by current user
        const usersRef = ref(db, 'users');
        const snapshot = await get(usersRef);
        
        // Filter users manually since we can't use the index
        const allUsers = snapshot.val() || {};
        const referrals = [];
        
        Object.values(allUsers).forEach(user => {
            if (user.referredBy === currentUser.uid) {
                referrals.push({
                    uid: user.uid,
                    displayName: user.displayName || 'Unknown User',
                    email: user.email || 'N/A',
                    joinedAt: user.createdAt || Date.now(),
                    status: user.status || 'active'
                });
            }
        });
        
        console.log("Searching for users referred by:", currentUser.uid);
        console.log("Total referrals found:", referrals.length);
        
        removePlaceholders(elements.referralHistoryList);
        elements.referralHistoryList.innerHTML = '';
        
        // Sort by join date (newest first)
        referrals.sort((a, b) => b.joinedAt - a.joinedAt);
        
        if (referrals.length > 0) {
            // Update referral count with null checks
            if (elements.referralCount) {
                elements.referralCount.textContent = referrals.length;
                removePlaceholders(elements.referralCount.closest('.placeholder-glow'));
            }
            
            // Update referral count text if it exists
            if (elements.referralCountText) {
                elements.referralCountText.textContent = `From ${referrals.length} successful referral(s)`;
            }
            
            referrals.forEach(referral => {
                const item = document.createElement('div');
                item.className = 'compact-referral-history-item';
                
                const joinDate = new Date(referral.joinedAt).toLocaleDateString([], { 
                    year: 'numeric', 
                    month: 'short', 
                    day: 'numeric' 
                });
                
                const statusBadge = referral.status === 'active' ? 
                    '<span class="referral-status-badge active">Active</span>' : 
                    '<span class="referral-status-badge inactive">Inactive</span>';
                
                item.innerHTML = `
                    <div class="referral-item-content">
                        <div class="referral-item-info">
                            <div class="referral-item-name">${sanitizeHTML(referral.displayName)}</div>
                            <div class="referral-item-email">${sanitizeHTML(referral.email)}</div>
                        </div>
                        <div class="referral-item-meta">
                            <div class="referral-item-date">${joinDate}</div>
                            ${statusBadge}
                        </div>
                    </div>
                `;
                
                elements.referralHistoryList.appendChild(item);
            });
            
            if (elements.noReferralHistory) {
                elements.noReferralHistory.style.display = 'none';
            }
        } else {
            // Update referral count with null checks
            if (elements.referralCount) {
                elements.referralCount.textContent = '0';
            }
            if (elements.referralCountText) {
                elements.referralCountText.textContent = 'From 0 successful referral(s)';
            }
            if (elements.noReferralHistory) {
                elements.noReferralHistory.style.display = 'block';
            }
        }
    } catch (error) {
        console.error("Error loading referral history:", error);
        if (elements.referralHistoryList) {
            elements.referralHistoryList.innerHTML = '<p class="text-danger text-center p-3">Error loading referral history.</p>';
        }
        if (elements.noReferralHistory) {
            elements.noReferralHistory.style.display = 'none';
        }
    }
    }

    async function loadStatsData() {
        console.log("Loading Stats Data...");
        console.log("Current user:", currentUser);
        console.log("User profile:", userProfile);
        if (!currentUser || !userProfile) return;
        
        try {
            // Calculate user stats using the new function
            const userStats = await calculateUserStats(userProfile);
            console.log("Calculated user stats:", userStats);
            
            // Add other stats from user profile
            userStats.tournamentWinnings = userProfile.totalEarnings || 0;
            userStats.referralWinnings = userProfile.referralEarnings || 0;
            userStats.entryFeesPaid = userProfile.entryFeesPaid || 0;
            
            // Calculate net earnings
            const netEarnings = userStats.tournamentWinnings + userStats.referralWinnings - userStats.entryFeesPaid;
            
            // Update UI with null checks
            if (elements.statsTournamentsJoined) {
                elements.statsTournamentsJoined.textContent = userStats.tournamentsJoined;
            }
            if (elements.statsMatchesPlayed) {
                elements.statsMatchesPlayed.textContent = userStats.matchesPlayed;
            }
            if (elements.statsMatchesWon) {
                elements.statsMatchesWon.textContent = userStats.matchesWon;
            }
            if (elements.statsWinRate) {
                elements.statsWinRate.textContent = `${userStats.winRate}%`;
            }

            if (elements.statsWinRateProgress) {
                elements.statsWinRateProgress.style.width = `${userStats.winRate}%`;
            }
            
            // Format currency values
            const formatCurrency = (amount) => `NPR.${amount.toFixed(2)}`;
            
            if (elements.statsTournamentWinnings) {
                elements.statsTournamentWinnings.textContent = `+ ${formatCurrency(userStats.tournamentWinnings)}`;
            }
            if (elements.statsReferralWinnings) {
                elements.statsReferralWinnings.textContent = `+ ${formatCurrency(userStats.referralWinnings)}`;
            }
            if (elements.statsEntryFees) {
                elements.statsEntryFees.textContent = `- ${formatCurrency(userStats.entryFeesPaid)}`;
            }
            if (elements.statsNetEarnings) {
                elements.statsNetEarnings.textContent = formatCurrency(netEarnings);
            }
            
            console.log("Stats loaded:", userStats);
            
        } catch (error) {
            console.error("Error loading stats:", error);
        }
    }

 // Function to manually update user stats (for testing)
 // Make function globally accessible
window.updateUserStats = async function(type, value) {
     if (!currentUser || !db) return;
     
     try {
         const userRef = ref(db, `users/${currentUser.uid}`);
         const updates = {};
         
         switch(type) {
             case 'tournamentsJoined':
                 updates.tournamentsJoined = (userProfile.tournamentsJoined || 0) + value;
                 break;
             case 'matchesPlayed':
                 updates.totalMatches = (userProfile.totalMatches || 0) + value;
                 break;
             case 'matchesWon':
                 updates.wonMatches = (userProfile.wonMatches || 0) + value;
                 break;
             case 'entryFeesPaid':
                 updates.entryFeesPaid = (userProfile.entryFeesPaid || 0) + value;
                 break;
         }
         
         await update(userRef, updates);
         console.log(`Updated ${type} by ${value}`);
         
         // Reload user profile and stats
         // User profile is loaded via Firebase listener, just reload stats if needed
         if (currentSection === 'stats-section') {
             await loadStatsData();
         }
         
     } catch (error) {
         console.error("Error updating user stats:", error);
          }
 }

 // Function to sync tournaments joined count from actual joined tournaments
 // Make function globally accessible
window.syncTournamentsJoined = async function() {
     if (!currentUser || !db) return;
     
     try {
         console.log("Syncing tournaments joined count...");
         
         // Calculate stats using the new function
         const userStats = await calculateUserStats(userProfile);
         const actualJoinedCount = userStats.tournamentsJoined;
         
         console.log("Calculated tournaments joined:", actualJoinedCount);
         
         // Update the tournamentsJoined count
         const userRef = ref(db, `users/${currentUser.uid}`);
         await update(userRef, {
             tournamentsJoined: actualJoinedCount
         });
         
         console.log(`Updated tournamentsJoined to ${actualJoinedCount}`);
         
         // Reload user profile and stats
         // User profile is loaded via Firebase listener, just reload stats if needed
         if (currentSectionId === 'stats-section') {
             await loadStatsData();
         }
         
         showStatusMessage(elements.inGameNameStatusMessage, `Synced! Found ${actualJoinedCount} joined tournaments.`, 'success');
         
     } catch (error) {
         console.error("Error syncing tournaments joined:", error);
         showStatusMessage(elements.inGameNameStatusMessage, `Error syncing: ${error.message}`, 'danger');
     }
 }

 // Function to fix matches played count
 // Make function globally accessible
window.fixMatchesPlayed = async function() {
    if (!currentUser || !db) return;
    
    try {
        console.log("Fixing matches played count...");
        
        // Calculate stats using the new function
        const userStats = await calculateUserStats(userProfile);
        const calculatedMatchesPlayed = userStats.matchesPlayed;
        const calculatedMatchesWon = userStats.matchesWon;
        
        console.log(`Calculated matches played: ${calculatedMatchesPlayed}, wins: ${calculatedMatchesWon}`);
        
        // Update the database with the correct values
        const userRef = ref(db, `users/${currentUser.uid}`);
        await update(userRef, {
            totalMatches: calculatedMatchesPlayed,
            wonMatches: calculatedMatchesWon
        });
        
        console.log(`Fixed matches played: ${calculatedMatchesPlayed}, wins: ${calculatedMatchesWon}`);
        
        // Reload user profile and stats
        // User profile is loaded via Firebase listener, just reload stats if needed
        if (currentSectionId === 'stats-section') {
            await loadStatsData();
        }
        
        showStatusMessage(elements.inGameNameStatusMessage, `Fixed! Matches played: ${calculatedMatchesPlayed}, Wins: ${calculatedMatchesWon}`, 'success');
        
    } catch (error) {
        console.error("Error fixing matches played:", error);
        showStatusMessage(elements.inGameNameStatusMessage, `Error fixing: ${error.message}`, 'danger');
    }
}

 async function loadEarningsHistory() {
    console.log("Loading Earnings History...");
    const earningsHistoryEl = document.createElement('div');
    earningsHistoryEl.id = 'earningsHistoryListEl';
    const existingList = getElement('earningsHistoryListEl');
    if(existingList) existingList.remove();
    
    elements.earningsSection.appendChild(earningsHistoryEl);
    
    earningsHistoryEl.innerHTML = '<div class="custom-card p-2 mb-2 placeholder-glow"><div class="d-flex justify-content-between"><span class="placeholder col-5 h-16"></span><span class="placeholder col-3 h-16"></span></div><div class="small text-secondary mt-1"><span class="placeholder col-6 h-14"></span></div></div>';

    if (!currentUser) return;

    try {
        const transRef = ref(db, `transactions/${currentUser.uid}`);
        const s = await get(transRef);
        const transactions = s.val() || {};
        
        const earningTypes = ['tournament_prize', 'referral_bonus', 'signup_bonus'];
        const earnings = Object.values(transactions)
            .filter(t => earningTypes.includes(t.type) && t.amount > 0)
            .sort((a, b) => (b.timestamp || 0) - (a.timestamp || 0));

        earningsHistoryEl.innerHTML = '';
        removePlaceholders(earningsHistoryEl);

        if (earnings.length > 0) {
            const historyTitle = document.createElement('h3');
            historyTitle.className = 'section-title mt-4';
            historyTitle.textContent = 'Earnings History';
            earningsHistoryEl.appendChild(historyTitle);

            earnings.forEach(t => {
                const item = document.createElement('div');
                item.className = 'custom-card p-2 mb-2 d-flex justify-content-between align-items-center';
                const amt = `+NPR.${(t.amount || 0).toFixed(2)}`;
                const time = t.timestamp ? new Date(t.timestamp).toLocaleString([], { dateStyle: 'short', timeStyle: 'short' }) : 'N/A';
                item.innerHTML = `
                    <div>
                        <div class="small fw-bold">${t.description || t.type.replace('_', ' ').replace(/\b\w/g, l => l.toUpperCase())}</div>
                        <div class="small text-secondary">${time}</div>
                    </div>
                    <div class="fw-bold text-success">${amt}</div>
                `;
                earningsHistoryEl.appendChild(item);
            });
        } else {
            const noHistory = document.createElement('p');
            noHistory.className = 'text-secondary text-center mt-3';
            noHistory.textContent = 'No earnings recorded yet.';
            earningsHistoryEl.appendChild(noHistory);
        }
    } catch (e) {
        console.error("Earnings history load failed:", e);
        earningsHistoryEl.innerHTML = '<p class="text-danger tc">Could not load earnings history.</p>';
    }
}

async function recordTransaction(userId, type, amount, description, details = {}) {
    if (!userId) return;
    const transactionRef = ref(db, `transactions/${userId}`);
    const newTransaction = { type, amount, description, timestamp: Date.now(), ...details }; // Use client time for simplicity here
    try {
        await push(transactionRef, newTransaction);
        console.log(`Transaction recorded: ${type}, Amount: ${amount}`);
    } catch (e) {
        console.error("Transaction record failed:", e);
    }
}

// Support Functions
async function createSupportTicket() {
    if (!currentUser) {
        alert('Please login first to create a support ticket.');
        return;
    }

    const subject = document.getElementById('ticketSubjectInputEl').value.trim();
    const category = document.getElementById('ticketCategoryInputEl').value;
    const priority = document.getElementById('ticketPriorityInputEl').value;
    const description = document.getElementById('ticketDescriptionInputEl').value.trim();

    if (!subject || !category || !priority || !description) {
        alert('Please fill in all fields.');
        return;
    }

    try {
        const ticketData = {
            subject,
            category,
            priority,
            description,
            status: 'pending',
            userId: currentUser.uid,
            userEmail: currentUser.email,
            createdAt: serverTimestamp(),
            updatedAt: serverTimestamp()
        };

        const ticketsRef = ref(db, 'supportTickets');
        const newTicketRef = await push(ticketsRef, ticketData);
        
        // Add initial message
        const messagesRef = ref(db, `supportTickets/${newTicketRef.key}/messages`);
        await push(messagesRef, {
            text: description,
            sender: 'user',
            timestamp: serverTimestamp(),
            userId: currentUser.uid
        });

        // Close modal
        const modal = bootstrap.Modal.getInstance(document.getElementById('createTicketModalEl'));
        modal.hide();

        // Reset form
        document.getElementById('createTicketFormEl').reset();

        // Show success message
        alert('Support ticket created successfully!');

        // Refresh tickets list
        loadUserSupportTickets();

    } catch (error) {
        console.error("Error creating support ticket:", error);
        alert('Error creating ticket: ' + error.message);
    }
}

async function loadUserSupportTickets() {
    if (!currentUser) return;

    try {
        const ticketsRef = ref(db, 'supportTickets');
        const ticketsSnap = await get(ticketsRef);
        const tickets = ticketsSnap.val() || {};

        // Filter tickets for current user
        const userTickets = Object.entries(tickets)
            .filter(([ticketId, ticket]) => ticket.userId === currentUser.uid)
            .map(([ticketId, ticket]) => ({
                id: ticketId,
                ...ticket
            }))
            .sort((a, b) => {
                const timeA = a.createdAt ? new Date(a.createdAt).getTime() : 0;
                const timeB = b.createdAt ? new Date(b.createdAt).getTime() : 0;
                return timeB - timeA;
            });

        // Update statistics
        const activeTickets = userTickets.filter(t => t.status !== 'resolved').length;
        const resolvedTickets = userTickets.filter(t => t.status === 'resolved').length;

        if (elements.supportActiveTicketsEl) {
            elements.supportActiveTicketsEl.textContent = activeTickets;
        }
        if (elements.supportResolvedTicketsEl) {
            elements.supportResolvedTicketsEl.textContent = resolvedTickets;
        }

        // Update tickets list
        const ticketsList = elements.supportTicketsListEl;
        if (ticketsList) {
            ticketsList.innerHTML = '';
            ticketsList.classList.remove('placeholder-glow');

            if (userTickets.length > 0) {
                userTickets.forEach(ticket => {
                    const ticketItem = document.createElement('div');
                    ticketItem.className = 'custom-card mb-2';
                    ticketItem.style.cursor = 'pointer';

                    const statusBadgeClass = {
                        'pending': 'bg-warning',
                        'in-progress': 'bg-primary',
                        'resolved': 'bg-success'
                    }[ticket.status] || 'bg-secondary';

                    const priorityBadgeClass = {
                        'low': 'bg-info',
                        'medium': 'bg-warning',
                        'high': 'bg-danger',
                        'urgent': 'bg-danger'
                    }[ticket.priority] || 'bg-secondary';

                    ticketItem.innerHTML = `
                        <div class="d-flex justify-content-between align-items-start">
                            <div class="flex-grow-1">
                                <h6 class="mb-1">${ticket.subject}</h6>
                                <p class="text-muted small mb-2">${ticket.description.substring(0, 100)}${ticket.description.length > 100 ? '...' : ''}</p>
                                <div class="d-flex gap-2 align-items-center">
                                    <span class="badge ${statusBadgeClass}">${ticket.status}</span>
                                    <span class="badge ${priorityBadgeClass}">${ticket.priority}</span>
                                    <small class="text-muted">${ticket.category}</small>
                                </div>
                            </div>
                            <div class="text-end">
                                <small class="text-muted">${ticket.createdAt ? new Date(ticket.createdAt).toLocaleDateString() : 'Unknown Date'}</small>
                            </div>
                        </div>
                    `;

                    // Add click event to open chat
                    ticketItem.addEventListener('click', () => {
                        openUserSupportChat(ticket);
                    });

                    ticketsList.appendChild(ticketItem);
                });

                elements.noTicketsMessageEl.style.display = 'none';
            } else {
                elements.noTicketsMessageEl.style.display = 'block';
            }
        }

    } catch (error) {
        console.error("Error loading user support tickets:", error);
        if (elements.supportTicketsListEl) {
            elements.supportTicketsListEl.innerHTML = '<p class="text-danger text-center p-3">Error loading tickets.</p>';
        }
    }
}

function openUserSupportChat(ticket) {
    console.log("Opening user support chat for ticket:", ticket);

    // Populate ticket info
    document.getElementById('chatTicketSubjectEl').textContent = ticket.subject;
    document.getElementById('chatTicketIdEl').textContent = ticket.id;
    document.getElementById('chatTicketStatusEl').textContent = ticket.status;
    document.getElementById('chatTicketCategoryEl').textContent = ticket.category;
    document.getElementById('chatTicketPriorityEl').textContent = ticket.priority;

    // Set status badge
    const statusBadge = document.getElementById('chatTicketStatusEl');
    statusBadge.className = 'badge ' + {
        'pending': 'bg-warning',
        'in-progress': 'bg-primary',
        'resolved': 'bg-success'
    }[ticket.status] || 'bg-secondary';

    // Show/hide resolve button based on status
    const resolveBtn = document.getElementById('resolveTicketBtnEl');
    if (resolveBtn) {
        resolveBtn.style.display = ticket.status === 'resolved' ? 'none' : 'inline-block';
    }

    // Store current ticket for chat operations
    window.currentUserSupportTicket = ticket;

    // Load chat messages
    loadUserSupportChatMessages(ticket.id);

    // Show modal
    const modal = new bootstrap.Modal(document.getElementById('supportChatModalEl'));
    modal.show();
}

async function loadUserSupportChatMessages(ticketId) {
    try {
        const messagesRef = ref(db, `supportTickets/${ticketId}/messages`);
        const messagesSnap = await get(messagesRef);
        const messages = messagesSnap.val() || {};

        const messagesContainer = document.getElementById('chatMessagesEl');
        messagesContainer.innerHTML = '';

        const messagesArray = Object.entries(messages).map(([msgId, msg]) => ({
            id: msgId,
            ...msg
        }));

        // Sort messages by timestamp
        messagesArray.sort((a, b) => {
            const timeA = a.timestamp ? new Date(a.timestamp).getTime() : 0;
            const timeB = b.timestamp ? new Date(b.timestamp).getTime() : 0;
            return timeA - timeB;
        });

        messagesArray.forEach(message => {
            const messageEl = document.createElement('div');
            messageEl.className = `chat-message mb-2 ${message.sender === 'user' ? 'text-end' : 'text-start'}`;

            const messageBubble = document.createElement('div');
            messageBubble.className = `d-inline-block p-2 rounded ${message.sender === 'user' ? 'bg-primary text-white' : 'bg-light text-dark'}`;
            messageBubble.style.maxWidth = '70%';
            messageBubble.innerHTML = `
                <div class="message-text">${message.text}</div>
                <small class="message-time opacity-75">${message.timestamp ? new Date(message.timestamp).toLocaleTimeString() : ''}</small>
            `;

            messageEl.appendChild(messageBubble);
            messagesContainer.appendChild(messageEl);
        });

        // Scroll to bottom
        messagesContainer.scrollTop = messagesContainer.scrollHeight;

    } catch (error) {
        console.error("Error loading user support chat messages:", error);
        const messagesContainer = document.getElementById('chatMessagesEl');
        messagesContainer.innerHTML = '<p class="text-danger text-center">Error loading messages.</p>';
    }
}

async function sendUserChatMessage() {
    const messageInput = document.getElementById('chatMessageInputEl');
    const message = messageInput.value.trim();

    if (!message || !window.currentUserSupportTicket) return;

    try {
        const ticketId = window.currentUserSupportTicket.id;
        const messagesRef = ref(db, `supportTickets/${ticketId}/messages`);

        const newMessage = {
            text: message,
            sender: 'user',
            timestamp: serverTimestamp(),
            userId: currentUser.uid
        };

        await push(messagesRef, newMessage);

        // Clear input
        messageInput.value = '';

        // Reload messages
        await loadUserSupportChatMessages(ticketId);

    } catch (error) {
        console.error("Error sending user message:", error);
        alert('Error sending message: ' + error.message);
    }
}

async function resolveUserTicket() {
    if (!window.currentUserSupportTicket) return;

    try {
        const ticketId = window.currentUserSupportTicket.id;
        const ticketRef = ref(db, `supportTickets/${ticketId}`);

        await update(ticketRef, {
            status: 'resolved',
            resolvedAt: serverTimestamp(),
            resolvedBy: 'user'
        });

        // Update current ticket object
        window.currentUserSupportTicket.status = 'resolved';

        // Update UI
        const statusBadge = document.getElementById('chatTicketStatusEl');
        statusBadge.textContent = 'resolved';
        statusBadge.className = 'badge bg-success';

        // Hide resolve button
        const resolveBtn = document.getElementById('resolveTicketBtnEl');
        if (resolveBtn) {
            resolveBtn.style.display = 'none';
        }

        // Show success message
        alert('Ticket marked as resolved!');

        // Refresh support data
        loadUserSupportTickets();

    } catch (error) {
        console.error("Error resolving user ticket:", error);
        alert('Error resolving ticket: ' + error.message);
    }
}

async function processReferralBonus(referrerUid, newUserId, newUserName) {
    if (!referrerUid || !newUserId || !appSettings.referralBonus) {
        console.log("Missing data for referral bonus:", { referrerUid, newUserId, referralBonus: appSettings.referralBonus });
        return;
    }
    
    console.log(`Processing referral bonus: ${appSettings.referralBonus} to ${referrerUid} for new user ${newUserId}`);
    
    try {
        // Get referrer's current data
        const referrerRef = ref(db, `users/${referrerUid}`);
        const referrerSnap = await get(referrerRef);
        
        if (!referrerSnap.exists()) {
            console.error("Referrer not found:", referrerUid);
            return;
        }
        
        const referrerData = referrerSnap.val();
        const bonusAmount = appSettings.referralBonus || 20; // Default to 20 if not set
        
        // Update referrer's bonus cash and earnings
        const updates = {
            bonusCash: (referrerData.bonusCash || 0) + bonusAmount,
            referralEarnings: (referrerData.referralEarnings || 0) + bonusAmount,
            lastUpdated: Date.now()
        };
        
        // Update referrer's profile
        await update(referrerRef, updates);
        console.log("Referrer balance updated successfully");
        
        // Record transaction for referrer
        await recordTransaction(referrerUid, 'referral_bonus', bonusAmount, `Referral Bonus from ${newUserName}`);
        
        // Also award bonus to new user if they should get one
        const newUserRef = ref(db, `users/${newUserId}`);
        const newUserSnap = await get(newUserRef);
        
        if (newUserSnap.exists()) {
            const newUserData = newUserSnap.val();
            const newUserUpdates = {
                bonusCash: (newUserData.bonusCash || 0) + bonusAmount,
                referralEarnings: (newUserData.referralEarnings || 0) + bonusAmount,
                lastUpdated: Date.now()
            };
            
            await update(newUserRef, newUserUpdates);
            await recordTransaction(newUserId, 'referral_bonus', bonusAmount, `Referral Bonus for joining`);
            console.log("New user also awarded referral bonus");
        }
        
        console.log("Referral bonus processing completed successfully");
        
    } catch (error) {
        console.error("Error processing referral bonus:", error);
    }
}

async function loadRecentTransactions() {
     console.log("Loading Recent Transactions...");
     if (!currentUser || !elements.recentTransactionsList) return; const limit = 5;
     elements.recentTransactionsList.innerHTML = ''; elements.recentTransactionsList.classList.add('placeholder-glow');
     for (let i = 0; i < 3; i++) elements.recentTransactionsList.innerHTML += `<div class="custom-card p-2 mb-2 placeholder-glow"><div class="d-flex justify-content-between"><span class="placeholder col-5 h-16"></span><span class="placeholder col-3 h-16"></span></div><div class="small text-secondary mt-1"><span class="placeholder col-6 h-14"></span></div></div>`; // Placeholders
     if (elements.noTransactionsMessage) { elements.noTransactionsMessage.style.display = 'block'; elements.noTransactionsMessage.textContent = 'Loading transactions...'; }
     try {
         const transRef = query(ref(db, `transactions/${currentUser.uid}`), limitToLast(limit));
         const s = await get(transRef);
         const transactions = s.val() || {};
         const sortedT = Object.values(transactions).sort((a, b) => (b.timestamp || 0) - (a.timestamp || 0));
         console.log(`Found ${sortedT.length} recent transactions.`);

         // Update transactions count
         if (elements.transactionsCountEl) {
             elements.transactionsCountEl.textContent = sortedT.length;
         }

         removePlaceholders(elements.recentTransactionsList);
         elements.recentTransactionsList.innerHTML = ''; // Clear placeholders

         if (sortedT.length > 0) {
             if (elements.noTransactionsMessage) elements.noTransactionsMessage.style.display = 'none';
             sortedT.forEach(t => { 
                 const item = document.createElement('div'); 
                 item.className = 'compact-transaction-item'; 
                 const isCr = t.amount > 0; 
                 const amt = `${isCr ? '+' : ''}NPR.${Math.abs(t.amount || 0).toFixed(2)}`; 
                 const time = t.timestamp ? new Date(t.timestamp).toLocaleString([], { dateStyle: 'short', timeStyle: 'short' }) : 'N/A'; 
                 
                 // Get appropriate icon based on transaction type
                 let icon = 'bi-receipt';
                 if (t.type === 'deposit' || t.type === 'deposit_approved') icon = 'bi-plus-circle';
                 else if (t.type === 'withdrawal' || t.type === 'withdrawal_approved') icon = 'bi-arrow-up-circle';
                 else if (t.type === 'tournament_win' || t.type === 'prize') icon = 'bi-trophy';
                 else if (t.type === 'referral_bonus') icon = 'bi-people';
                 
                 item.innerHTML = `
                     <div class="transaction-item-content">
                         <div class="transaction-item-info">
                             <div class="transaction-item-title">${t.description || t.type || 'Transaction'}</div>
                             <div class="transaction-item-time">${time}</div>
                         </div>
                         <div class="transaction-item-amount ${isCr ? 'positive' : 'negative'}">${amt}</div>
                     </div>
                 `; 
                 elements.recentTransactionsList.appendChild(item); 
             });
         } else if (elements.noTransactionsMessage) {
             elements.noTransactionsMessage.style.display = 'block';
             elements.noTransactionsMessage.textContent = 'No recent transactions.';
         }
     } catch (e) { console.error("Transactions load failed:", e); removePlaceholders(elements.recentTransactionsList); elements.recentTransactionsList.innerHTML = '<p class="text-danger tc">Could not load transactions.</p>'; if (elements.noTransactionsMessage) elements.noTransactionsMessage.style.display = 'none'; }
}

// --- Deposit History Functions ---
async function showDepositHistory() {
    if (!currentUser) {
        alert('Please login to view deposit history.');
        return;
    }
    
    if (elements.depositHistoryModalInstance) {
        // Setup filter event listeners
        setupDepositHistoryFilters();
        
        // Show modal and load data
        elements.depositHistoryModalInstance.show();
        await loadDepositHistory();
    }
}

async function loadDepositHistory() {
    if (!currentUser || !elements.depositHistoryList) return;
    
    // Show loading state
    elements.depositHistoryLoading.style.display = 'block';
    elements.depositHistoryList.style.display = 'none';
    elements.depositHistoryEmpty.style.display = 'none';
    
    try {
        // Get all transactions for the user
        const transRef = ref(db, `transactions/${currentUser.uid}`);
        const snapshot = await get(transRef);
        const transactions = snapshot.val() || {};
        
        // Filter for deposit-related transactions
        const depositTransactions = Object.values(transactions).filter(tx => 
            tx.type && (
                tx.type === 'deposit' || 
                tx.type === 'deposit_approved' || 
                tx.type === 'deposit_rejected' ||
                tx.type === 'admin_deposit'
            )
        );
        
        // Sort by timestamp (newest first)
        const sortedDeposits = depositTransactions.sort((a, b) => (b.timestamp || 0) - (a.timestamp || 0));
        
        // Apply filters
        const filteredDeposits = applyDepositFilters(sortedDeposits);
        
        // Hide loading state
        elements.depositHistoryLoading.style.display = 'none';
        
        if (filteredDeposits.length > 0) {
            elements.depositHistoryList.style.display = 'block';
            elements.depositHistoryEmpty.style.display = 'none';
            renderDepositHistory(filteredDeposits);
        } else {
            elements.depositHistoryList.style.display = 'none';
            elements.depositHistoryEmpty.style.display = 'block';
        }
        
    } catch (error) {
        console.error('Error loading deposit history:', error);
        elements.depositHistoryLoading.style.display = 'none';
        elements.depositHistoryList.innerHTML = '<p class="text-danger text-center">Error loading deposit history. Please try again.</p>';
    }
}

function applyDepositFilters(deposits) {
    const statusFilter = elements.depositStatusFilter?.value || 'all';
    const dateFilter = elements.depositDateFilter?.value || 'all';
    
    let filtered = deposits;
    
    // Apply status filter
    if (statusFilter !== 'all') {
        filtered = filtered.filter(deposit => {
            if (statusFilter === 'approved') {
                return deposit.type === 'deposit_approved' || deposit.type === 'admin_deposit';
            } else if (statusFilter === 'pending') {
                return deposit.type === 'deposit';
            } else if (statusFilter === 'rejected') {
                return deposit.type === 'deposit_rejected';
            }
            return true;
        });
    }
    
    // Apply date filter
    if (dateFilter !== 'all') {
        const now = new Date();
        const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
        const weekAgo = new Date(today.getTime() - 7 * 24 * 60 * 60 * 1000);
        const monthAgo = new Date(today.getFullYear(), today.getMonth() - 1, today.getDate());
        const yearAgo = new Date(today.getFullYear() - 1, today.getMonth(), today.getDate());
        
        filtered = filtered.filter(deposit => {
            const depositDate = new Date(deposit.timestamp || 0);
            
            switch (dateFilter) {
                case 'today':
                    return depositDate >= today;
                case 'week':
                    return depositDate >= weekAgo;
                case 'month':
                    return depositDate >= monthAgo;
                case 'year':
                    return depositDate >= yearAgo;
                default:
                    return true;
            }
        });
    }
    
    return filtered;
}

function renderDepositHistory(deposits) {
    if (!elements.depositHistoryList) return;
    
    elements.depositHistoryList.innerHTML = '';
    
    deposits.forEach(deposit => {
        const depositItem = document.createElement('div');
        depositItem.className = 'deposit-history-item';
        
        const status = getDepositStatus(deposit);
        const amount = Math.abs(deposit.amount || 0);
        const date = deposit.timestamp ? new Date(deposit.timestamp).toLocaleString('en-IN', {
            dateStyle: 'medium',
            timeStyle: 'short'
        }) : 'N/A';
        
        const description = getDepositDescription(deposit);
        const note = deposit.note || deposit.adminNote || '';
        
        depositItem.innerHTML = `
            <div class="deposit-history-header">
                <h6 class="deposit-history-title">${description}</h6>
                <span class="deposit-history-status ${status.toLowerCase()}">${status}</span>
            </div>
            <div class="deposit-history-details">
                <span class="deposit-history-amount">NPR.${amount.toFixed(2)}</span>
                <span class="deposit-history-date">${date}</span>
            </div>
            ${note ? `<p class="deposit-history-note">${note}</p>` : ''}
        `;
        
        elements.depositHistoryList.appendChild(depositItem);
    });
}

function getDepositStatus(deposit) {
    switch (deposit.type) {
        case 'deposit':
            return 'Pending';
        case 'deposit_approved':
        case 'admin_deposit':
            return 'Approved';
        case 'deposit_rejected':
            return 'Rejected';
        default:
            return 'Unknown';
    }
}

function getDepositDescription(deposit) {
    switch (deposit.type) {
        case 'deposit':
            return 'Deposit Request';
        case 'deposit_approved':
            return 'Deposit Approved';
        case 'deposit_rejected':
            return 'Deposit Rejected';
        case 'admin_deposit':
            return 'Admin Deposit';
        default:
            return 'Deposit Transaction';
    }
}

// Add event listeners for filters
function setupDepositHistoryFilters() {
    if (elements.depositStatusFilter) {
        elements.depositStatusFilter.addEventListener('change', () => {
            if (elements.depositHistoryModalInstance && elements.depositHistoryModalInstance._isShown) {
                loadDepositHistory();
            }
        });
    }
    
    if (elements.depositDateFilter) {
        elements.depositDateFilter.addEventListener('change', () => {
            if (elements.depositHistoryModalInstance && elements.depositHistoryModalInstance._isShown) {
                loadDepositHistory();
            }
        });
    }
}

// Function to create sample deposit data for testing (remove in production)
async function createSampleDepositData() {
    if (!currentUser) return;
    
    try {
        const sampleDeposits = [
            {
                type: 'deposit',
                amount: 500,
                timestamp: Date.now() - 2 * 24 * 60 * 60 * 1000, // 2 days ago
                description: 'Sample Deposit Request',
                status: 'pending'
            },
            {
                type: 'deposit_approved',
                amount: 1000,
                timestamp: Date.now() - 5 * 24 * 60 * 60 * 1000, // 5 days ago
                description: 'Sample Approved Deposit',
                status: 'completed',
                adminNote: 'Payment verified successfully'
            },
            {
                type: 'admin_deposit',
                amount: 250,
                timestamp: Date.now() - 10 * 24 * 60 * 60 * 1000, // 10 days ago
                description: 'Admin Bonus Credit',
                status: 'completed',
                adminNote: 'Welcome bonus for new user'
            }
        ];
        
        const transRef = ref(db, `transactions/${currentUser.uid}`);
        for (const deposit of sampleDeposits) {
            await push(transRef, deposit);
        }
        
        console.log('Sample deposit data created successfully');
        // Reload deposit history if modal is open
        if (elements.depositHistoryModalInstance && elements.depositHistoryModalInstance._isShown) {
            await loadDepositHistory();
        }
    } catch (error) {
        console.error('Error creating sample data:', error);
    }
}

async function handleJoinTournamentClick(event) {
    console.log("Join button clicked!");
    
    if (!currentUser) {
        console.log("User not logged in");
        alert("Login to join.");
        showSection('login-section');
        return;
    }
    
    console.log("User is logged in:", currentUser.uid);
    
    const btn = event.currentTarget;
    const tId = btn.dataset.tournamentId;
    const fee = parseFloat(btn.dataset.fee || 0);
    const tName = btn.closest('.tournament-card')?.querySelector('.tournament-card-title')?.textContent.trim() || 'this tournament';

    console.log("Tournament ID:", tId, "Fee:", fee, "Name:", tName);

    if (!tId) {
        console.log("No tournament ID found");
        return;
    }
    
    try {
        await openInGameNameModal(tId, tName, fee);
    } catch (error) {
        console.error("Error opening modal:", error);
        alert("Error opening tournament modal. Please try again.");
    }
}


// --- Modal Handlers ---
 function handleWithdrawClick() {
     if (!currentUser || !elements.withdrawModalInstance) return;
     const wc = userProfile.winningCash || 0;
    const rules = appSettings?.withdrawalRules || {};
    const minW = (rules.minPerRequest ?? (appSettings?.minWithdraw)) || 50; // backward compatible
     elements.minWithdrawAmount.textContent = minW;
     elements.withdrawModalBalance.textContent = `NPR.${wc.toFixed(2)}`;
     elements.withdrawAmountInput.value = '';
     elements.withdrawAmountInput.min = minW; // Set min attribute
     elements.withdrawMethodInput.value = userProfile.upiId || ''; // Pre-fill if available
     clearStatusMessage(elements.withdrawStatusMessage);
     elements.withdrawModalInstance.show();
 }

 async function submitWithdrawRequestHandler() {
     if (!currentUser || !elements.withdrawModalInstance) return;
     const amt = parseFloat(elements.withdrawAmountInput.value);
    const mtd = elements.withdrawMethodInput.value.trim();
    const selectedMethod = (document.querySelector('input[name="withdrawMethod"]:checked')?.value) || 'Method';
     const wc = userProfile.winningCash || 0;
    const rules = appSettings?.withdrawalRules || {};
    const minW = (rules.minPerRequest ?? (appSettings?.minWithdraw)) || 50;
    const maxW = rules.maxPerRequest || Infinity;
    const dailyMax = rules.dailyMaxAmount || Infinity;
     clearStatusMessage(elements.withdrawStatusMessage);
     if (isNaN(amt) || amt <= 0) { showStatusMessage(elements.withdrawStatusMessage, 'Invalid amount.', 'warning'); return; }
    if (amt < minW) { showStatusMessage(elements.withdrawStatusMessage, `Min withdraw is NPR.${minW}.`, 'warning'); return; }
    if (amt > maxW && isFinite(maxW)) { showStatusMessage(elements.withdrawStatusMessage, `Max per request is NPR.${maxW}.`, 'warning'); return; }
    // Note: dailyMax enforcement ideally needs server-side aggregation; basic client hint only
     if (amt > wc) { showStatusMessage(elements.withdrawStatusMessage, 'Withdrawal amount exceeds winning balance.', 'warning'); return; }
     if (!mtd) { showStatusMessage(elements.withdrawStatusMessage, 'Withdrawal method details required.', 'warning'); return; }
     const btn = elements.submitWithdrawRequestBtn;
     btn.disabled = true; btn.innerHTML = '<span class="spinner-border spinner-border-sm"></span>';
    
    try {
        // Create withdrawal request data
        const reqData = { 
            userId: currentUser.uid, 
            amount: amt, 
            methodDetails: { methodName: selectedMethod, accountInfo: mtd }, 
            status: 'pending', 
            requestTimestamp: serverTimestamp(),
            debitedAt: serverTimestamp() // Mark when amount was deducted
        };
        
        // Prepare updates for both withdrawal request and user balance
        const updates = {};
        const withdrawalKey = push(ref(db, 'withdrawals')).key;
        updates[`withdrawals/${withdrawalKey}`] = reqData;
        
        // Immediately deduct from winning cash
        const newWinningCash = wc - amt;
        updates[`users/${currentUser.uid}/winningCash`] = newWinningCash;
        
        // Add transaction record for the deduction
        const txKey = push(ref(db, `transactions/${currentUser.uid}`)).key;
        updates[`transactions/${currentUser.uid}/${txKey}`] = {
            type: 'withdrawal_debit',
            amount: -amt,
            timestamp: serverTimestamp(),
            description: `Withdrawal request submitted - Amount debited from winning cash`,
            status: 'completed',
            balanceAfter: newWinningCash,
            withdrawalId: withdrawalKey
        };
        
        // Execute all updates atomically
        await update(ref(db), updates);
        
        // Update local user profile
        userProfile.winningCash = newWinningCash;
        
        // Update UI to reflect new balance
        if (elements.winningCashEl) {
            elements.winningCashEl.textContent = `NPR.${newWinningCash.toFixed(2)}`;
        }
        
        showStatusMessage(elements.withdrawStatusMessage, 'Withdrawal request submitted! Amount deducted from winning cash.', 'success');
        
        // Also update user profile with their saved QR ID for future convenience
        await update(ref(db, `users/${currentUser.uid}`), { upiId: mtd });
        userProfile.upiId = mtd;
        
        setTimeout(() => elements.withdrawModalInstance.hide(), 2000);
    } catch (e) {
        console.error("Withdrawal request failed:", e);
        showStatusMessage(elements.withdrawStatusMessage, `Error: ${e.message}`, 'danger');
    } finally {
        btn.disabled = false; btn.innerHTML = 'Submit Request';
    }
 }

 // --- Deposit Functions ---
 function handleProceedToPayment() {
     if (!currentUser) return;
     const amount = parseFloat(elements.depositAmountInput.value);
     if (isNaN(amount) || amount <= 0) {
         showStatusMessage(elements.depositStatusMessage, 'Please enter a valid amount.', 'warning');
         return;
     }
     
     // Update payment amount display
     elements.paymentAmountEl.textContent = amount;
     
     // Update QR ID from settings
     const upiId = appSettings?.upiDetails || '[!!! YOUR QR ID/NUMBER HERE !!!]';
     elements.upiIdDisplay.value = upiId;
     
     // Show step 2
     elements.depositStep1.style.display = 'none';
     elements.depositStep2.style.display = 'block';
     elements.depositStep3.style.display = 'none';
 }

 function handlePaymentDone() {
     // Show step 3 (upload screenshot)
     elements.depositStep2.style.display = 'none';
     elements.depositStep3.style.display = 'block';
 }

 function handleCopyUpiId() {
     const upiId = elements.upiIdDisplay.value;
     if (navigator.clipboard) {
         navigator.clipboard.writeText(upiId).then(() => {
             // Show success feedback
             const btn = elements.copyUpiIdBtn;
             const originalHTML = btn.innerHTML;
             btn.innerHTML = '<i class="bi bi-check"></i>';
             btn.classList.remove('btn-outline-warning');
             btn.classList.add('btn-success');
             
             setTimeout(() => {
                 btn.innerHTML = originalHTML;
                 btn.classList.remove('btn-success');
                 btn.classList.add('btn-outline-warning');
             }, 2000);
         }).catch(err => {
             console.error('Failed to copy QR ID:', err);
             alert('Failed to copy QR ID. Please copy manually.');
         });
     } else {
         // Fallback for older browsers
         elements.upiIdDisplay.select();
         document.execCommand('copy');
         
         // Show success feedback
         const btn = elements.copyUpiIdBtn;
         const originalHTML = btn.innerHTML;
         btn.innerHTML = '<i class="bi bi-check"></i>';
         btn.classList.remove('btn-outline-warning');
         btn.classList.add('btn-success');
         
         setTimeout(() => {
             btn.innerHTML = originalHTML;
             btn.classList.remove('btn-success');
             btn.classList.add('btn-outline-warning');
         }, 2000);
     }
 }

 function handleBackToStep1() {
     elements.depositStep1.style.display = 'block';
     elements.depositStep2.style.display = 'none';
     elements.depositStep3.style.display = 'none';
     clearStatusMessage(elements.depositStatusMessage);
 }

 function handleScreenshotUpload(event) {
     const file = event.target.files[0];
     if (!file) return;
     
     if (!file.type.startsWith('image/')) {
         showStatusMessage(elements.depositStatusMessage, 'Please select an image file.', 'warning');
         return;
     }
     
     if (file.size > 5 * 1024 * 1024) { // 5MB limit
         showStatusMessage(elements.depositStatusMessage, 'Image size should be less than 5MB.', 'warning');
         return;
     }
     
     // Show preview
     const reader = new FileReader();
     reader.onload = function(e) {
         elements.screenshotPreviewImg.src = e.target.result;
         elements.screenshotPreviewEl.style.display = 'block';
     };
     reader.readAsDataURL(file);
     
     clearStatusMessage(elements.depositStatusMessage);
 }

 function handleBackToStep2() {
     elements.depositStep2.style.display = 'block';
     elements.depositStep3.style.display = 'none';
     elements.screenshotPreviewEl.style.display = 'none';
     elements.paymentScreenshotInput.value = '';
     clearStatusMessage(elements.depositStatusMessage);
 }

 async function handleSubmitDeposit() {
     if (!currentUser || !elements.paymentScreenshotInput.files[0]) {
         showStatusMessage(elements.depositStatusMessage, 'Please upload a payment screenshot.', 'warning');
         return;
     }
     
     const amount = parseFloat(elements.depositAmountInput.value);
     const file = elements.paymentScreenshotInput.files[0];
     
     if (isNaN(amount) || amount <= 0) {
         showStatusMessage(elements.depositStatusMessage, 'Invalid amount.', 'warning');
         return;
     }
     
     const btn = elements.submitDepositBtn;
     btn.disabled = true;
     btn.innerHTML = '<span class="spinner-border spinner-border-sm"></span> Uploading...';
     
     try {
         // Upload image to ImgBB
         const formData = new FormData();
         formData.append('image', file);
         
         const response = await fetch(`https://api.imgbb.com/1/upload?key=${IMGBB_API_KEY}`, {
             method: 'POST',
             body: formData
         });
         
         if (!response.ok) {
             throw new Error('Failed to upload image');
         }
         
         const result = await response.json();
         const imageUrl = result.data.url;
         
         // Create deposit request
         const depositData = {
             userId: currentUser.uid,
             userEmail: currentUser.email,
             userName: userProfile.displayName || currentUser.email?.split('@')[0] || 'User',
             amount: amount,
             imageUrl: imageUrl,
             status: appSettings?.autoApproveDeposits ? 'approved' : 'pending',
             timestamp: serverTimestamp(),
             processedAt: appSettings?.autoApproveDeposits ? serverTimestamp() : null,
             adminRemarks: appSettings?.autoApproveDeposits ? 'Auto-approved' : '',
             adminUid: appSettings?.autoApproveDeposits ? 'system' : null
         };
         
         console.log('Submitting deposit:', depositData);
         
         // Save to Firebase
         const depositRef = await push(ref(db, 'deposits'), depositData);
         console.log('Deposit saved with ID:', depositRef.key);
         
         // If auto-approve is enabled, credit the user immediately
         if (appSettings?.autoApproveDeposits) {
             await updateUserBalance(currentUser.uid, amount, 'deposit_approved');
             showStatusMessage(elements.depositStatusMessage, 'Deposit approved automatically! Amount credited to your wallet.', 'success');
         } else {
             showStatusMessage(elements.depositStatusMessage, 'Deposit request submitted! Admin will review and approve.', 'success');
         }
         
         // Reset modal
         setTimeout(() => {
             elements.addAmountModalInstance.hide();
             resetDepositModal();
         }, 2000);
         
     } catch (error) {
         console.error('Deposit submission failed:', error);
         showStatusMessage(elements.depositStatusMessage, `Error: ${error.message}`, 'danger');
     } finally {
         btn.disabled = false;
         btn.innerHTML = '<i class="bi bi-upload me-2"></i>Submit Deposit Request';
     }
 }

 function resetDepositModal() {
     elements.depositStep1.style.display = 'block';
     elements.depositStep2.style.display = 'none';
     elements.depositStep3.style.display = 'none';
     elements.depositAmountInput.value = '';
     elements.paymentScreenshotInput.value = '';
     elements.screenshotPreviewEl.style.display = 'none';
     elements.upiIdDisplay.value = '[!!! YOUR QR ID/NUMBER HERE !!!]';
     clearStatusMessage(elements.depositStatusMessage);
 }

 async function updateUserBalance(userId, amount, transactionType) {
     if (!db) return;
     
     try {
         const userRef = ref(db, `users/${userId}`);
         const userSnapshot = await get(userRef);
         
         if (!userSnapshot.exists()) {
             throw new Error('User not found');
         }
         
         const user = userSnapshot.val();
         const currentBalance = Number(user.balance || 0);
         const newBalance = currentBalance + amount;
         
         // Update user balance
         await update(userRef, { balance: newBalance });
         
         // Record transaction
         const txData = {
             type: transactionType,
             amount: amount,
             timestamp: serverTimestamp(),
             description: `Deposit: NPR.${amount.toFixed(2)}`,
             status: 'completed',
             balanceAfter: newBalance
         };
         
         await push(ref(db, `transactions/${userId}`), txData);
         
         // Update local user profile if current user
         if (currentUser && currentUser.uid === userId) {
             userProfile.balance = newBalance;
             populateUserInfo(currentUser, userProfile);
         }
         
     } catch (error) {
         console.error('Error updating user balance:', error);
         throw error;
     }
 }

 // *** MODIFIED: Function to open the In-Game Name modal ***
 async function openInGameNameModal(tournamentId, tournamentName, fee) {
     console.log("Opening modal for tournament:", tournamentId, tournamentName, fee);
     
     if (!elements.inGameNameModalInstance) {
         console.error("Modal instance not found");
         console.log("Modal element:", getElement('inGameNameModalEl'));
         console.log("Bootstrap available:", typeof bootstrap !== 'undefined');
         return;
     }
     
     if (!currentUser) {
         console.error("User not logged in");
         return;
     }
     
     elements.inGameNameForm.reset();
     clearStatusMessage(elements.inGameNameStatusMessage);
     
     elements.inGameNameTournamentIdInput.value = tournamentId;
     elements.saveInGameNameBtn.dataset.fee = fee;

     // Get tournament details to determine mode
     try {
         const tournamentRef = ref(db, `tournaments/${tournamentId}`);
         const tournamentSnap = await get(tournamentRef);
         
         if (!tournamentSnap.exists()) {
             showStatusMessage(elements.inGameNameStatusMessage, 'Tournament not found.', 'danger');
             return;
         }
         
         const tournament = tournamentSnap.val();
         const mode = tournament.mode || 'solo';
         
         // Store mode for later use
         if (elements.tournamentModeInput) {
             elements.tournamentModeInput.value = mode;
         }
         
         // Show/hide appropriate fields based on mode
         document.getElementById('soloFields').style.display = mode === 'solo' ? 'block' : 'none';
         document.getElementById('duoFields').style.display = mode === 'duo' ? 'block' : 'none';
         document.getElementById('squadFields').style.display = mode === 'squad' ? 'block' : 'none';
         
         // Pre-fill solo fields
         if (elements.inGameNameInput) {
             elements.inGameNameInput.value = userProfile.inGameName || '';
         }
         if (elements.inGameUidInput) {
             elements.inGameUidInput.value = userProfile.inGameUid || '';
         }
         
         // Pre-fill team fields with user's info
         if (mode === 'duo') {
             const duoPlayer1NameEl = document.getElementById('duoPlayer1NameInputEl');
             const duoPlayer1UidEl = document.getElementById('duoPlayer1UidInputEl');
             if (duoPlayer1NameEl) duoPlayer1NameEl.value = userProfile.inGameName || '';
             if (duoPlayer1UidEl) duoPlayer1UidEl.value = userProfile.inGameUid || '';
         } else if (mode === 'squad') {
             const squadPlayer1NameEl = document.getElementById('squadPlayer1NameInputEl');
             const squadPlayer1UidEl = document.getElementById('squadPlayer1UidInputEl');
             if (squadPlayer1NameEl) squadPlayer1NameEl.value = userProfile.inGameName || '';
             if (squadPlayer1UidEl) squadPlayer1UidEl.value = userProfile.inGameUid || '';
         }
         
         elements.inGameNameModalTitleEl.textContent = `Join: ${tournamentName}`;
         elements.inGameNameModalDescriptionEl.textContent = `Please confirm your team details for this ${mode} tournament. An entry fee of NPR.${fee.toFixed(2)} will be deducted from your balance.`;
         
         console.log("Showing modal...");
         elements.inGameNameModalInstance.show();
         console.log("Modal shown successfully");
         
     } catch (error) {
         console.error('Error loading tournament details:', error);
         showStatusMessage(elements.inGameNameStatusMessage, 'Error loading tournament details.', 'danger');
     }
 }

 // *** MODIFIED: This function now handles the entire join process with team support ***
 async function joinTournamentAndSaveDetails() {
    if (!currentUser) return;

    const btn = elements.saveInGameNameBtn;
    const tournamentId = elements.inGameNameTournamentIdInput.value;
    const fee = parseFloat(btn.dataset.fee || 0);
    const mode = elements.tournamentModeInput.value || 'solo';

    // Validate based on mode
    let teamData = {};
    
    if (mode === 'solo') {
        const ign = elements.inGameNameInput.value.trim();
        const igUid = elements.inGameUidInput.value.trim();
        
        if (!tournamentId || !ign || !igUid) {
            showStatusMessage(elements.inGameNameStatusMessage, 'All fields are required.', 'warning');
            return;
        }
        
        teamData = {
            player1: { name: ign, uid: igUid }
        };
    } else if (mode === 'duo') {
        const p1Name = document.getElementById('duoPlayer1NameInputEl').value.trim();
        const p1Uid = document.getElementById('duoPlayer1UidInputEl').value.trim();
        const p2Name = document.getElementById('duoPlayer2NameInputEl').value.trim();
        const p2Uid = document.getElementById('duoPlayer2UidInputEl').value.trim();
        
        if (!tournamentId || !p1Name || !p1Uid || !p2Name || !p2Uid) {
            showStatusMessage(elements.inGameNameStatusMessage, 'All team member details are required.', 'warning');
            return;
        }
        
        teamData = {
            player1: { name: p1Name, uid: p1Uid },
            player2: { name: p2Name, uid: p2Uid }
        };
    } else if (mode === 'squad') {
        const p1Name = document.getElementById('squadPlayer1NameInputEl').value.trim();
        const p1Uid = document.getElementById('squadPlayer1UidInputEl').value.trim();
        const p2Name = document.getElementById('squadPlayer2NameInputEl').value.trim();
        const p2Uid = document.getElementById('squadPlayer2UidInputEl').value.trim();
        const p3Name = document.getElementById('squadPlayer3NameInputEl').value.trim();
        const p3Uid = document.getElementById('squadPlayer3UidInputEl').value.trim();
        const p4Name = document.getElementById('squadPlayer4NameInputEl').value.trim();
        const p4Uid = document.getElementById('squadPlayer4UidInputEl').value.trim();
        
        if (!tournamentId || !p1Name || !p1Uid || !p2Name || !p2Uid || !p3Name || !p3Uid || !p4Name || !p4Uid) {
            showStatusMessage(elements.inGameNameStatusMessage, 'All team member details are required.', 'warning');
            return;
        }
        
        teamData = {
            player1: { name: p1Name, uid: p1Uid },
            player2: { name: p2Name, uid: p2Uid },
            player3: { name: p3Name, uid: p3Uid },
            player4: { name: p4Name, uid: p4Uid }
        };
    }

    btn.disabled = true;
    btn.innerHTML = '<span class="spinner-border spinner-border-sm"></span> Joining...';

    const uRef = ref(db, `users/${currentUser.uid}`);
    const tRef = ref(db, `tournaments/${tournamentId}`);
    let tData = null;
    let transactionResult = null;
   
    try {
       // ========== CORRECTED PAYMENT LOGIC STARTS HERE ==========
transactionResult = await runTransaction(uRef, (profileData) => {
    if (!profileData) {
        throw new Error("User profile not found.");
    }

    const totalBalance = (profileData.balance || 0) + (profileData.winningCash || 0);
    if (totalBalance < fee) {
        throw new Error("Insufficient balance. Add funds to join.");
    }

    if (profileData.joinedTournaments?.[tournamentId]) {
        // Already joined, abort transaction.
        return;
    }

    // Prioritize deducting from deposit balance first, then winning balance.
    let feeRemaining = fee;
    let depositBalance = profileData.balance || 0;
    let winningBalance = profileData.winningCash || 0;

    const fromDeposit = Math.min(depositBalance, feeRemaining);
    depositBalance -= fromDeposit;
    feeRemaining -= fromDeposit;

    const fromWinning = Math.min(winningBalance, feeRemaining);
    winningBalance -= fromWinning;
    feeRemaining -= fromWinning;
    
    // This should be 0 if logic is correct and initial check passed
    if (feeRemaining > 0) {
        // This case should not be reached, but it's a good safeguard.
        throw new Error("Calculation error, balance check failed.");
    }

    // Update profile data within the transaction
    profileData.balance = depositBalance;
    profileData.winningCash = winningBalance;

    if (!profileData.joinedTournaments) {
        profileData.joinedTournaments = {};
    }
    profileData.joinedTournaments[tournamentId] = true;

    return profileData;
});
// ========== CORRECTED PAYMENT LOGIC ENDS HERE ==========

        if (!transactionResult.committed) {
            const freshProfileSnap = await get(uRef);
            if(freshProfileSnap.val()?.joinedTournaments?.[tournamentId]) {
                 throw new Error("You have already joined this tournament.");
            } else {
                 throw new Error("Could not process payment. Please check your balance and try again.");
            }
        }

        const snapshot = await get(tRef);
        if (!snapshot.exists()) throw new Error("Tournament not found.");
        tData = snapshot.val();

        const updates = {};
        const registrationData = {
            joinedAt: serverTimestamp(),
            mode: mode,
            teamData: teamData,
            // For backward compatibility, also store solo player data
            inGameName: teamData.player1.name,
            inGameUid: teamData.player1.uid
        };
        
        updates[`tournaments/${tournamentId}/registeredPlayers/${currentUser.uid}`] = registrationData;
        updates[`users/${currentUser.uid}/inGameName`] = teamData.player1.name;
        updates[`users/${currentUser.uid}/inGameUid`] = teamData.player1.uid;

        await update(ref(db), updates);
        
        const userRefForStats = ref(db, `users/${currentUser.uid}`);
        await runTransaction(userRefForStats, (profileData) => {
            if (profileData) {
                profileData.tournamentsJoined = (profileData.tournamentsJoined || 0) + 1;
                profileData.entryFeesPaid = (profileData.entryFeesPaid || 0) + fee;
                return profileData;
            }
            return profileData;
        });

        await recordTransaction(currentUser.uid, 'tournament_join', -fee, `Joined: ${tData.name || 'Tournament'}`, { tournamentId: tournamentId });
       
        userProfile.inGameName = teamData.player1.name;
        userProfile.inGameUid = teamData.player1.uid;

        showStatusMessage(elements.inGameNameStatusMessage, 'Joined successfully!', 'success');

        setTimeout(() => {
            elements.inGameNameModalInstance.hide();
            if (currentSectionId === 'tournaments-section' && currentTournamentGameId) filterTournaments(currentTournamentGameId, 'upcoming');
            if (currentSectionId === 'home-section') loadMyContests();
            if (currentSectionId === 'wallet-section') loadRecentTransactions();
        }, 1500);

    } catch (e) {
        console.error("Join failed:", e);
        showStatusMessage(elements.inGameNameStatusMessage, `Error: ${e.message}`, 'danger', false);
        // Refund logic (important if payment was taken but registration failed)
        if (e.message !== "Insufficient balance. Add funds to join." && e.message !== "User profile not found." && e.message !== "You have already joined this tournament." && transactionResult?.committed) {
             console.error("CRITICAL: Payment taken but registration failed! Refunding.");
             showStatusMessage(elements.inGameNameStatusMessage, `An error occurred. Your entry fee will be refunded.`, 'danger', false);
             try {
                const refundTx = await runTransaction(uRef, (p) => {
                    if (p) {
                        p.balance = (p.balance || 0) + fee; // Simple refund to deposit balance
                        if (p.joinedTournaments?.[tournamentId]) {
                            delete p.joinedTournaments[tournamentId];
                        }
                    }
                    return p;
                });
                if(refundTx.committed) {
                     await recordTransaction(currentUser.uid, 'join_failed_refund', fee, `Refund for Failed Join: ${tData?.name || 'Tournament'}`);
                     showStatusMessage(elements.inGameNameStatusMessage, `An error occurred. Your entry fee has been refunded.`, 'warning', false);
                } else {
                    throw new Error("CRITICAL: REFUND FAILED.");
                }
             } catch (refundError) {
                 console.error("CRITICAL: FAILED TO REFUND!", refundError);
                 showStatusMessage(elements.inGameNameStatusMessage, `CRITICAL ERROR! Please contact support immediately regarding a failed tournament join.`, 'danger', false);
             }
        }

    } finally {
        btn.disabled = false;
        btn.innerHTML = 'Confirm & Join';
    }
}

 async function handleMatchDetailsClick(event) {
    console.log("Match Details Clicked");
     if (!elements.matchDetailsModalInstance) return; const tId = event.currentTarget.dataset.tournamentId; if (!tId) return;
     elements.matchDetailsModalTitle.textContent = 'Loading...'; elements.matchDetailsModalBody.innerHTML = '<div class="tc p-5"><div class="spinner-border spinner-border-sm"></div></div>';
     elements.matchDetailsModalInstance.show();
     try {
         const tRef = ref(db, `tournaments/${tId}`);
         const s = await get(tRef);
         if (s.exists()) {
             const t = s.val();
             const gName = appSettings.games?.[t.gameId]?.name || t.gameId || 'N/A';
             const sTimeLoc = t.startTime ? new Date(t.startTime).toLocaleString([], { dateStyle: 'medium', timeStyle: 'short'}) : 'TBA';
             let pDistHTML = '';
             if (t.prizeDistribution) {
                 // Try to format nicely, fallback to JSON string
                 let fmtDist = '';
                 if (typeof t.prizeDistribution === 'object') {
                     fmtDist = Object.entries(t.prizeDistribution)
                                  .map(([rank, prize]) => `Rank ${rank}: NPR.${prize}`)
                                  .join('\n');
                 } else {
                     fmtDist = String(t.prizeDistribution).replace(/\\n/g, '\n');
                 }
                 pDistHTML = `<h5>Prize Distribution:</h5><pre>${fmtDist}</pre>`;
             }
             const desc = t.description || 'Standard rules apply.';
             const fmtDesc = desc.replace(/\n/g, '<br>'); // Handle newlines in description
             elements.matchDetailsModalTitle.textContent = t.name || 'Match Details';
             const registeredCount = t.registeredPlayers ? Object.keys(t.registeredPlayers).length : 0;
             elements.matchDetailsModalBody.innerHTML = `
                 <div class="tournament-details-container">
                     <!-- Tournament Header -->
                     <div class="tournament-header mb-4">
                         <div class="tournament-icon">
                             <i class="bi bi-trophy-fill text-warning"></i>
                         </div>
                         <div class="tournament-meta">
                             <div class="tournament-status ${t.status === 'upcoming' ? 'status-upcoming' : t.status === 'ongoing' ? 'status-ongoing' : 'status-completed'}">
                                 ${t.status === 'upcoming' ? '<i class="bi bi-clock"></i> Upcoming' : t.status === 'ongoing' ? '<i class="bi bi-broadcast"></i> Live' : '<i class="bi bi-check-circle"></i> Completed'}
                             </div>
                             <div class="tournament-participants">
                                 <i class="bi bi-people"></i> ${registeredCount} / ${t.maxPlayers > 0 ? t.maxPlayers : ''} Players
                             </div>
                         </div>
                     </div>

                     <!-- Tournament Info Grid -->
                     <div class="tournament-info-grid mb-4">
                         <div class="info-card">
                             <div class="info-icon"><i class="bi bi-joystick"></i></div>
                             <div class="info-content">
                                 <div class="info-label">Game</div>
                                 <div class="info-value">${gName}</div>
                             </div>
                         </div>
                         <div class="info-card">
                             <div class="info-icon"><i class="bi bi-people-fill"></i></div>
                             <div class="info-content">
                                 <div class="info-label">Mode</div>
                                 <div class="info-value">${t.mode || 'N/A'}</div>
                             </div>
                         </div>
                         <div class="info-card">
                             <div class="info-icon"><i class="bi bi-geo-alt"></i></div>
                             <div class="info-content">
                                 <div class="info-label">Map</div>
                                 <div class="info-value">${t.map || 'N/A'}</div>
                             </div>
                         </div>
                         <div class="info-card">
                             <div class="info-icon"><i class="bi bi-calendar-event"></i></div>
                             <div class="info-content">
                                 <div class="info-label">Starts</div>
                                 <div class="info-value">${sTimeLoc}</div>
                             </div>
                         </div>
                     </div>

                     <!-- Prize Section -->
                     <div class="prize-section mb-4">
                         <h5 class="section-title"><i class="bi bi-gem"></i> Prize Pool</h5>
                         <div class="prize-grid">
                             <div class="prize-item">
                                 <div class="prize-icon"><i class="bi bi-trophy-fill"></i></div>
                                 <div class="prize-content">
                                     <div class="prize-label">Total Prize</div>
                                     <div class="prize-value">NPR.${t.prizePool || 0}</div>
                                 </div>
                             </div>
                             <div class="prize-item">
                                 <div class="prize-icon"><i class="bi bi-crosshair"></i></div>
                                 <div class="prize-content">
                                     <div class="prize-label">Per Kill</div>
                                     <div class="prize-value">NPR.${t.perKillPrize || 0}</div>
                                 </div>
                             </div>
                             <div class="prize-item">
                                 <div class="prize-icon"><i class="bi bi-currency-rupee"></i></div>
                                 <div class="prize-content">
                                     <div class="prize-label">Entry Fee</div>
                                     <div class="prize-value ${t.entryFee > 0 ? 'text-info' : 'text-success'}">${t.entryFee > 0 ? `NPR.${t.entryFee}` : 'Free'}</div>
                                 </div>
                             </div>
                         </div>
                     </div>

                     <!-- Prize Pool Section -->
                     <div class="prize-pool-section">
                         <h5 class="section-title"><i class="bi bi-award"></i> Prize Pool</h5>
                         <div class="prize-pool-content">
                             <div class="prize-pool-main">
                                 <div class="prize-pool-amount">
                                     <span class="prize-amount">NPR.${t.prizePool}</span>
                                     <span class="prize-label">Total Prize Pool</span>
                                 </div>
                                 ${t.prizeDescription ? `
                                 <div class="prize-description">
                                     <h6 class="prize-subtitle">Prize Distribution</h6>
                                     <div class="prize-description-content">
                                         ${t.prizeDescription.replace(/\n/g, '<br>')}
                                     </div>
                                 </div>
                                 ` : ''}
                             </div>
                             ${pDistHTML ? `
                             <div class="prize-breakdown-details">
                                 <h6 class="prize-subtitle">Detailed Breakdown</h6>
                                 <div class="prize-breakdown-content">
                                     ${pDistHTML.replace('<h5>Prize Distribution:</h5>', '').replace('<pre>', '<div class="prize-breakdown">').replace('</pre>', '</div>')}
                                 </div>
                             </div>
                             ` : ''}
                         </div>
                     </div>

                     <!-- Rules Section -->
                     <div class="rules-section">
                         <h5 class="section-title"><i class="bi bi-shield-check"></i> Tournament Rules</h5>
                         <div class="rules-content">
                             ${fmtDesc}
                         </div>
                     </div>
                 </div>
             `;
         } else elements.matchDetailsModalBody.innerHTML = '<p class="text-danger">Details not found.</p>';
     } catch (e) { console.error("Details load failed:", e); elements.matchDetailsModalBody.innerHTML = '<p class="text-danger">Error loading details.</p>'; }
 }

 // Make functions globally accessible
window.showRegisteredPlayers = async function(tournamentId, tournamentName) {
     console.log("Showing registered players for tournament:", tournamentId);
     
     try {
     // Remove existing modal if any
     const existingModal = document.getElementById('registeredPlayersModal');
     if (existingModal) {
         const existingBootstrapModal = bootstrap.Modal.getInstance(existingModal);
         if (existingBootstrapModal) {
             existingBootstrapModal.dispose();
         }
         existingModal.remove();
     }
     
     // Create a simple modal to show registered players
     const modalHtml = `
         <div class="modal fade" id="registeredPlayersModal" tabindex="-1" aria-labelledby="registeredPlayersModalLabel" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
             <div class="modal-dialog modal-lg">
                     <div class="modal-content" style="background-color: var(--card-bg); color: var(--text-primary); border: 1px solid var(--border-color);">
                         <div class="modal-header" style="border-bottom-color: var(--border-color);">
                             <h5 class="modal-title" id="registeredPlayersModalLabel" style="color: var(--text-primary);">Registered Players - ${sanitizeHTML(tournamentName)}</h5>
                             <button type="button" class="btn-close btn-close-white" onclick="closeRegisteredPlayersModal()" aria-label="Close" style="cursor: pointer; z-index: 10000;"></button>
                     </div>
                         <div class="modal-body" style="color: var(--text-primary);">
                         <div id="registeredPlayersList" class="text-center">
                             <div class="spinner-border spinner-border-sm text-primary"></div>
                                 <p class="mt-2" style="color: var(--text-primary);">Loading players...</p>
                         </div>
                     </div>
                         <div class="modal-footer" style="border-top-color: var(--border-color);">
                         <button type="button" class="btn btn-secondary" onclick="closeRegisteredPlayersModal()" style="cursor: pointer;">Close</button>
                     </div>
                 </div>
             </div>
         </div>
     `;
     
     // Add new modal to body
     document.body.insertAdjacentHTML('beforeend', modalHtml);
         
         // Wait a bit for the DOM to be updated
         await new Promise(resolve => setTimeout(resolve, 10));
     
     // Get the modal element and show it
     const modalElement = document.getElementById('registeredPlayersModal');
         if (!modalElement) {
             throw new Error('Modal element not found after creation');
         }
         
         // Check if Bootstrap is available
         if (typeof bootstrap === 'undefined' || !bootstrap.Modal) {
             throw new Error('Bootstrap Modal is not available');
         }
         
         const modal = new bootstrap.Modal(modalElement, {
             backdrop: true,
             keyboard: true,
             focus: true
         });
         
         // Show modal with error handling
     modal.show();
         
         console.log('Modal show() called');
         
         // Ensure modal is visible and properly positioned
         setTimeout(() => {
             const modalElement = document.getElementById('registeredPlayersModal');
             console.log('Modal element found:', !!modalElement);
             if (modalElement) {
                 console.log('Modal display style:', modalElement.style.display);
                 console.log('Modal classes:', modalElement.className);
                 
                 modalElement.style.display = 'block';
                 modalElement.style.zIndex = '9999';
                 modalElement.classList.add('show');
                 
                 // Force backdrop
                 const backdrop = document.querySelector('.modal-backdrop');
                 console.log('Backdrop found:', !!backdrop);
                 if (backdrop) {
                     backdrop.style.zIndex = '9998';
                     // Add click handler to backdrop
                     backdrop.addEventListener('click', function() {
                         closeRegisteredPlayersModal();
                     });
                 }
                 
                 console.log('Modal should now be visible');
             }
         }, 100);
     
              // Load players data after modal is shown
     setTimeout(() => {
         loadRegisteredPlayersData(tournamentId);
     }, 100);
     
     // Add keyboard event listener for Escape key
     document.addEventListener('keydown', function(event) {
         if (event.key === 'Escape') {
             closeRegisteredPlayersModal();
         }
     });
         
         // Fallback: If modal doesn't show after 1 second, create a simple popup
         setTimeout(() => {
             const modalElement = document.getElementById('registeredPlayersModal');
             console.log('Checking modal visibility...');
             console.log('Modal element exists:', !!modalElement);
             if (modalElement) {
                 console.log('Modal display style:', modalElement.style.display);
                 console.log('Modal visibility:', modalElement.style.visibility);
                 console.log('Modal z-index:', modalElement.style.zIndex);
             }
             
             if (!modalElement || modalElement.style.display !== 'block') {
                 console.log('Modal not visible, creating fallback popup');
                 
                 // Create a simple popup
                 const popup = document.createElement('div');
                 popup.style.cssText = `
                     position: fixed;
                     top: 50%;
                     left: 50%;
                     transform: translate(-50%, -50%);
                     background: var(--card-bg);
                     border: 1px solid var(--border-color);
                     border-radius: 8px;
                     padding: 20px;
                     z-index: 10000;
                     max-width: 90vw;
                     max-height: 80vh;
                     overflow-y: auto;
                     color: var(--text-primary);
                 `;
                 
                 popup.innerHTML = `
                     <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                         <h5 style="margin: 0;">Registered Players - ${sanitizeHTML(tournamentName)}</h5>
                         <button onclick="this.parentElement.parentElement.remove()" style="background: none; border: none; color: var(--text-primary); font-size: 20px; cursor: pointer;"></button>
                     </div>
                     <div id="fallbackPlayersList">
                         <div class="text-center">
                             <div class="spinner-border spinner-border-sm text-primary"></div>
                             <p class="mt-2">Loading players...</p>
                         </div>
                     </div>
                 `;
                 
                 document.body.appendChild(popup);
                 
                 // Load data in fallback
                 setTimeout(() => {
                     loadRegisteredPlayersData(tournamentId);
                 }, 100);
             }
         }, 1000);
         
         // Additional fallback: Force show after 2 seconds if still not visible
         setTimeout(() => {
             const modalElement = document.getElementById('registeredPlayersModal');
             const fallbackElement = document.getElementById('fallbackPlayersList');
             
             if (!modalElement && !fallbackElement) {
                 console.log('No modal or fallback found, creating emergency popup');
                 
                 // Create emergency popup
                 const emergencyPopup = document.createElement('div');
                 emergencyPopup.style.cssText = `
                     position: fixed !important;
                     top: 50% !important;
                     left: 50% !important;
                     transform: translate(-50%, -50%) !important;
                     background: #1a202c !important;
                     border: 2px solid #58a6ff !important;
                     border-radius: 12px !important;
                     padding: 30px !important;
                     z-index: 99999 !important;
                     max-width: 80vw !important;
                     max-height: 80vh !important;
                     overflow-y: auto !important;
                     color: #c9d1d9 !important;
                     box-shadow: 0 10px 30px rgba(0,0,0,0.8) !important;
                 `;
                 
                 emergencyPopup.innerHTML = `
                     <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                         <h3 style="margin: 0; color: #58a6ff;">Registered Players - ${sanitizeHTML(tournamentName)}</h3>
                         <button onclick="this.parentElement.parentElement.remove()" style="background: none; border: none; color: #c9d1d9; font-size: 24px; cursor: pointer;"></button>
                     </div>
                     <div id="emergencyPlayersList">
                         <div style="text-align: center; color: #58a6ff;">
                             <div style="display: inline-block; width: 20px; height: 20px; border: 2px solid #58a6ff; border-top: 2px solid transparent; border-radius: 50%; animation: spin 1s linear infinite;"></div>
                             <p style="margin-top: 10px;">Loading players...</p>
                         </div>
                     </div>
                     <style>
                         @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
                     </style>
                 `;
                 
                 document.body.appendChild(emergencyPopup);
                 
                 // Load data in emergency popup
                 setTimeout(() => {
                     const emergencyList = document.getElementById('emergencyPlayersList');
                     if (emergencyList) {
                         loadRegisteredPlayersData(tournamentId);
                     }
                 }, 100);
             }
         }, 2000);
         
     } catch (error) {
         console.error('Error showing registered players modal:', error);
         
         // Fallback: Show data in a simple alert or console
         try {
             console.log('Attempting fallback display...');
             const playersData = await loadRegisteredPlayersData(tournamentId);
             if (playersData && playersData.length > 0) {
                 const playerNames = playersData.map(p => p.displayName || 'Unknown').join(', ');
                 alert(`Registered Players for ${tournamentName}:\n${playerNames}`);
             } else {
                 alert(`No players registered for ${tournamentName}`);
             }
         } catch (fallbackError) {
             console.error('Fallback also failed:', fallbackError);
             alert('Error showing registered players. Please try again.');
         }
     }
 }

 // Make functions globally accessible
window.closeRegisteredPlayersModal = function() {
    try {
        console.log('Attempting to close modal...');
        
        const modalElement = document.getElementById('registeredPlayersModal');
        if (modalElement) {
            console.log('Modal element found, attempting to close...');
            
            // Try Bootstrap modal first
            if (typeof bootstrap !== 'undefined' && bootstrap.Modal) {
                const modal = bootstrap.Modal.getInstance(modalElement);
                if (modal) {
                    console.log('Using existing Bootstrap modal instance');
                    modal.hide();
                } else {
                    console.log('Creating new Bootstrap modal instance');
                    const newModal = new bootstrap.Modal(modalElement);
                    newModal.hide();
                }
            } else {
                console.log('Bootstrap not available, using manual close');
                // Fallback: manually hide modal
                modalElement.style.display = 'none';
                modalElement.classList.remove('show');
                
                // Remove backdrop
                const backdrop = document.querySelector('.modal-backdrop');
                if (backdrop) {
                    backdrop.remove();
                }
                
                // Remove modal from DOM
                modalElement.remove();
            }
        } else {
            console.log('Modal element not found');
        }
        
        // Also try to close any fallback popups
        const fallbackPopup = document.getElementById('fallbackPlayersPopup');
        if (fallbackPopup) {
            fallbackPopup.remove();
        }
        
        const emergencyPopup = document.getElementById('emergencyPlayersPopup');
        if (emergencyPopup) {
            emergencyPopup.remove();
        }
        
        // Remove any remaining modal-related elements
        const remainingModals = document.querySelectorAll('.modal-backdrop, [id*="registeredPlayers"]');
        remainingModals.forEach(el => {
            if (el.id !== 'registeredPlayersList') {
                el.remove();
            }
        });
        
        console.log('Modal closed successfully');
    } catch (error) {
        console.error('Error closing modal:', error);
        // Force remove modal element and all related elements
        const modalElement = document.getElementById('registeredPlayersModal');
        if (modalElement) {
            modalElement.remove();
        }
        
        // Remove all modal-related elements
        const allModalElements = document.querySelectorAll('.modal-backdrop, [id*="registeredPlayers"]');
        allModalElements.forEach(el => {
            if (el.id !== 'registeredPlayersList') {
                el.remove();
            }
        });
    }
};

window.loadRegisteredPlayersData = async function(tournamentId) {
     // Initialize usersData at function scope
     let usersData = [];
     
     try {
         console.log("Loading registered players for tournament:", tournamentId);
         
         // Get tournament details first
         const tournamentRef = ref(db, `tournaments/${tournamentId}`);
         const tournamentSnap = await get(tournamentRef);
         
         if (!tournamentSnap.exists()) {
             document.getElementById('registeredPlayersList').innerHTML = '<p class="text-danger">Tournament not found.</p>';
             return usersData;
         }
         
         const tournament = tournamentSnap.val();
         const mode = tournament.mode || 'solo';
         
         const playersRef = ref(db, `tournaments/${tournamentId}/registeredPlayers`);
         const snapshot = await get(playersRef);
         
         const playersList = document.getElementById('registeredPlayersList') || document.getElementById('fallbackPlayersList') || document.getElementById('emergencyPlayersList');
         if (!playersList) {
             console.error("Players list element not found");
             return usersData;
         }
         
         if (!snapshot.exists()) {
             playersList.innerHTML = '<p class="text-muted">No players registered yet.</p>';
             return usersData;
         }
         
         const registeredData = snapshot.val();
         const userIds = Object.keys(registeredData);
         
         console.log("Found registered players:", userIds.length);
         
         // Fetch user data for all players
         const userPromises = userIds.map(uid => {
             return get(ref(db, `users/${uid}`)).then(uSnap => {
                 if (uSnap.exists()) {
                     const u = uSnap.val(); u.uid = uid;
                     return u;
                 }
                 return { uid, displayName: 'Unknown', email: 'N/A' };
             });
         });
         
         const users = await Promise.all(userPromises);
         
         // Update usersData with the fetched data
         usersData = users.map(user => ({
             displayName: user.displayName || 'Unknown',
             email: user.email || 'N/A',
             uid: user.uid
         }));
         
         if (mode === 'solo') {
             // Solo mode - simple table
             let tableHtml = `
                 <div class="table-responsive">
                     <table class="table table-dark table-sm" style="color: var(--text-primary);">
                         <thead>
                             <tr>
                                 <th style="color: var(--text-primary);">Player Name</th>
                                 <th style="color: var(--text-primary);">In-Game Name</th>
                                 <th style="color: var(--text-primary);">In-Game UID</th>
                                 <th style="color: var(--text-primary);">Joined At</th>
                             </tr>
                         </thead>
                         <tbody>
             `;
             
             users.forEach(user => {
                 const playerData = registeredData[user.uid] || {};
                 const joinedAt = playerData.joinedAt ? new Date(playerData.joinedAt).toLocaleString([], { dateStyle: 'short', timeStyle: 'short' }) : 'N/A';
                 
                 tableHtml += `
                     <tr>
                         <td style="color: var(--text-primary);">${sanitizeHTML(user.displayName || 'Unknown')}</td>
                         <td style="color: var(--text-primary);">${sanitizeHTML(playerData.inGameName || 'N/A')}</td>
                         <td><small class="text-muted" style="color: var(--text-secondary);">${sanitizeHTML(playerData.inGameUid || 'N/A')}</small></td>
                         <td style="color: var(--text-primary);">${joinedAt}</td>
                     </tr>
                 `;
             });
             
             tableHtml += '</tbody></table></div>';
             playersList.innerHTML = tableHtml;
         } else {
             // Team mode - show teams
             let teamsHtml = '<div class="row" style="color: var(--text-primary);">';
             
             users.forEach((user, index) => {
                 const playerData = registeredData[user.uid] || {};
                 const teamData = playerData.teamData || {};
                 const joinedAt = playerData.joinedAt ? new Date(playerData.joinedAt).toLocaleString([], { dateStyle: 'short', timeStyle: 'short' }) : 'N/A';
                 
                 console.log(`User ${user.displayName} player data:`, playerData);
                 console.log(`User ${user.displayName} team data:`, teamData);
                 
                 const teamNumber = index + 1;
                 const teamColor = index % 2 === 0 ? 'primary' : 'success';
                 
                 teamsHtml += `
                     <div class="col-md-6 mb-3">
                         <div class="card bg-dark border-${teamColor}" style="background-color: var(--card-bg); color: var(--text-primary);">
                             <div class="card-header bg-${teamColor} text-white">
                                 <h6 class="mb-0" style="color: white;">Team ${teamNumber} - ${sanitizeHTML(user.displayName || 'Unknown')}</h6>
                             </div>
                             <div class="card-body" style="color: var(--text-primary);">
                                 <div class="row">
                 `;
                 
                                  // For duo matches, only show 2 players (not 4)
                 const isDuo = playerData.mode === 'duo' || tournament.mode === 'duo';
                 const maxPlayersPerTeam = isDuo ? 2 : 4; // 2 for duo, 4 for squad
                 const players = ['player1', 'player2', 'player3', 'player4'].slice(0, maxPlayersPerTeam);
                 
                 console.log('Team data for user', user.displayName, ':', teamData);
                 console.log('Is duo match:', isDuo);
                 console.log('Max players per team:', maxPlayersPerTeam);
                 
                 // Check if teamData is empty, if so, show the user's own data
                 const hasTeamData = teamData && Object.keys(teamData).length > 0;
                 console.log('Has team data:', hasTeamData);
                 
                 if (!hasTeamData) {
                     // Show user's own data as Player 1
                     const playerColor = 'primary';
                     const playerName = playerData.inGameName || user.displayName || 'Unknown';
                     const playerUid = playerData.inGameUid || 'N/A';
                     
                     console.log(`Showing user's own data - Name: ${playerName}, UID: ${playerUid}`);
                     
                     teamsHtml += `
                         <div class="col-12 mb-2">
                             <div class="d-flex justify-content-between align-items-center">
                                 <span class="badge bg-${playerColor}">Player 1</span>
                                 <small style="color: #ffffff !important; font-weight: 500;">${sanitizeHTML(playerName)}</small>
                                 <small style="color: #cccccc !important;">${sanitizeHTML(playerUid)}</small>
                             </div>
                         </div>
                     `;
                 } else {
                     // Show team data
                     players.forEach((playerKey, playerIndex) => {
                         const player = teamData[playerKey];
                         console.log(`Player ${playerIndex + 1} data:`, player);
                         
                         if (player) {
                             const playerColor = playerIndex === 0 ? 'primary' : playerIndex === 1 ? 'success' : playerIndex === 2 ? 'warning' : 'info';
                             
                             // Try multiple possible field names for player data
                             const playerName = player.name || player.inGameName || player.displayName || player.playerName || 'Unknown';
                             const playerUid = player.uid || player.inGameUid || player.playerUid || 'N/A';
                             
                             console.log(`Player ${playerIndex + 1} - Name: ${playerName}, UID: ${playerUid}`);
                             
                             teamsHtml += `
                                 <div class="col-12 mb-2">
                                     <div class="d-flex justify-content-between align-items-center">
                                         <span class="badge bg-${playerColor}">Player ${playerIndex + 1}</span>
                                         <small style="color: #ffffff !important; font-weight: 500;">${sanitizeHTML(playerName)}</small>
                                         <small style="color: #cccccc !important;">${sanitizeHTML(playerUid)}</small>
                                     </div>
                                 </div>
                             `;
                         } else {
                             // Show empty player slot
                             const playerColor = playerIndex === 0 ? 'primary' : playerIndex === 1 ? 'success' : playerIndex === 2 ? 'warning' : 'info';
                             teamsHtml += `
                                 <div class="col-12 mb-2">
                                     <div class="d-flex justify-content-between align-items-center">
                                         <span class="badge bg-${playerColor}">Player ${playerIndex + 1}</span>
                                         <small style="color: #888888 !important;">Not assigned</small>
                                         <small style="color: #888888 !important;">-</small>
                                     </div>
                                 </div>
                             `;
                         }
                     });
                 }
                 
                 teamsHtml += `
                                 </div>
                                 <div class="mt-2">
                                     <small class="text-muted" style="color: var(--text-secondary);">Joined: ${joinedAt}</small>
                                 </div>
                             </div>
                         </div>
                     </div>
                 `;
             });
             
             teamsHtml += '</div>';
             playersList.innerHTML = teamsHtml;
         }
         
     } catch (error) {
         console.error("Error loading registered players:", error);
         document.getElementById('registeredPlayersList').innerHTML = '<p class="text-danger">Error loading players data.</p>';
         return [];
     }
     
     return usersData;
 }

 async function handleIdPasswordClick(event) {
     if (!currentUser) return;
     const btn = event.currentTarget;
     const tId = btn.dataset.tournamentId;
     if (!tId) return;

     if (elements.idPasswordModalInstance) {
        elements.roomIdDisplay.innerHTML = '<span class="placeholder col-6"></span>';
        elements.roomPasswordDisplay.innerHTML = '<span class="placeholder col-6"></span>';
        elements.idPasswordModalInstance.show();

        get(ref(db, `tournaments/${tId}`)).then(snapshot => {
            if (snapshot.exists()) {
                const t = snapshot.val();
                elements.roomIdDisplay.textContent = t.roomId || 'Not set';
                elements.roomPasswordDisplay.textContent = t.roomPassword || 'Not set';
            } else {
                 elements.roomIdDisplay.textContent = 'Error';
                 elements.roomPasswordDisplay.textContent = 'Error';
            }
        }).catch(e => {
            console.error(e);
            elements.roomIdDisplay.textContent = 'Error';
            elements.roomPasswordDisplay.textContent = 'Error';
        });
    }
}

async function handleTournamentResultsClick(event) {
    if (!currentUser) return;
    const btn = event.currentTarget;
    const tId = btn.dataset.tournamentId;
    if (!tId) return;

    if (elements.tournamentResultsModalInstance) {
        // Show loading state
        elements.tournamentResultsContent.innerHTML = `
            <div class="text-center p-4">
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Loading...</span>
                </div>
                <p class="mt-2 text-secondary">Loading tournament results...</p>
            </div>
        `;
        
        elements.tournamentResultsModalInstance.show();

        try {
            // Fetch tournament data
            const tournamentSnapshot = await get(ref(db, `tournaments/${tId}`));
            if (!tournamentSnapshot.exists()) {
                throw new Error('Tournament not found');
            }
            
            const tournament = tournamentSnapshot.val();
            elements.tournamentResultsModalTitle.textContent = `${tournament.name || 'Tournament'} - Results`;
            
            // Fetch all registered players with their results
            const registeredPlayers = tournament.registeredPlayers || {};
            const playerIds = Object.keys(registeredPlayers);
            
            if (playerIds.length === 0) {
                elements.tournamentResultsContent.innerHTML = `
                    <div class="text-center p-4">
                        <i class="bi bi-exclamation-triangle text-warning" style="font-size: 3rem;"></i>
                        <h5 class="mt-3">No Results Available</h5>
                        <p class="text-secondary">No players participated in this tournament.</p>
                    </div>
                `;
                return;
            }
            
            // Fetch user profiles for all players
            const userProfiles = {};
            const userPromises = playerIds.map(async (uid) => {
                try {
                    const userSnapshot = await get(ref(db, `users/${uid}`));
                    if (userSnapshot.exists()) {
                        userProfiles[uid] = userSnapshot.val();
                    }
                } catch (error) {
                    console.error(`Error fetching user ${uid}:`, error);
                }
            });
            
            await Promise.all(userPromises);
            
            // Create results array with player data
            const results = playerIds.map(uid => {
                const playerData = registeredPlayers[uid];
                const userProfile = userProfiles[uid] || {};
                const isCurrentUser = uid === currentUser.uid;
                
                return {
                    uid: uid,
                    displayName: userProfile.displayName || userProfile.firstName || 'Unknown Player',
                    photoURL: userProfile.photoURL || `https://ui-avatars.com/api/?name=${encodeURIComponent(userProfile.displayName || 'U')}&background=0F172A&color=E2E8F0&bold=true&size=40`,
                    rank: playerData.rank || 'N/A',
                    kills: playerData.kills || 0,
                    prize: playerData.prize || 0,
                    isCurrentUser: isCurrentUser
                };
            });
            
            // Sort by rank (1st, 2nd, 3rd, etc.)
            results.sort((a, b) => {
                if (a.rank === 'N/A' && b.rank === 'N/A') return 0;
                if (a.rank === 'N/A') return 1;
                if (b.rank === 'N/A') return -1;
                return parseInt(a.rank) - parseInt(b.rank);
            });
            
            // Generate results HTML
            let resultsHTML = `
                <div class="tournament-results-header mb-4">
                    <div class="row text-center">
                        <div class="col-md-4">
                            <h6 class="text-secondary">Prize Pool</h6>
                            <h4 class="text-accent">NPR.${tournament.prizePool || 0}</h4>
                        </div>
                        <div class="col-md-4">
                            <h6 class="text-secondary">Per Kill</h6>
                            <h4 class="text-accent">NPR.${tournament.perKillPrize || 0}</h4>
                        </div>
                        <div class="col-md-4">
                            <h6 class="text-secondary">Total Players</h6>
                            <h4 class="text-accent">${playerIds.length}</h4>
                        </div>
                    </div>
                </div>
                
                <div class="results-list">
            `;
            
            results.forEach((player, index) => {
                const rankClass = player.rank === 1 ? 'text-warning' : 
                                player.rank === 2 ? 'text-secondary' : 
                                player.rank === 3 ? 'text-danger' : 'text-muted';
                
                const rankIcon = player.rank === 1 ? '' : 
                               player.rank === 2 ? '' : 
                               player.rank === 3 ? '' : '';
                
                const userHighlight = player.isCurrentUser ? 'border border-accent bg-accent-10' : '';
                
                resultsHTML += `
                    <div class="result-item ${userHighlight} p-3 mb-3 rounded" style="background: var(--card-bg); border: 1px solid var(--border-color);">
                        <div class="row align-items-center">
                            <div class="col-md-1 text-center">
                                <span class="rank-number ${rankClass}" style="font-size: 1.2rem; font-weight: bold;">
                                    ${rankIcon} ${player.rank}
                                </span>
                            </div>
                            <div class="col-md-2 text-center">
                                <img src="${player.photoURL}" alt="${player.displayName}" 
                                     class="rounded-circle" style="width: 40px; height: 40px; object-fit: cover;">
                            </div>
                            <div class="col-md-4">
                                <h6 class="mb-0 ${player.isCurrentUser ? 'text-accent' : ''}">
                                    ${player.displayName}
                                    ${player.isCurrentUser ? '<i class="bi bi-person-check-fill text-accent ms-1"></i>' : ''}
                                </h6>
                            </div>
                            <div class="col-md-2 text-center">
                                <span class="text-info">
                                    <i class="bi bi-crosshair"></i> ${player.kills}
                                </span>
                            </div>
                            <div class="col-md-2 text-center">
                                <span class="text-success">
                                    <i class="bi bi-currency-rupee"></i> ${player.prize.toFixed(2)}
                                </span>
                            </div>
                            <div class="col-md-1 text-center">
                                ${player.isCurrentUser ? '<span class="badge bg-accent">You</span>' : ''}
                            </div>
                        </div>
                    </div>
                `;
            });
            
            resultsHTML += `
                </div>
                
                <div class="text-center mt-4">
                    <small class="text-secondary">
                        <i class="bi bi-info-circle"></i>
                        Results are final and prizes will be credited to winners' accounts.
                    </small>
                </div>
            `;
            
            elements.tournamentResultsContent.innerHTML = resultsHTML;
            
        } catch (error) {
            console.error('Error loading tournament results:', error);
            elements.tournamentResultsContent.innerHTML = `
                <div class="text-center p-4">
                    <i class="bi bi-exclamation-triangle text-danger" style="font-size: 3rem;"></i>
                    <h5 class="mt-3">Error Loading Results</h5>
                    <p class="text-secondary">Unable to load tournament results. Please try again later.</p>
                </div>
            `;
        }
    }
}

 async function handlePolicyClick(event) {
     console.log("Policy link clicked");
     if (!elements.policyModalInstance) { console.error("Policy modal instance not found"); return; }
     event.preventDefault();
     const target = event.target.closest('[data-policy]');
     const policyType = target.dataset.policy;
     console.log("Policy type requested:", policyType);
     if (!policyType) return;

     let title = '', contentRefPath = '', modalBodyContent = '<div class="text-center p-5"><div class="spinner-border spinner-border-sm"></div></div>';
     elements.policyModalBody.innerHTML = modalBodyContent;

     // Use settings data for policies (adjust path based on your settings structure if needed)
     switch (policyType) {
         case 'privacy': title = 'Privacy Policy'; modalBodyContent = appSettings.policyPrivacy || 'Content not available.'; break;
         case 'terms': title = 'Terms and Conditions'; modalBodyContent = appSettings.policyTerms || 'Content not available.'; break;
         case 'refund': title = 'Refund and Cancellation'; modalBodyContent = appSettings.policyRefund || 'Content not available.'; break;
         case 'fairPlay': title = 'Fair Play Policy'; modalBodyContent = appSettings.policyFairPlay || 'Content not available.'; break;
         case 'refer':
             title = 'Refer & Earn';
             if (!currentUser) { alert("Login to view referral."); return; }
             const refCode = userProfile.referralCode || 'N/A';
             const refBonus = appSettings?.referralBonus || 0; // Use loaded setting
             const refDesc = appSettings?.referralDescription || `Get NPR.${refBonus} when your friend joins using your code.`; // Use loaded setting
             modalBodyContent = `<div class="text-center"><h4>Refer Friends!</h4><p class="text-secondary">Share code & earn!</p><div class="my-4 p-3" style="background: var(--primary-bg); border-radius: 8px;"><p class="small text-secondary mb-1">Your Code:</p><h3 class="text-accent referral-code" id="referralCodeDisplay">${refCode}</h3><div class="mt-3"><button class="btn btn-sm btn-custom btn-custom-secondary me-2 copy-btn" data-target="#referralCodeDisplay"><i class="bi bi-clipboard"></i> Copy</button><button class="btn btn-sm btn-custom btn-custom-secondary" id="shareReferralBtn"><i class="bi bi-share-fill"></i> Share</button></div></div><p class="mt-3 small text-secondary">${refDesc}</p></div>`;
             break;
         default:
             title = 'Info';
             console.warn("Unknown policy:", policyType);
             modalBodyContent = '<p>Content unavailable.</p>';
     }

     elements.policyModalTitle.textContent = title;
     // Handle simple text content, replace \n with <br>
     if (typeof modalBodyContent === 'string' && policyType !== 'refer') {
         elements.policyModalBody.innerHTML = modalBodyContent.replace(/\n/g, '<br>');
     } else {
         elements.policyModalBody.innerHTML = modalBodyContent; // For referral HTML or errors
     }
     console.log("Showing policy modal for:", policyType);
     elements.policyModalInstance.show();
 }


// --- Realtime Listeners Setup ---
 function setupRealtimeListeners(uid) {
     if (!uid || !db || !currentUser) return;
     detachAllDbListeners(); // Ensure no duplicates
     console.log("Setting up realtime listener for User Profile:", uid);
     const uRef = ref(db, `users/${uid}`);
     const listFunc = onValue(uRef, (s) => {
         if (currentUser && currentUser.uid === uid) { // Check if user is still the logged-in one
             if (s.exists()) {
                 console.log("Realtime: User Profile Update Received");
                 userProfile = s.val();
                 populateUserInfo(currentUser, userProfile); // Update UI with latest data
                 
                 // Update contest counts when profile changes
                 updateContestCounts();
                 
                 // Refresh sections that depend on profile changes (like My Contests)
                 if (currentSectionId === 'home-section') loadMyContests();
                 if (currentSectionId === 'wallet-section') loadRecentTransactions(); // Balance might change
             } else {
                 console.warn("User data deleted (realtime) for:", uid);
                 alert("Account data missing or deleted. Logging out.");
                 logoutUser();
             }
         } else {
             console.log("Realtime listener fired for a different user or logged-out state. Detaching.");
             off(uRef, 'value', listFunc); // Detach listener if user changed
         }
     }, (e) => {
         console.error("Listener error (user profile):", e);
         // Optionally try to re-attach or show error
     });
     dbListeners['userProfile'] = { path: `users/${uid}`, func: listFunc };
 }

 function detachAllDbListeners() {
     console.log("Detaching listeners:", Object.keys(dbListeners));
     let count = 0;
     for (const k in dbListeners) {
         try {
             const { path, func } = dbListeners[k];
             if (path && func) {
                  off(ref(db, path), 'value', func);
                  count++;
             } else {
                 console.warn(`Listener object invalid for key: ${k}`);
             }
         } catch (e) { console.error(`Detach error ${k}:`, e); }
     }
     dbListeners = {};
     console.log(`Detached ${count} listeners.`);
 }

// --- Security Rules Check ---
 async function checkSecurityRules() {
    console.log("Checking security rules...");
     try {
         // Attempt to read root only if NOT logged in (to check public read)
         if (!currentUser) {
             // Avoid actually reading "/" if not needed, instead check settings read result
             // If loadAppSettings failed with permission error, rules are likely secure.
             // If loadAppSettings worked, *potentially* insecure, but maybe settings are public?
             // A better check involves trying to write to an unauthorized location.
             // For simplicity, we'll rely on the warning if settings load works anonymously.
             // This check is imperfect. Best practice is to review rules in Firebase console.
             console.log("Security rule check skipped for anonymous user (rely on console).");

         } else if (elements.securityWarning) {
             // Hide warning if user is logged in (assuming rules are user-based)
              elements.securityWarning.style.display = 'none';
         }
         // Consider attempting an unauthorized write operation here for a more robust check
         // e.g., try { await set(ref(db, `unauthorizedWriteTest/${Date.now()}`), true); /* If success => insecure */ } catch(e) { /* If permission denied => secure */ }
     } catch (error) {
         // Catch specific permission errors if the check above changes
         console.log("Security rule check result (expected failure if secure):", error.message);
         if (elements.securityWarning) elements.securityWarning.style.display = 'none';
     }
 }

// --- DOM Elements Initialization ---
function initializeDOMElements() {
    elements.sections = querySelAll('.section');
    elements.bottomNavItems = querySelAll('.bottom-nav .nav-item');
    elements.globalLoader = getElement('globalLoaderEl');
    console.log('DOM elements initialized. Sections found:', elements.sections.length);
}

// --- Event Listeners Initialization ---
 function initializeEventListeners() {
     if (!elements) return; console.log("Initializing listeners...");
     // Bottom Nav
     elements.bottomNavItems?.forEach(item => item.addEventListener('click', () => showSection(item.dataset.section)));
     // Header Back
     elements.headerBackBtn?.addEventListener('click', () => showSection('home-section'));
     // Tournament Tabs
     elements.tournamentTabs?.forEach(tab => tab.addEventListener('click', () => { if (currentTournamentGameId) { elements.tournamentTabs.forEach(t => t.classList.remove('active')); tab.classList.add('active'); filterTournaments(currentTournamentGameId, tab.dataset.status); } }));

     // My Contests Tabs
     document.querySelectorAll('#my-contests-section .tournament-tabs .tab-item').forEach(tab => {
         tab.addEventListener('click', () => {
             // Remove active class from all tabs
             document.querySelectorAll('#my-contests-section .tournament-tabs .tab-item').forEach(t => t.classList.remove('active'));
             // Add active class to clicked tab
             tab.classList.add('active');
             // Load contests for selected status
             loadMyContestsPage(tab.dataset.status);
         });
     });

     // Login/Signup Forms
     elements.loginEmailBtn?.addEventListener('click', loginWithEmail);
     elements.signupEmailBtn?.addEventListener('click', signUpWithEmail);
     elements.showSignupToggleBtn?.addEventListener('click', () => toggleLoginForm(false)); // Show Signup
     elements.showLoginToggleBtn?.addEventListener('click', () => toggleLoginForm(true)); // Show Login
     elements.forgotPasswordLink?.addEventListener('click', (e) => { e.preventDefault(); resetPassword(); });

     // Profile Actions
     elements.logoutProfileBtn?.addEventListener('click', logoutUser);
     // Handle logout button in new profile design
     document.body.addEventListener('click', function(e) {
        const logoutBtn = e.target.closest('.logout-item');
        if (logoutBtn) {
            e.preventDefault();
            logoutUser();
        }
    });
     document.body.addEventListener('click', function(e) {
        const link = e.target.closest('.profile-links a[data-policy], .profile-links a[data-section], .profile-links button[data-policy], .menu-item[data-section], .menu-item[data-policy], .compact-menu-item[data-policy]');
        if (link) {
            e.preventDefault();
            if (link.dataset.section) {
                // Handle section navigation (like stats)
                showSection(link.dataset.section);
            } else if (link.dataset.policy) {
                // Handle policy links
                handlePolicyClick(e);
            }
        }
    });
     
     // Quick Action Cards Event Listener
     document.body.addEventListener('click', function(e) {
        const quickActionCard = e.target.closest('.quick-action-card[data-section]');
        if (quickActionCard) {
            e.preventDefault();
            const sectionId = quickActionCard.dataset.section;
            console.log('Quick action card clicked:', sectionId);
            if (sectionId) {
                showSection(sectionId);
            }
        }
    });
     
                     // Compact Action Cards Event Listener (Profile Section)
                document.body.addEventListener('click', function(e) {
                   const compactAction = e.target.closest('.compact-action[data-section]');
                   if (compactAction) {
                       e.preventDefault();
                       const sectionId = compactAction.dataset.section;
                       console.log('Compact action clicked:', sectionId);
                       if (sectionId) {
                           showSection(sectionId);
                       }
                   }
               });

                // Compact Quick Actions Event Listener (Homepage)
                document.body.addEventListener('click', function(e) {
                   const quickAction = e.target.closest('.compact-quick-action[data-section]');
                   if (quickAction) {
                       e.preventDefault();
                       const sectionId = quickAction.dataset.section;
                       console.log('Quick action clicked:', sectionId);
                       if (sectionId) {
                           showSection(sectionId);
                       }
                   }
               });
     
     // Compact Earnings Action Cards Event Listener
     document.body.addEventListener('click', function(e) {
        const compactEarningsAction = e.target.closest('.compact-earnings-action[data-section]');
        if (compactEarningsAction) {
            e.preventDefault();
            const sectionId = compactEarningsAction.dataset.section;
            console.log('Compact earnings action clicked:', sectionId);
            if (sectionId) {
                showSection(sectionId);
            }
        }
    });
     elements.notificationSwitch?.addEventListener('change', (e) => { console.log("Notification toggle:", e.target.checked); /* TODO: Implement notification preference saving */ });

     // Wallet Actions
     elements.withdrawBtn?.addEventListener('click', handleWithdrawClick);
     elements.addAmountWalletBtn?.addEventListener('click', () => { if (currentUser && elements.addAmountModalInstance) { if(elements.modalUserEmail) elements.modalUserEmail.textContent = currentUser.email || 'N/A'; elements.addAmountModalInstance.show(); } else if (!currentUser) { alert("Login first."); showSection('login-section'); } });
     elements.submitWithdrawRequestBtn?.addEventListener('click', submitWithdrawRequestHandler);

     // Deposit Actions
     elements.proceedToPaymentBtn?.addEventListener('click', handleProceedToPayment);
     elements.paymentDoneBtn?.addEventListener('click', handlePaymentDone);
     elements.backToStep1Btn?.addEventListener('click', handleBackToStep1);
     elements.paymentScreenshotInput?.addEventListener('change', handleScreenshotUpload);
     elements.submitDepositBtn?.addEventListener('click', handleSubmitDeposit);
     elements.backToStep2Btn?.addEventListener('click', handleBackToStep2);
     elements.copyUpiIdBtn?.addEventListener('click', handleCopyUpiId);
     
     // QR Code Action Listeners
     elements.openQrFullscreenBtn?.addEventListener('click', openQrCodeFullscreen);
     elements.saveQrCodeBtn?.addEventListener('click', saveQrCodeImage);
     elements.saveQrCodeFullscreenBtn?.addEventListener('click', saveQrCodeImage);

     // Other Actions
     elements.notificationBtn?.addEventListener('click', () => alert('Notifications coming soon!'));
             elements.allTransactionsBtn?.addEventListener('click', () => showDepositHistory());
     elements.viewEarningsHistoryBtn?.addEventListener('click', () => alert('Earnings history coming soon!'));
                 elements.viewReferralHistoryBtn?.addEventListener('click', () => showSection('referral-section'));
            
            // Earnings section
            elements.viewTournamentsBtn?.addEventListener('click', () => showSection('tournaments-section'));
            
            // Initialize earnings history filters
            initializeEarningsHistoryFilters();
     elements.refreshReferralHistoryBtn?.addEventListener('click', () => loadReferralData());
     elements.debugReferralBtn?.addEventListener('click', async () => {
         console.log("=== REFERRAL DEBUG INFO ===");
         console.log("Current user:", currentUser?.uid);
         console.log("User profile:", userProfile);
         
         try {
             // Check all users in Firebase
             const usersRef = ref(db, 'users');
             const usersSnap = await get(usersRef);
             const users = usersSnap.val() || {};
             
             console.log("All users in Firebase:", Object.keys(users).length);
             
             // Check referral relationships
             let referralCount = 0;
             Object.values(users).forEach(user => {
                 if (user.referredBy) {
                     referralCount++;
                     console.log(`User ${user.displayName} (${user.uid}) was referred by ${user.referredBy}`);
                 }
             });
             
             console.log(`Total referral relationships: ${referralCount}`);
             
             // Check current user's referrals
             const currentUserReferrals = Object.values(users).filter(user => user.referredBy === currentUser?.uid);
             console.log(`Users referred by current user: ${currentUserReferrals.length}`);
             currentUserReferrals.forEach(user => {
                 console.log(`- ${user.displayName} (${user.uid})`);
             });
             
         } catch (error) {
             console.error("Debug error:", error);
         }
     });

     // Support Event Listeners
     elements.createTicketBtnEl?.addEventListener('click', () => {
         if (!currentUser) {
             alert('Please login first to create a support ticket.');
             showSection('login-section');
             return;
         }
         const modal = new bootstrap.Modal(document.getElementById('createTicketModalEl'));
         modal.show();
     });

     // Create First Ticket Button Event Listener
     document.getElementById('createFirstTicketBtnEl')?.addEventListener('click', () => {
         if (!currentUser) {
             alert('Please login first to create a support ticket.');
             showSection('login-section');
             return;
         }
         const modal = new bootstrap.Modal(document.getElementById('createTicketModalEl'));
         modal.show();
     });

     elements.submitTicketBtnEl?.addEventListener('click', createSupportTicket);
     elements.refreshTicketsBtnEl?.addEventListener('click', loadUserSupportTickets);
     elements.sendChatMessageBtnEl?.addEventListener('click', sendUserChatMessage);
     elements.resolveTicketBtnEl?.addEventListener('click', resolveUserTicket);
     elements.closeTicketBtnEl?.addEventListener('click', () => {
         const modal = bootstrap.Modal.getInstance(document.getElementById('supportChatModalEl'));
         if (modal) modal.hide();
     });
     elements.copyReferralCodeBtn?.addEventListener('click', () => {
         if (userProfile?.referralCode) {
             navigator.clipboard.writeText(userProfile.referralCode).then(() => {
                 // Enhanced copy feedback
                 const btn = elements.copyReferralCodeBtn;
                 const originalText = btn.innerHTML;
                 btn.innerHTML = '<i class="bi bi-check-lg"></i> Copied!';
                 btn.classList.add('copy-success');
                 
                 setTimeout(() => {
                     btn.innerHTML = originalText;
                     btn.classList.remove('copy-success');
                 }, 2000);
             }).catch(err => {
                 console.error('Failed to copy:', err);
                 alert('Failed to copy referral code.');
             });
         } else {
             alert('Referral code not available.');
         }
     });

     // Enhanced Referral Share Functionality
     const shareReferralCode = (platform) => {
         if (!userProfile?.referralCode) {
             alert('Referral code not available.');
             return;
         }
         
         const referralText = `Join me on Gaming Tournament! Use my referral code: ${userProfile.referralCode}`;
         const shareUrl = window.location.origin + window.location.pathname;
         
         let shareLink = '';
         
         switch (platform) {
             case 'whatsapp':
                 shareLink = `https://wa.me/?text=${encodeURIComponent(referralText + ' ' + shareUrl)}`;
                 break;
             case 'telegram':
                 shareLink = `https://t.me/share/url?url=${encodeURIComponent(shareUrl)}&text=${encodeURIComponent(referralText)}`;
                 break;
             case 'copy':
                 navigator.clipboard.writeText(referralText + ' ' + shareUrl).then(() => {
                     const btn = getElement('shareCopyBtn');
                     const originalText = btn.innerHTML;
                     btn.innerHTML = '<i class="bi bi-check-lg"></i> Copied!';
                     btn.classList.add('copy-success');
                     
                     setTimeout(() => {
                         btn.innerHTML = originalText;
                         btn.classList.remove('copy-success');
                     }, 2000);
                 });
                 return;
         }
         
         if (shareLink) {
             window.open(shareLink, '_blank');
         }
     };

     // Referral Share Button Event Listeners
     getElement('shareWhatsappBtn')?.addEventListener('click', (e) => {
         e.preventDefault();
         shareReferralCode('whatsapp');
     });

     getElement('shareTelegramBtn')?.addEventListener('click', (e) => {
         e.preventDefault();
         shareReferralCode('telegram');
     });

     getElement('shareCopyBtn')?.addEventListener('click', (e) => {
         e.preventDefault();
         shareReferralCode('copy');
     });



     // Delegated Event Listener for Copy/Share buttons
     document.body.addEventListener('click', (event) => {
        // Copy Button
        if (event.target.matches('.copy-btn') || event.target.closest('.copy-btn')) {
            const btn = event.target.closest('.copy-btn');
            const targetSelector = btn.dataset.target; // Expects #elementId selector
            if (targetSelector) {
                copyToClipboard(targetSelector);
            } else {
                console.warn("Copy button missing data-target selector.");
            }
        }
        // Share Button (in Refer modal)
        if (event.target.matches('#shareReferralBtn') || event.target.closest('#shareReferralBtn')) {
            const cel = getElement('referralCodeDisplay');
            if (cel) shareReferral(cel.textContent);
        }
     });
     console.log("Listeners initialized.");
 }

// --- App Initialization ---
 document.addEventListener('DOMContentLoaded', () => {
     console.log("DOM Loaded. Init App...");
     // Check if Firebase was initialized (handles the case where config was bad)
     if (typeof initializeApp !== 'function' || !auth || !db) {
         console.error("Firebase SDK failed/not ready. Cannot proceed.");
         // The error message should already be displayed by the catch block during initialization
         return;
     }
     showLoader(true);
     // Load settings first, then set up listeners and auth state
     loadAppSettings()
         .then(() => {
             console.log("Settings loaded, initializing listeners and auth state...");
             initializeDOMElements(); // Initialize DOM elements first
             initializeEventListeners();
             updateGlobalUI(false); // Initial UI state (logged out)
             onAuthStateChanged(auth, handleAuthStateChange); // Start listening for auth changes
             // checkSecurityRules(); // Check rules (optional, can be unreliable)
         })
         .catch(err => {
             // Handle critical settings load failure if needed
             console.error("CRITICAL: Initial settings load failed:", err);
             alert("Error loading essential app settings. Please try again later.");
             // Still try to initialize base UI and Auth listener if possible
             initializeDOMElements(); // Initialize DOM elements first
             initializeEventListeners();
             updateGlobalUI(false);
             onAuthStateChanged(auth, handleAuthStateChange);
         })
         .finally(() => {
             // Loader should be hidden by onAuthStateChanged after login/logout logic completes
         });
 });

 document.getElementById('saveInGameNameBtnEl').addEventListener('click', joinTournamentAndSaveDetails);

 // Event delegation for registered players button
 document.addEventListener('click', (event) => {
     if (event.target.closest('[data-tournament-id]')) {
         const button = event.target.closest('[data-tournament-id]');
         const tournamentId = button.dataset.tournamentId;
         const tournamentName = button.dataset.tournamentName;
         if (tournamentId && tournamentName) {
             showRegisteredPlayers(tournamentId, tournamentName);
         }
     }
 });

      elements.myContestsTabs.forEach(tab => {
        tab.addEventListener('click', () => {
            elements.myContestsTabs.forEach(t => t.classList.remove('active'));
            tab.classList.add('active');
            const statusGroup = tab.dataset.statusGroup;
            loadMyContestsPage(statusGroup);
        });
    });
    
    // Initialize modern contest tabs
    initializeModernContestTabs();
    
    // Load home stats for all users (even when not logged in)
    loadHomeStats();
        
    // Leaderboard tab event listeners
    elements.leaderboardTabs.forEach(tab => {
        tab.addEventListener('click', () => {
            elements.leaderboardTabs.forEach(t => t.classList.remove('active'));
            tab.classList.add('active');
            currentLeaderboardType = tab.dataset.leaderboardType;
            leaderboardCache = null; // Clear cache to reload with new type
            loadLeaderboardData();
        });
    });

// --- Profile Edit Functions ---
function openEditProfileModal() {
    if (!currentUser || !userProfile) return;
    
    // Populate the form fields with current user data
    elements.editProfileFirstNameInput.value = userProfile.firstName || '';
    elements.editProfileLastNameInput.value = userProfile.lastName || '';
    elements.editProfileUsernameInput.value = userProfile.username || '';
    elements.editProfileDisplayNameInput.value = userProfile.displayName || '';
    
    elements.editProfileAvatarPreview.src = userProfile.photoURL || `https://ui-avatars.com/api/?name=${encodeURIComponent(userProfile.displayName || 'U')}&background=0F172A&color=E2E8F0&bold=true&size=90`;
    elements.editProfilePhotoInput.value = '';
    clearStatusMessage(elements.editProfileStatusMessage);
    const uploadStatus = elements.editProfileModalInstance._element.querySelector('.imgbb-upload-status');
    if(uploadStatus) {
        uploadStatus.textContent = '';
        uploadStatus.style.display = 'none';
    }
    elements.editProfileModalInstance.show();
}

async function saveProfile() {
    if (!currentUser) return;

    const btn = elements.saveProfileBtn;
    btn.disabled = true;
    btn.innerHTML = '<span class="spinner-border spinner-border-sm"></span> Saving...';

    const firstName = elements.editProfileFirstNameInput.value.trim();
    const lastName = elements.editProfileLastNameInput.value.trim();
    const username = elements.editProfileUsernameInput.value.trim();
    const displayName = elements.editProfileDisplayNameInput.value.trim();
    const photoFile = elements.editProfilePhotoInput.files[0];

    if (!firstName || !lastName || !username || !displayName) {
        showStatusMessage(elements.editProfileStatusMessage, 'All fields are required.', 'warning');
        btn.disabled = false;
        btn.innerHTML = 'Save Changes';
        return;
    }

    try {
        let photoURL = userProfile.photoURL; // Keep old photo by default

        if (photoFile) {
            if (IMGBB_API_KEY === 'YOUR_IMGBB_API_KEY') {
                throw new Error("ImgBB API key is not configured.");
            }
            photoURL = await uploadToImgBB(photoFile, elements.editProfileModalInstance._element.querySelector('.imgbb-upload-status'));
        }

        const updates = {
            firstName: firstName,
            lastName: lastName,
            username: username,
            displayName: displayName,
            photoURL: photoURL
        };

        const userRef = ref(db, `users/${currentUser.uid}`);
        await update(userRef, updates);

        showStatusMessage(elements.editProfileStatusMessage, 'Profile updated successfully!', 'success');
        
        setTimeout(() => {
            elements.editProfileModalInstance.hide();
        }, 1500);

    } catch (e) {
        console.error("Profile save error:", e);
        showStatusMessage(elements.editProfileStatusMessage, `Error: ${e.message}`, 'danger', false);
    } finally {
        btn.disabled = false;
        btn.innerHTML = 'Save Changes';
    }
}

async function uploadToImgBB(file, statusElement) {
    if (!file) throw new Error("No file selected for upload.");
    if(statusElement) {
        statusElement.textContent = 'Uploading...';
        statusElement.style.display = 'block';
        statusElement.className = 'imgbb-upload-status text-info';
    }

    const formData = new FormData();
    formData.append('image', file);

    const response = await fetch(`https://api.imgbb.com/1/upload?key=${IMGBB_API_KEY}`, {
        method: 'POST',
        body: formData,
    });

    const result = await response.json();

    if (!response.ok || !result.success) {
        if(statusElement) {
            statusElement.textContent = `Upload failed: ${result?.error?.message || 'Unknown error'}`;
            statusElement.className = 'imgbb-upload-status text-danger';
        }
        throw new Error(`ImgBB upload failed: ${result?.error?.message || response.statusText}`);
    }
    
    if(statusElement) {
        statusElement.textContent = 'Upload successful!';
        statusElement.className = 'imgbb-upload-status text-success';
    }
    console.log("ImgBB Upload Result:", result);
    return result.data.url;
}

elements.editProfileBtn?.addEventListener('click', openEditProfileModal);
elements.saveProfileBtn?.addEventListener('click', saveProfile);

// --- Stats Calculation Function ---
let statsCache = null;
let lastStatsCalculation = 0;
const STATS_CACHE_DURATION = 30000; // 30 seconds cache

async function calculateUserStats(userProfile) {
    if (!userProfile) return {
        tournamentsJoined: 0,
        matchesPlayed: 0,
        matchesWon: 0,
        winRate: 0
    };
    
    // Check cache first
    const now = Date.now();
    if (statsCache && (now - lastStatsCalculation) < STATS_CACHE_DURATION) {
        return statsCache;
    }
    
    try {
        // Get user's joined tournaments to calculate correct stats
        const joinedTournaments = userProfile.joinedTournaments || {};
        const tournamentIds = Object.keys(joinedTournaments);
        
        // Calculate tournaments joined (all contests including canceled)
        const tournamentsJoined = tournamentIds.length;
        
        if (tournamentIds.length === 0) {
            const result = {
                tournamentsJoined: 0,
                matchesPlayed: 0,
                matchesWon: 0,
                winRate: 0
            };
            statsCache = result;
            lastStatsCalculation = now;
            return result;
        }
        
        // Calculate matches played (all contests except canceled)
        let matchesPlayed = 0;
        let matchesWon = 0;
        
        // Batch fetch all tournaments at once instead of individual calls
        const tournamentRefs = tournamentIds.map(id => ref(db, `tournaments/${id}`));
        const tournamentSnaps = await Promise.all(tournamentRefs.map(ref => get(ref)));
        
        for (let i = 0; i < tournamentSnaps.length; i++) {
            const tournamentSnap = tournamentSnaps[i];
            const tournamentId = tournamentIds[i];
            
            if (tournamentSnap.exists()) {
                const tournamentData = tournamentSnap.val();
                
                // Count as match played if tournament is not canceled
                if (tournamentData.status !== 'canceled') {
                    matchesPlayed++;
                    
                    // Check if user won this tournament
                    const playerResult = tournamentData.registeredPlayers?.[currentUser.uid];
                    
                    // Check for prize amount in both prizeAmount and prize fields
                    const prizeAmount = playerResult?.prizeAmount || playerResult?.prize || 0;
                    
                    if (playerResult && prizeAmount >= 1) {
                        matchesWon++;
                    }
                }
            } else {
                // If tournament doesn't exist, assume it's not canceled
                matchesPlayed++;
            }
        }
        
        // Calculate win rate from matches played
        let winRate = 0;
        if (matchesPlayed > 0) {
            winRate = Math.round((matchesWon / matchesPlayed) * 100);
        }
        
        const result = {
            tournamentsJoined,
            matchesPlayed,
            matchesWon,
            winRate
        };
        
        // Cache the result
        statsCache = result;
        lastStatsCalculation = now;
        
        return result;
        
    } catch (error) {
        console.error("Error calculating user stats:", error);
        return {
            tournamentsJoined: 0,
            matchesPlayed: 0,
            matchesWon: 0,
            winRate: 0
        };
    }
}

// --- UI Functions ---

</script>

<style>
/* Modern Profile Design */
.profile-header-card {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: 20px;
    padding: 2rem;
    text-align: center;
    margin-bottom: 2rem;
    position: relative;
    overflow: hidden;
}

.profile-header-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(45deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
    pointer-events: none;
}

.profile-avatar-container {
    position: relative;
    display: inline-block;
    margin-bottom: 1rem;
}

.profile-avatar {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    border: 3px solid rgba(255,255,255,0.3);
    background: linear-gradient(135deg, #3498db, #2980b9);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: 600;
    font-size: 1.5rem;
}

.profile-edit-overlay {
    position: absolute;
    bottom: 0;
    right: 0;
    background: rgba(255,255,255,0.9);
    border-radius: 50%;
    width: 30px;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 2px 8px rgba(0,0,0,0.2);
}

.profile-edit-overlay .btn {
    padding: 0;
    width: 24px;
    height: 24px;
    border-radius: 50%;
    font-size: 0.8rem;
}

.profile-info {
    position: relative;
    z-index: 1;
}

.profile-name {
    color: white;
    font-weight: 600;
    font-size: 1.5rem;
    margin-bottom: 0.5rem;
}

.profile-email {
    color: rgba(255,255,255,0.8);
    font-size: 0.9rem;
    margin-bottom: 0;
}

/* Profile Stats Grid */
.profile-stats-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1rem;
    margin-bottom: 2rem;
}

.stat-card {
    background: linear-gradient(180deg, rgba(22,27,34,0.95), rgba(22,27,34,0.85));
    border-radius: 16px;
    padding: 1.5rem;
    text-align: center;
    border: 1px solid rgba(255, 255, 255, 0.08);
    transition: transform .25s ease, box-shadow .25s ease;
}

.stat-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0,0,0,0.3);
}

.stat-icon {
    width: 50px;
    height: 50px;
    border-radius: 12px;
    background: linear-gradient(135deg, #3498db, #2980b9);
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 1rem;
    color: white;
    font-size: 1.2rem;
}

.stat-value {
    color: var(--text-primary);
    font-weight: 700;
    font-size: 1.3rem;
    margin-bottom: 0.25rem;
}

.stat-label {
    color: var(--text-secondary);
    font-size: 0.85rem;
    margin: 0;
    opacity: 0.8;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

/* Profile Menu */
.profile-menu {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

.menu-section {
    background: linear-gradient(180deg, rgba(22,27,34,0.95), rgba(22,27,34,0.85));
    border-radius: 16px;
    padding: 1.5rem;
    border: 1px solid rgba(255, 255, 255, 0.08);
}

.menu-section-title {
    color: var(--text-primary);
    font-weight: 600;
    font-size: 1.1rem;
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.menu-items {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
}

.menu-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 1rem;
    background: rgba(255,255,255,0.05);
    border-radius: 12px;
    border: 1px solid rgba(255,255,255,0.08);
    text-decoration: none;
    color: var(--text-primary);
    transition: all 0.3s ease;
}

.menu-item:hover {
    background: rgba(255,255,255,0.08);
    transform: translateX(4px);
    text-decoration: none;
    color: var(--text-primary);
}

.menu-item-content {
    display: flex;
    align-items: center;
    gap: 1rem;
    flex: 1;
}

.menu-item-icon {
    width: 40px;
    height: 40px;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1rem;
}

.menu-item-icon.earnings-icon {
    background: linear-gradient(135deg, #f39c12, #e67e22);
}

.menu-item-icon.referral-icon {
    background: linear-gradient(135deg, #9b59b6, #8e44ad);
}

.menu-item-icon.stats-icon {
    background: linear-gradient(135deg, #3498db, #2980b9);
}

.menu-item-icon.legal-icon {
    background: linear-gradient(135deg, #e74c3c, #c0392b);
}

.menu-item-icon.logout-icon {
    background: linear-gradient(135deg, #e74c3c, #c0392b);
}

.menu-item-text h6 {
    color: var(--text-primary);
    font-weight: 600;
    margin: 0;
    font-size: 1rem;
}

.menu-item-text p {
    color: var(--text-secondary);
    font-size: 0.8rem;
    margin: 0;
    opacity: 0.8;
}

.menu-item-action {
    color: var(--text-secondary);
    font-size: 0.9rem;
}

.logout-item {
    border-color: rgba(231, 76, 60, 0.3);
}

.logout-item:hover {
    background: rgba(231, 76, 60, 0.1);
    border-color: rgba(231, 76, 60, 0.5);
}

/* Mobile Responsive */
@media (max-width: 768px) {
    .profile-header-card {
        padding: 1.5rem;
        margin-bottom: 1.5rem;
    }

    .profile-avatar {
        width: 70px;
        height: 70px;
        font-size: 1.3rem;
    }

    .profile-name {
        font-size: 1.3rem;
    }

    .profile-stats-grid {
        gap: 0.75rem;
        margin-bottom: 1.5rem;
    }

    .stat-card {
        padding: 1.25rem;
    }

    .stat-icon {
        width: 45px;
        height: 45px;
        font-size: 1.1rem;
    }

    .stat-value {
        font-size: 1.2rem;
    }

    .menu-section {
        padding: 1.25rem;
    }

    .menu-item {
        padding: 0.875rem;
    }

    .menu-item-icon {
        width: 35px;
        height: 35px;
        font-size: 0.9rem;
    }

    .menu-item-text h6 {
        font-size: 0.95rem;
    }

    .menu-item-text p {
        font-size: 0.75rem;
    }
}

/* Modern Home Design */
.welcome-banner {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: 20px;
    padding: 2rem;
    margin-bottom: 2rem;
    position: relative;
    overflow: hidden;
}

.welcome-banner::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(45deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
    pointer-events: none;
}

.welcome-content {
    display: flex;
    align-items: center;
    justify-content: space-between;
    position: relative;
    z-index: 1;
}

.welcome-text {
    flex: 1;
}

.welcome-title {
    color: white;
    font-size: 1.8rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
}

.welcome-subtitle {
    color: rgba(255,255,255,0.9);
    font-size: 1rem;
    margin: 0;
}

.welcome-icon {
    width: 60px;
    height: 60px;
    background: rgba(255,255,255,0.2);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.5rem;
}

/* Quick Stats Grid */
.quick-stats-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1rem;
    margin-bottom: 2rem;
}

.quick-stats-grid .stat-card {
    background: linear-gradient(180deg, rgba(22,27,34,0.95), rgba(22,27,34,0.85));
    border-radius: 16px;
    padding: 1.5rem;
    text-align: center;
    border: 1px solid rgba(255, 255, 255, 0.08);
    transition: transform .25s ease, box-shadow .25s ease;
}

.quick-stats-grid .stat-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0,0,0,0.3);
}

.quick-stats-grid .stat-icon {
    width: 50px;
    height: 50px;
    border-radius: 12px;
    background: linear-gradient(135deg, #3498db, #2980b9);
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 1rem;
    color: white;
    font-size: 1.2rem;
}

.quick-stats-grid .stat-value {
    color: var(--text-primary);
    font-weight: 700;
    font-size: 1.3rem;
    margin-bottom: 0.25rem;
}

.quick-stats-grid .stat-label {
    color: var(--text-secondary);
    font-size: 0.85rem;
    margin: 0;
    opacity: 0.8;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

/* Section Headers */
.section-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 1.5rem;
}

.section-title {
    color: var(--text-primary);
    font-weight: 600;
    font-size: 1.3rem;
    margin: 0;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.section-subtitle {
    color: var(--text-secondary);
    font-size: 0.9rem;
    margin: 0;
}

.view-all-link {
    color: var(--accent-color);
    text-decoration: none;
    font-size: 0.9rem;
    font-weight: 500;
    display: flex;
    align-items: center;
    gap: 0.25rem;
    transition: color 0.3s ease;
}

.view-all-link:hover {
    color: #FBBF24;
    text-decoration: none;
}

.action-content h5 {
    color: var(--text-primary);
    font-weight: 600;
    margin: 0;
    font-size: 1rem;
}

.action-content p {
    color: var(--text-secondary);
    font-size: 0.8rem;
    margin: 0;
    opacity: 0.8;
}

/* Mobile Responsive */
@media (max-width: 768px) {
    .welcome-banner {
        padding: 1.5rem;
        margin-bottom: 1.5rem;
    }

    .welcome-title {
        font-size: 1.5rem;
    }

    .welcome-subtitle {
        font-size: 0.9rem;
    }

    .welcome-icon {
        width: 50px;
        height: 50px;
        font-size: 1.3rem;
    }

    .quick-stats-grid {
        gap: 0.75rem;
        margin-bottom: 1.5rem;
    }

    .quick-stats-grid .stat-card {
        padding: 1.25rem;
    }

    .quick-stats-grid .stat-icon {
        width: 45px;
        height: 45px;
        font-size: 1.1rem;
    }

    .quick-stats-grid .stat-value {
        font-size: 1.2rem;
    }

    .section-title {
        font-size: 1.2rem;
    }

    .games-grid {
        gap: 0.75rem;
    }

    .game-card img {
        height: 100px;
    }

    .game-card span {
        padding: 0.875rem;
        font-size: 0.9rem;
    }

    .tournaments-preview {
        padding: 1.25rem;
    }

    .tournament-preview-card {
        padding: 0.875rem;
    }

    .tournament-preview-icon {
        width: 35px;
        height: 35px;
        font-size: 0.9rem;
    }

    .quick-actions-grid {
        gap: 0.75rem;
    }

    .action-card {
        padding: 1.25rem;
    }

    .action-icon {
        width: 40px;
        height: 40px;
        font-size: 1.1rem;
    }

    .action-content h5 {
        font-size: 0.95rem;
    }

    .action-content p {
        font-size: 0.75rem;
    }
}

/* Modern My Contests Design */

/* My Contests now uses tournament-tabs styling */

/* Contest Cards */
.contests-container {
    margin-bottom: 2rem;
}

.contests-grid {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.contest-card {
    background: linear-gradient(135deg, rgba(22,27,34,0.92), rgba(22,27,34,0.88));
    border-radius: 16px;
    padding: 1.25rem;
    border: 1px solid rgba(255, 255, 255, 0.06);
    transition: all 0.25s ease;
    position: relative;
    overflow: hidden;
    box-shadow: 0 3px 15px rgba(0,0,0,0.15);
    margin-bottom: 1rem;
}

.contest-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 2px;
    background: linear-gradient(90deg, #667eea, #764ba2, #f093fb);
    opacity: 0;
    transition: opacity 0.25s ease;
}

.contest-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 25px rgba(0,0,0,0.25);
    border-color: rgba(255,255,255,0.12);
}

.contest-card:hover::before {
    opacity: 1;
}

.contest-header {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    margin-bottom: 1rem;
    gap: 0.75rem;
}

.contest-title-section {
    flex: 1;
    min-width: 0;
}

.contest-title {
    color: var(--text-primary);
    font-weight: 700;
    font-size: 1.1rem;
    margin-bottom: 0.4rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    line-height: 1.3;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.contest-title i {
    color: var(--accent-color);
    font-size: 1rem;
    flex-shrink: 0;
}

.contest-game {
    color: var(--text-secondary);
    font-size: 0.85rem;
    opacity: 0.9;
    display: flex;
    align-items: center;
    gap: 0.4rem;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.contest-game i {
    color: var(--accent-color);
    font-size: 0.75rem;
    flex-shrink: 0;
}

.contest-status {
    padding: 0.4rem 0.8rem;
    border-radius: 16px;
    font-size: 0.75rem;
    font-weight: 600;
    text-align: center;
    white-space: nowrap;
    flex-shrink: 0;
    min-width: 80px;
}

.status-active {
    background: linear-gradient(135deg, #2ed573, #1e90ff);
    color: white;
    box-shadow: 0 4px 15px rgba(46, 213, 115, 0.3);
}

.status-completed {
    background: linear-gradient(135deg, #ffa502, #ff6348);
    color: white;
    box-shadow: 0 4px 15px rgba(255, 165, 2, 0.3);
}

.status-upcoming {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
}

.contest-content {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
    margin-bottom: 1.25rem;
}

.contest-info {
    display: flex;
    flex-direction: column;
    gap: 0.6rem;
}

.info-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0.6rem 0.75rem;
    background: rgba(255,255,255,0.04);
    border-radius: 10px;
    border: 1px solid rgba(255,255,255,0.06);
    transition: all 0.25s ease;
}

.info-item:hover {
    background: rgba(255,255,255,0.06);
    transform: translateX(2px);
}

.info-item span:first-child {
    color: var(--text-secondary);
    font-size: 0.8rem;
    font-weight: 500;
}

.info-item strong {
    color: var(--text-primary);
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 0.4rem;
    font-size: 0.85rem;
}

.info-item i {
    color: var(--accent-color);
    font-size: 0.8rem;
}

.contest-prize {
    background: linear-gradient(135deg, rgba(102, 126, 234, 0.08), rgba(118, 75, 162, 0.08));
    border-radius: 12px;
    padding: 1rem;
    text-align: center;
    border: 1px solid rgba(102, 126, 234, 0.15);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
}

.prize-amount {
    color: #667eea;
    font-weight: 700;
    font-size: 1.2rem;
    margin-bottom: 0.3rem;
    text-shadow: 0 1px 3px rgba(0,0,0,0.2);
}

.prize-label {
    color: var(--text-secondary);
    font-size: 0.8rem;
    opacity: 0.9;
    text-transform: uppercase;
    letter-spacing: 0.3px;
}

.contest-actions {
    display: flex;
    gap: 0.75rem;
    flex-wrap: wrap;
}

.contest-action-btn {
    flex: 1;
    min-width: 120px;
    padding: 0.75rem 1rem;
    border-radius: 10px;
    border: none;
    font-weight: 600;
    font-size: 0.85rem;
    transition: all 0.25s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.4rem;
    cursor: pointer;
    text-decoration: none;
    position: relative;
    overflow: hidden;
}

.contest-action-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
    transition: left 0.5s ease;
}

.contest-action-btn:hover::before {
    left: 100%;
}

.btn-view-players {
    background: linear-gradient(135deg, #3498db, #2980b9);
    color: white;
    box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
}

.btn-view-players:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(52, 152, 219, 0.4);
}

.btn-joined {
    background: linear-gradient(135deg, #27ae60, #2ecc71);
    color: white;
    box-shadow: 0 4px 15px rgba(39, 174, 96, 0.3);
}

.btn-joined:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(39, 174, 96, 0.4);
}

.btn-view-idpass {
    background: linear-gradient(135deg, #f39c12, #e67e22);
    color: white;
    box-shadow: 0 4px 15px rgba(243, 156, 18, 0.3);
}

.btn-view-idpass:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(243, 156, 18, 0.4);
}

.btn-view-result {
    background: linear-gradient(135deg, #9b59b6, #8e44ad);
    color: white;
    box-shadow: 0 4px 15px rgba(155, 89, 182, 0.3);
}

.btn-view-result:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(155, 89, 182, 0.4);
}

/* No Contests Message */
.no-contests-message {
    text-align: center;
    padding: 3rem 2rem;
    color: var(--text-secondary);
    background: rgba(255,255,255,0.03);
    border-radius: 20px;
    border: 1px solid rgba(255,255,255,0.08);
}

.no-contests-message i {
    font-size: 3rem;
    color: var(--text-secondary);
    margin-bottom: 1rem;
    display: block;
    opacity: 0.5;
}

.no-contests-message span {
    display: block;
    font-size: 1.1rem;
    font-weight: 600;
    margin-bottom: 0.5rem;
    color: var(--text-primary);
}

.no-contests-message small {
    font-size: 0.9rem;
    opacity: 0.7;
}

/* Mobile Responsiveness - Compact Design */
@media (max-width: 768px) {
    .contests-filter-tabs {
        gap: 0.5rem;
        margin-bottom: 1rem;
        padding: 0 0.25rem;
    }
    
    .filter-tab {
        padding: 0.75rem 0.5rem;
        min-height: 50px;
    }
    
    .tab-icon {
        width: 32px;
        height: 32px;
        font-size: 0.9rem;
    }
    
    .tab-label {
        font-size: 0.85rem;
    }
    
    .tab-count {
        font-size: 0.7rem;
    }
    
    .contest-card {
        padding: 1rem;
        border-radius: 12px;
        margin-bottom: 0.75rem;
    }
    
    .contest-header {
        margin-bottom: 0.75rem;
        gap: 0.5rem;
    }
    
    .contest-title {
        font-size: 1rem;
        margin-bottom: 0.3rem;
    }
    
    .contest-game {
        font-size: 0.8rem;
    }
    
    .contest-status {
        padding: 0.3rem 0.6rem;
        font-size: 0.7rem;
        min-width: 70px;
    }
    
    .contest-content {
        grid-template-columns: 1fr;
        gap: 0.75rem;
        margin-bottom: 1rem;
    }
    
    .contest-info {
        gap: 0.5rem;
    }
    
    .info-item {
        padding: 0.5rem 0.6rem;
        border-radius: 8px;
    }
    
    .info-item span:first-child {
        font-size: 0.75rem;
    }
    
    .info-item strong {
        font-size: 0.8rem;
    }
    
    .contest-prize {
        padding: 0.75rem;
        border-radius: 10px;
    }
    
    .prize-amount {
        font-size: 1.1rem;
        margin-bottom: 0.2rem;
    }
    
    .prize-label {
        font-size: 0.75rem;
    }
    
    .contest-actions {
        gap: 0.5rem;
        flex-direction: column;
    }
    
    .contest-action-btn {
        min-width: 100%;
        padding: 0.6rem 0.75rem;
        font-size: 0.8rem;
        border-radius: 8px;
    }
}

@media (max-width: 480px) {
    .contests-filter-tabs {
        padding: 0;
    }
    
    .filter-tab {
        padding: 0.6rem 0.4rem;
        min-height: 45px;
    }
    
    .tab-icon {
        width: 28px;
        height: 28px;
        font-size: 0.8rem;
    }
    
    .tab-label {
        font-size: 0.8rem;
    }
    
    .tab-count {
        font-size: 0.65rem;
    }
    
    .contest-card {
        padding: 0.875rem;
        border-radius: 10px;
        margin-bottom: 0.6rem;
    }
    
    .contest-header {
        margin-bottom: 0.6rem;
    }
    
    .contest-title {
        font-size: 0.95rem;
    }
    
    .contest-game {
        font-size: 0.75rem;
    }
    
    .contest-status {
        padding: 0.25rem 0.5rem;
        font-size: 0.65rem;
        min-width: 60px;
    }
    
    .contest-content {
        gap: 0.6rem;
        margin-bottom: 0.875rem;
    }
    
    .info-item {
        padding: 0.4rem 0.5rem;
    }
    
    .info-item span:first-child {
        font-size: 0.7rem;
    }
    
    .info-item strong {
        font-size: 0.75rem;
    }
    
    .contest-prize {
        padding: 0.6rem;
    }
    
    .prize-amount {
        font-size: 1rem;
    }
    
    .prize-label {
        font-size: 0.7rem;
    }
    
    .contest-actions {
        gap: 0.4rem;
    }
    
    .contest-action-btn {
        padding: 0.5rem 0.6rem;
        font-size: 0.75rem;
    }
}

/* Enhanced Placeholder Styles */
.contest-card.placeholder-glow .placeholder {
    background: linear-gradient(90deg, rgba(255,255,255,0.05) 25%, rgba(255,255,255,0.1) 50%, rgba(255,255,255,0.05) 75%);
    background-size: 200% 100%;
    animation: loading 1.5s infinite;
}

@keyframes loading {
    0% { background-position: 200% 0; }
    100% { background-position: -200% 0; }
}

/* Contest Tags */
.contest-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-top: 1rem;
}

.contest-tag {
    background: rgba(102, 126, 234, 0.15);
    color: #667eea;
    font-size: 0.75rem;
    font-weight: 600;
    padding: 0.25rem 0.75rem;
    border-radius: 20px;
    border: 1px solid rgba(102, 126, 234, 0.3);
    transition: all 0.3s ease;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.contest-tag:hover {
    background: rgba(102, 126, 234, 0.25);
    transform: translateY(-1px);
}

/* Progress Bar Enhancements */
.progress {
    height: 8px !important;
    background: rgba(255, 255, 255, 0.1) !important;
    border-radius: 10px !important;
    overflow: hidden !important;
    border: 1px solid rgba(255, 255, 255, 0.1) !important;
}

.progress-bar {
    background: linear-gradient(90deg, #667eea, #764ba2) !important;
    border-radius: 10px !important;
    transition: width 0.6s ease !important;
    position: relative !important;
    overflow: hidden !important;
}

.progress-bar::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
    animation: shimmer 2s infinite;
}

@keyframes shimmer {
    0% { transform: translateX(-100%); }
    100% { transform: translateX(100%); }
}

/* Button Enhancements */
.btn-disabled {
    background: linear-gradient(135deg, #6c757d, #5a6268) !important;
    color: rgba(255, 255, 255, 0.6) !important;
    cursor: not-allowed !important;
    opacity: 0.7 !important;
}

.btn-disabled:hover {
    transform: none !important;
    box-shadow: none !important;
}

/* Enhanced Hover Effects */
.contest-card {
    position: relative;
    overflow: hidden;
}

.contest-card::after {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.05), transparent);
    transition: left 0.6s ease;
}

.contest-card:hover::after {
    left: 100%;
}

/* Status Badge Enhancements */
.contest-status {
    position: relative;
    overflow: hidden;
}

.contest-status::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
    transition: left 0.5s ease;
}

.contest-status:hover::before {
    left: 100%;
}

/* Info Item Enhancements */
.info-item {
    position: relative;
    overflow: hidden;
}

.info-item::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 3px;
    height: 100%;
    background: linear-gradient(180deg, #667eea, #764ba2);
    opacity: 0;
    transition: opacity 0.3s ease;
}

.info-item:hover::before {
    opacity: 1;
}

/* Prize Section Enhancements */
.contest-prize {
    position: relative;
    overflow: hidden;
}

.contest-prize::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(circle at 30% 20%, rgba(102, 126, 234, 0.1) 0%, transparent 50%);
    pointer-events: none;
}

/* Animation for cards appearing */
.contest-card {
    animation: slideInUp 0.6s ease forwards;
    opacity: 0;
    transform: translateY(30px);
}

.contest-card:nth-child(1) { animation-delay: 0.1s; }
.contest-card:nth-child(2) { animation-delay: 0.2s; }
.contest-card:nth-child(3) { animation-delay: 0.3s; }
.contest-card:nth-child(4) { animation-delay: 0.4s; }
.contest-card:nth-child(5) { animation-delay: 0.5s; }

@keyframes slideInUp {
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Enhanced Mobile Styles */
@media (max-width: 480px) {
    .contest-card {
        margin: 0 0.5rem;
        border-radius: 16px;
    }
    
    .contest-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.75rem;
    }
    
    .contest-status {
        align-self: flex-start;
    }
    
    .contest-content {
        gap: 1rem;
    }
    
    .info-item {
        padding: 0.5rem;
    }
    
    .contest-actions {
        gap: 0.5rem;
    }
    
    .contest-action-btn {
        padding: 0.75rem 1rem;
        font-size: 0.85rem;
        min-width: 120px;
    }
    
    .contest-tags {
        gap: 0.375rem;
    }
    
    .contest-tag {
        font-size: 0.7rem;
        padding: 0.2rem 0.6rem;
    }
}

/* Additional Mobile Optimizations */
@media (max-width: 768px) {
    
    .contests-filter-tabs {
        flex-direction: column;
        gap: 0.75rem;
        margin-bottom: 1.5rem;
    }
    
    .filter-tab {
        padding: 1.25rem;
        text-align: center;
    }
    
    .tab-icon {
        width: 40px;
        height: 40px;
        font-size: 1rem;
    }
    
    .contest-card {
        padding: 1.5rem;
        border-radius: 16px;
        margin: 0 0.5rem;
    }
    
    .contest-title {
        font-size: 1.1rem;
        line-height: 1.4;
    }
    
    .contest-game {
        font-size: 0.85rem;
    }
    
    .contest-content {
        grid-template-columns: 1fr;
        gap: 1rem;
    }
    
    .contest-info {
        gap: 0.5rem;
    }
    
    .info-item {
        padding: 0.625rem;
        font-size: 0.8rem;
    }
    
    .contest-prize {
        padding: 1rem;
        text-align: center;
    }
    
    .prize-amount {
        font-size: 1.2rem;
    }
    
    .prize-label {
        font-size: 0.8rem;
    }
    
    .contest-actions {
        flex-direction: column;
        gap: 0.75rem;
    }
    
    .contest-action-btn {
        padding: 0.875rem 1rem;
        font-size: 0.9rem;
        min-width: 100%;
        justify-content: center;
    }
    
    .contest-tags {
        gap: 0.5rem;
        justify-content: center;
    }
    
    .contest-tag {
        font-size: 0.75rem;
        padding: 0.375rem 0.75rem;
    }
    
    .no-contests-message {
        padding: 2rem 1.5rem;
        margin: 0 0.5rem;
    }
    
    .no-contests-message i {
        font-size: 2.5rem;
    }
    
    .no-contests-message span {
        font-size: 1rem;
    }
    
    .no-contests-message small {
        font-size: 0.85rem;
    }
}

/* Landscape Mobile Optimizations */
@media (max-width: 768px) and (orientation: landscape) {
    
    .contests-filter-tabs {
        flex-direction: row;
        gap: 1rem;
    }
    
    .filter-tab {
        padding: 1rem;
    }
}

/* Accessibility and Focus States */
.contest-action-btn:focus,
.filter-tab:focus {
    outline: 2px solid var(--accent-color);
    outline-offset: 2px;
}

.contest-card:focus-within {
    outline: 2px solid var(--accent-color);
    outline-offset: 2px;
}

/* Modern Home Section Styles */







@keyframes loading {
    0% { background-position: -200% 0; }
    100% { background-position: 200% 0; }
}

/* Section Headers */
.section-header {
    text-align: center;
    margin-bottom: 2rem;
}

.section-title {
    font-size: 1.8rem;
    font-weight: 700;
    color: var(--text-primary);
    margin-bottom: 0.5rem;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.75rem;
}

.section-title i {
    color: var(--accent-color);
    font-size: 1.5rem;
}

.section-subtitle {
    color: var(--text-secondary);
    font-size: 1rem;
    margin: 0;
    opacity: 0.8;
}

/* Promotion Section */
.promotion-section {
    margin-bottom: 3rem;
}

.modern-swiper {
    border-radius: 20px;
    overflow: hidden;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
}

.promotion-card {
    background: linear-gradient(180deg, rgba(22,27,34,0.95), rgba(22,27,34,0.85));
    border-radius: 20px;
    overflow: hidden;
    height: 300px;
    position: relative;
}

.promotion-image-placeholder {
    width: 100%;
    height: 200px;
    background: linear-gradient(90deg, rgba(255,255,255,0.05) 25%, rgba(255,255,255,0.1) 50%, rgba(255,255,255,0.05) 75%);
    background-size: 200% 100%;
    animation: loading 1.5s infinite;
}

.promotion-content-placeholder {
    padding: 1.5rem;
}

.title-placeholder {
    height: 24px;
    background: rgba(255,255,255,0.1);
    border-radius: 6px;
    margin-bottom: 1rem;
    width: 80%;
}

.description-placeholder {
    height: 16px;
    background: rgba(255,255,255,0.08);
    border-radius: 4px;
    width: 60%;
}

/* Games Section */
.games-section {
    margin-bottom: 3rem;
}

.games-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 1.5rem;
}

.game-card {
    background: linear-gradient(180deg, rgba(22,27,34,0.95), rgba(22,27,34,0.85));
    border-radius: 20px;
    overflow: hidden;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
    transition: all 0.3s ease;
    border: 1px solid rgba(255, 255, 255, 0.08);
    position: relative;
}

.game-card:hover {
    transform: translateY(-8px);
    box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
    border-color: rgba(255, 255, 255, 0.15);
}

.game-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 3px;
    background: linear-gradient(90deg, #667eea, #764ba2, #f093fb);
    opacity: 0;
    transition: opacity 0.3s ease;
}

.game-card:hover::before {
    opacity: 1;
}

.game-image-placeholder {
    width: 100%;
    height: 180px;
    background: linear-gradient(90deg, rgba(255,255,255,0.05) 25%, rgba(255,255,255,0.1) 50%, rgba(255,255,255,0.05) 75%);
    background-size: 200% 100%;
    animation: loading 1.5s infinite;
}

.game-content-placeholder {
    padding: 1.5rem;
}

.game-title-placeholder {
    height: 20px;
    background: rgba(255,255,255,0.1);
    border-radius: 6px;
    margin-bottom: 1rem;
    width: 70%;
}

.game-stats-placeholder {
    height: 16px;
    background: rgba(255,255,255,0.08);
    border-radius: 4px;
    width: 50%;
}

/* Enhanced Game Card Styles */
.game-card .game-image {
    position: relative;
    overflow: hidden;
    border-radius: 20px 20px 0 0;
}

.game-card .game-image img {
    width: 100%;
    height: 180px;
    object-fit: cover;
    transition: transform 0.3s ease;
}

.game-card:hover .game-image img {
    transform: scale(1.05);
}

.game-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.4);
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.game-card:hover .game-overlay {
    opacity: 1;
}

.game-play-btn {
    width: 60px;
    height: 60px;
    background: linear-gradient(135deg, #667eea, #764ba2);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.5rem;
    box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
    transform: scale(0.8);
    transition: all 0.3s ease;
}

.game-card:hover .game-play-btn {
    transform: scale(1);
}

.game-content {
    padding: 1.5rem;
}

.game-title {
    font-size: 1.2rem;
    font-weight: 700;
    color: var(--text-primary);
    margin-bottom: 0.75rem;
    text-align: center;
}

.game-stats {
    display: flex;
    justify-content: space-between;
    gap: 0.5rem;
}

.game-mode,
.game-players {
    font-size: 0.8rem;
    color: var(--text-secondary);
    background: rgba(255, 255, 255, 0.05);
    padding: 0.25rem 0.5rem;
    border-radius: 12px;
    text-align: center;
    flex: 1;
}

/* Activity Item Styles */
.activity-avatar {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: linear-gradient(135deg, #667eea, #764ba2);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.activity-icon {
    font-size: 1.5rem;
}

.activity-content {
    flex: 1;
}

.activity-text {
    font-size: 0.9rem;
    color: var(--text-primary);
    margin-bottom: 0.25rem;
    font-weight: 500;
}

.activity-time {
    font-size: 0.8rem;
    color: var(--text-secondary);
    opacity: 0.8;
}



/* Mobile Responsiveness */
@media (max-width: 768px) {
    .hero-banner {
        padding: 2rem 1.5rem;
        margin-bottom: 2rem;
        border-radius: 20px;
    }
    

    

    

    

    
    .section-title {
        font-size: 1.5rem;
    }
    
    .games-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
    }
    

}

@media (max-width: 480px) {
    

    

    
    .section-title {
        font-size: 1.3rem;
    }
    
    .section-subtitle {
        font-size: 0.9rem;
    }
    

    
    .activity-item {
        padding: 1.25rem;
        flex-direction: column;
        text-align: center;
        gap: 0.75rem;
    }
    
    .activity-avatar-placeholder {
        width: 40px;
        height: 40px;
    }
}

/* Landscape Mobile Optimizations */
@media (max-width: 768px) and (orientation: landscape) {
    

    

}

/* High DPI Display Optimizations */
@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
    .stat-card {
        border-width: 0.5px;
    }
    
    .activity-item {
        border-width: 0.5px;
    }
}

/* Dark Mode Enhancements */
@media (prefers-color-scheme: dark) {
    
    .stat-card {
        background: linear-gradient(180deg, rgba(15,23,42,0.95), rgba(15,23,42,0.85));
    }
    
    .activity-item {
        background: linear-gradient(180deg, rgba(15,23,42,0.95), rgba(15,23,42,0.85));
    }
}

/* Reduced Motion Support */
@media (prefers-reduced-motion: reduce) {
    .game-card,
    .stat-card,
    .activity-item {
        animation: none;
        transition: none;
    }
    
    .game-card:hover,
    .stat-card:hover,
    .activity-item:hover {
        transform: none;
    }
}

/* Focus States for Accessibility */
.game-card:focus,
.stat-card:focus,
.activity-item:focus {
    outline: 2px solid var(--accent-color);
    outline-offset: 2px;
}

/* Print Styles */
@media print {
}

.contests-title-section {
    flex: 1;
}

.contests-title {
    color: white;
    font-size: 1.8rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.contests-subtitle {
    color: rgba(255,255,255,0.9);
    font-size: 1rem;
    margin: 0;
}

.contests-stats {
    display: flex;
    gap: 1rem;
}

.stat-badge {
    background: rgba(255,255,255,0.2);
    border-radius: 12px;
    padding: 0.75rem 1rem;
    text-align: center;
    backdrop-filter: blur(10px);
}

.stat-number {
    display: block;
    color: white;
    font-weight: 700;
    font-size: 1.2rem;
}

.stat-label {
    display: block;
    color: rgba(255,255,255,0.8);
    font-size: 0.8rem;
    margin-top: 0.25rem;
}

/* Filter Tabs */
.contests-filter-tabs {
    display: flex;
    gap: 1rem;
    margin-bottom: 2rem;
}

.filter-tab {
    flex: 1;
    background: linear-gradient(180deg, rgba(22,27,34,0.95), rgba(22,27,34,0.85));
    border-radius: 16px;
    padding: 1.5rem;
    border: 1px solid rgba(255, 255, 255, 0.08);
    text-decoration: none;
    color: var(--text-primary);
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 1rem;
    cursor: pointer;
}

.filter-tab:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0,0,0,0.3);
    text-decoration: none;
    color: var(--text-primary);
}

.filter-tab.active {
    background: linear-gradient(135deg, #3498db, #2980b9);
    border-color: rgba(52, 152, 219, 0.3);
}

.filter-tab.active .tab-icon {
    background: rgba(255,255,255,0.2);
}

.tab-icon {
    width: 45px;
    height: 45px;
    border-radius: 12px;
    background: rgba(255,255,255,0.1);
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-primary);
    font-size: 1.2rem;
}

.tab-content {
    flex: 1;
}

.tab-label {
    display: block;
    color: var(--text-primary);
    font-weight: 600;
    font-size: 1rem;
    margin-bottom: 0.25rem;
}

.tab-count {
    display: block;
    color: var(--text-secondary);
    font-size: 0.8rem;
    opacity: 0.8;
}

/* Contest Cards */
.contests-container {
    margin-bottom: 2rem;
}

.contests-grid {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.contest-card {
    background: linear-gradient(180deg, rgba(22,27,34,0.95), rgba(22,27,34,0.85));
    border-radius: 16px;
    padding: 1.5rem;
    border: 1px solid rgba(255, 255, 255, 0.08);
    transition: all 0.3s ease;
}

.contest-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0,0,0,0.3);
}

.contest-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 1rem;
}

.contest-title-section {
    flex: 1;
}

.contest-title {
    color: var(--text-primary);
    font-weight: 600;
    font-size: 1.1rem;
    margin-bottom: 0.25rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.contest-game {
    color: var(--text-secondary);
    font-size: 0.85rem;
    opacity: 0.8;
}

.contest-status {
    padding: 0.5rem 1rem;
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 600;
    text-align: center;
}

.status-active {
    background: linear-gradient(135deg, #2ed573, #1e90ff);
    color: white;
}

.status-completed {
    background: linear-gradient(135deg, #ffa502, #ff6348);
    color: white;
}

.contest-content {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
    margin-bottom: 1.5rem;
}

.contest-info {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.info-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: var(--text-secondary);
    font-size: 0.85rem;
}

.info-item i {
    color: var(--accent-color);
    font-size: 0.9rem;
}

.contest-prize {
    background: rgba(255,255,255,0.05);
    border-radius: 12px;
    padding: 1rem;
    text-align: center;
}

.prize-amount {
    color: var(--accent-color);
    font-weight: 700;
    font-size: 1.2rem;
    margin-bottom: 0.25rem;
}

.prize-label {
    color: var(--text-secondary);
    font-size: 0.8rem;
    opacity: 0.8;
}

.contest-actions {
    display: flex;
    gap: 1rem;
}

.contest-action-btn {
    flex: 1;
    padding: 0.75rem 1rem;
    border-radius: 12px;
    border: none;
    font-weight: 600;
    font-size: 0.9rem;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    cursor: pointer;
}

.btn-view-players {
    background: linear-gradient(135deg, #3498db, #2980b9);
    color: white;
}

.btn-view-players:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
}

.btn-joined {
    background: linear-gradient(135deg, #2ed573, #1e90ff);
    color: white;
}

.btn-joined:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 15px rgba(46, 213, 115, 0.3);
}

/* Contest Card Placeholders */
.contest-card-placeholder {
    background: linear-gradient(180deg, rgba(22,27,34,0.95), rgba(22,27,34,0.85));
    border-radius: 16px;
    padding: 1.5rem;
    border: 1px solid rgba(255, 255, 255, 0.08);
}

.contest-header-placeholder {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 1rem;
}

.contest-title-placeholder {
    height: 20px;
    background: rgba(255,255,255,0.1);
    border-radius: 4px;
    width: 60%;
}

.contest-status-placeholder {
    height: 30px;
    background: rgba(255,255,255,0.1);
    border-radius: 15px;
    width: 80px;
}

.contest-content-placeholder {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
    margin-bottom: 1.5rem;
}

.contest-info-placeholder {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.contest-info-placeholder > div {
    height: 16px;
    background: rgba(255,255,255,0.05);
    border-radius: 4px;
    width: 80%;
}

.contest-prize-placeholder {
    background: rgba(255,255,255,0.05);
    border-radius: 12px;
    padding: 1rem;
    height: 60px;
}

.contest-actions-placeholder {
    display: flex;
    gap: 1rem;
}

.action-button-placeholder {
    flex: 1;
    height: 40px;
    background: rgba(255,255,255,0.1);
    border-radius: 12px;
}

/* Empty State */
.empty-state {
    text-align: center;
    padding: 3rem 1rem;
}

.empty-state-icon {
    width: 80px;
    height: 80px;
    background: linear-gradient(135deg, #667eea, #764ba2);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 1.5rem;
    color: white;
    font-size: 2rem;
}

.empty-state-title {
    color: var(--text-primary);
    font-weight: 600;
    font-size: 1.3rem;
    margin-bottom: 0.5rem;
}

.empty-state-subtitle {
    color: var(--text-secondary);
    font-size: 0.9rem;
    margin-bottom: 2rem;
}

.empty-state-action {
    background: linear-gradient(135deg, #3498db, #2980b9);
    color: white;
    text-decoration: none;
    padding: 0.75rem 1.5rem;
    border-radius: 12px;
    font-weight: 600;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    transition: all 0.3s ease;
}

.empty-state-action:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(52, 152, 219, 0.3);
    text-decoration: none;
    color: white;
}

/* Mobile Responsive */
@media (max-width: 768px) {

    .contests-filter-tabs {
        gap: 0.75rem;
        margin-bottom: 1.5rem;
    }

    .filter-tab {
        padding: 1.25rem;
    }

    .tab-icon {
        width: 40px;
        height: 40px;
        font-size: 1.1rem;
    }

    .tab-label {
        font-size: 0.95rem;
    }

    .contest-card {
        padding: 1.25rem;
    }

    .contest-content {
        grid-template-columns: 1fr;
        gap: 0.75rem;
    }

    .contest-actions {
        flex-direction: column;
        gap: 0.75rem;
    }

    .contest-action-btn {
        padding: 0.875rem 1rem;
    }

    .empty-state {
        padding: 2rem 1rem;
    }

    .empty-state-icon {
        width: 70px;
        height: 70px;
        font-size: 1.8rem;
    }

    .empty-state-title {
        font-size: 1.2rem;
    }
}

/* Modern Leaderboard Design */
.leaderboard-header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: 20px;
    padding: 2rem;
    margin-bottom: 2rem;
    position: relative;
    overflow: hidden;
}

.leaderboard-header::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(45deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
    pointer-events: none;
}

.leaderboard-header-content {
    display: flex;
    align-items: center;
    justify-content: space-between;
    position: relative;
    z-index: 1;
}

.leaderboard-title-section {
    flex: 1;
}

.leaderboard-title {
    color: white;
    font-size: 1.8rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.leaderboard-subtitle {
    color: rgba(255,255,255,0.9);
    font-size: 1rem;
    margin: 0;
}

.leaderboard-stats {
    display: flex;
    gap: 1rem;
}

.leaderboard-stats .stat-badge {
    background: rgba(255,255,255,0.2);
    border-radius: 12px;
    padding: 0.75rem 1rem;
    text-align: center;
    backdrop-filter: blur(10px);
}

.leaderboard-stats .stat-number {
    display: block;
    color: white;
    font-weight: 700;
    font-size: 1.2rem;
}

.leaderboard-stats .stat-label {
    display: block;
    color: rgba(255,255,255,0.8);
    font-size: 0.8rem;
    margin-top: 0.25rem;
}

/* Leaderboard Filter Tabs */
.leaderboard-filter-tabs {
    display: flex;
    gap: 1rem;
    margin-bottom: 2rem;
}

.leaderboard-filter-tabs .filter-tab {
    flex: 1;
    background: linear-gradient(180deg, rgba(22,27,34,0.95), rgba(22,27,34,0.85));
    border-radius: 16px;
    padding: 1.5rem;
    border: 1px solid rgba(255, 255, 255, 0.08);
    text-decoration: none;
    color: var(--text-primary);
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 1rem;
    cursor: pointer;
}

.leaderboard-filter-tabs .filter-tab:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0,0,0,0.3);
    text-decoration: none;
    color: var(--text-primary);
}

.leaderboard-filter-tabs .filter-tab.active {
    background: linear-gradient(135deg, #f39c12, #e67e22);
    border-color: rgba(243, 156, 18, 0.3);
}

.leaderboard-filter-tabs .filter-tab.active .tab-icon {
    background: rgba(255,255,255,0.2);
}

.leaderboard-filter-tabs .tab-icon {
    width: 45px;
    height: 45px;
    border-radius: 12px;
    background: rgba(255,255,255,0.1);
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-primary);
    font-size: 1.2rem;
}

.leaderboard-filter-tabs .tab-content {
    flex: 1;
}

.leaderboard-filter-tabs .tab-label {
    display: block;
    color: var(--text-primary);
    font-weight: 600;
    font-size: 1rem;
    margin-bottom: 0.25rem;
}

.leaderboard-filter-tabs .tab-desc {
    display: block;
    color: var(--text-secondary);
    font-size: 0.8rem;
    opacity: 0.8;
}

/* Leaderboard Container */
.leaderboard-container {
    margin-bottom: 2rem;
}

.leaderboard-list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.leaderboard-item {
    background: linear-gradient(180deg, rgba(22,27,34,0.95), rgba(22,27,34,0.85));
    border-radius: 16px;
    padding: 1.5rem;
    border: 1px solid rgba(255, 255, 255, 0.08);
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 1rem;
}

.leaderboard-item:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0,0,0,0.3);
}

.leaderboard-item.rank-1 {
    background: linear-gradient(135deg, #ffd700, #ffed4e);
    border-color: rgba(255, 215, 0, 0.3);
}

.leaderboard-item.rank-2 {
    background: linear-gradient(135deg, #c0c0c0, #e5e5e5);
    border-color: rgba(192, 192, 192, 0.3);
}

.leaderboard-item.rank-3 {
    background: linear-gradient(135deg, #cd7f32, #daa520);
    border-color: rgba(205, 127, 50, 0.3);
}

.rank-badge {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    font-size: 1.2rem;
    color: white;
    flex-shrink: 0;
}

.rank-1 .rank-badge {
    background: linear-gradient(135deg, #ffd700, #ffed4e);
    color: #000;
}

.rank-2 .rank-badge {
    background: linear-gradient(135deg, #c0c0c0, #e5e5e5);
    color: #000;
}

.rank-3 .rank-badge {
    background: linear-gradient(135deg, #cd7f32, #daa520);
    color: white;
}

.rank-other .rank-badge {
    background: linear-gradient(135deg, #6c757d, #495057);
    color: white;
}

.player-info {
    flex: 1;
    display: flex;
    align-items: center;
    gap: 1rem;
}

.player-avatar {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: linear-gradient(135deg, #3498db, #2980b9);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: 600;
    font-size: 1.2rem;
    flex-shrink: 0;
}

.player-details {
    flex: 1;
}

.player-name {
    color: var(--text-primary);
    font-weight: 600;
    font-size: 1.1rem;
    margin-bottom: 0.25rem;
}

.player-stats {
    color: var(--text-secondary);
    font-size: 0.85rem;
    opacity: 0.8;
}

.player-score {
    text-align: right;
    flex-shrink: 0;
}

.score-amount {
    color: var(--accent-color);
    font-weight: 700;
    font-size: 1.2rem;
    margin-bottom: 0.25rem;
}

.score-label {
    color: var(--text-secondary);
    font-size: 0.8rem;
    opacity: 0.8;
}

/* Leaderboard Item Placeholders */
.leaderboard-item-placeholder {
    background: linear-gradient(180deg, rgba(22,27,34,0.95), rgba(22,27,34,0.85));
    border-radius: 16px;
    padding: 1.5rem;
    border: 1px solid rgba(255, 255, 255, 0.08);
    display: flex;
    align-items: center;
    gap: 1rem;
}

.rank-placeholder {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: rgba(255,255,255,0.1);
    flex-shrink: 0;
}

.player-info-placeholder {
    flex: 1;
    display: flex;
    align-items: center;
    gap: 1rem;
}

.avatar-placeholder {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: rgba(255,255,255,0.1);
    flex-shrink: 0;
}

.details-placeholder {
    flex: 1;
}

.name-placeholder {
    height: 18px;
    background: rgba(255,255,255,0.1);
    border-radius: 4px;
    width: 60%;
    margin-bottom: 0.5rem;
}

.stats-placeholder {
    height: 14px;
    background: rgba(255,255,255,0.05);
    border-radius: 4px;
    width: 80%;
}

.score-placeholder {
    width: 80px;
    height: 30px;
    background: rgba(255,255,255,0.1);
    border-radius: 8px;
    flex-shrink: 0;
}

/* Empty State */
.leaderboard-container .empty-state {
    text-align: center;
    padding: 3rem 1rem;
}

.leaderboard-container .empty-state-icon {
    width: 80px;
    height: 80px;
    background: linear-gradient(135deg, #667eea, #764ba2);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 1.5rem;
    color: white;
    font-size: 2rem;
}

.leaderboard-container .empty-state-title {
    color: var(--text-primary);
    font-weight: 600;
    font-size: 1.3rem;
    margin-bottom: 0.5rem;
}

.leaderboard-container .empty-state-subtitle {
    color: var(--text-secondary);
    font-size: 0.9rem;
    margin-bottom: 2rem;
}

.leaderboard-container .empty-state-action {
    background: linear-gradient(135deg, #f39c12, #e67e22);
    color: white;
    text-decoration: none;
    padding: 0.75rem 1.5rem;
    border-radius: 12px;
    font-weight: 600;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    transition: all 0.3s ease;
}

.leaderboard-container .empty-state-action:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(243, 156, 18, 0.3);
    text-decoration: none;
    color: white;
}

/* Mobile Responsive */
@media (max-width: 768px) {
    .leaderboard-header {
        padding: 1.5rem;
        margin-bottom: 1.5rem;
    }

    .leaderboard-title {
        font-size: 1.5rem;
    }

    .leaderboard-subtitle {
        font-size: 0.9rem;
    }

    .leaderboard-stats {
        gap: 0.75rem;
    }

    .leaderboard-stats .stat-badge {
        padding: 0.5rem 0.75rem;
    }

    .leaderboard-stats .stat-number {
        font-size: 1.1rem;
    }

    .leaderboard-filter-tabs {
        gap: 0.75rem;
        margin-bottom: 1.5rem;
    }

    .leaderboard-filter-tabs .filter-tab {
        padding: 1.25rem;
    }

    .leaderboard-filter-tabs .tab-icon {
        width: 40px;
        height: 40px;
        font-size: 1.1rem;
    }

    .leaderboard-filter-tabs .tab-label {
        font-size: 0.95rem;
    }

    .leaderboard-item {
        padding: 1.25rem;
    }

    .rank-badge {
        width: 45px;
        height: 45px;
        font-size: 1.1rem;
    }

    .player-avatar {
        width: 45px;
        height: 45px;
        font-size: 1.1rem;
    }

    .player-name {
        font-size: 1rem;
    }

    .score-amount {
        font-size: 1.1rem;
    }

    .leaderboard-container .empty-state {
        padding: 2rem 1rem;
    }

    .leaderboard-container .empty-state-icon {
        width: 70px;
        height: 70px;
        font-size: 1.8rem;
    }

    .leaderboard-container .empty-state-title {
        font-size: 1.2rem;
    }
}

/* Modern Tournaments Design */
.tournaments-header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: 20px;
    padding: 2rem;
    margin-bottom: 2rem;
    position: relative;
    overflow: hidden;
}

.tournaments-header::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(45deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
    pointer-events: none;
}

.tournaments-header-content {
    display: flex;
    align-items: center;
    justify-content: space-between;
    position: relative;
    z-index: 1;
}

.tournaments-title-section {
    flex: 1;
}

.tournaments-title {
    color: white;
    font-size: 1.8rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.tournaments-subtitle {
    color: rgba(255,255,255,0.9);
    font-size: 1rem;
    margin: 0;
}

.tournaments-stats {
    display: flex;
    gap: 1rem;
}

.tournaments-stats .stat-badge {
    background: rgba(255,255,255,0.2);
    border-radius: 12px;
    padding: 0.75rem 1rem;
    text-align: center;
    backdrop-filter: blur(10px);
}

.tournaments-stats .stat-number {
    display: block;
    color: white;
    font-weight: 700;
    font-size: 1.2rem;
}

.tournaments-stats .stat-label {
    display: block;
    color: rgba(255,255,255,0.8);
    font-size: 0.8rem;
    margin-top: 0.25rem;
}

/* Tournament Filter Tabs */
.tournaments-filter-tabs {
    display: flex;
    gap: 1rem;
    margin-bottom: 2rem;
}

.tournaments-filter-tabs .filter-tab {
    flex: 1;
    background: linear-gradient(180deg, rgba(22,27,34,0.95), rgba(22,27,34,0.85));
    border-radius: 16px;
    padding: 1.5rem;
    border: 1px solid rgba(255, 255, 255, 0.08);
    text-decoration: none;
    color: var(--text-primary);
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 1rem;
    cursor: pointer;
}

.tournaments-filter-tabs .filter-tab:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0,0,0,0.3);
    text-decoration: none;
    color: var(--text-primary);
}

.tournaments-filter-tabs .filter-tab.active {
    background: linear-gradient(135deg, #2ed573, #1e90ff);
    border-color: rgba(46, 213, 115, 0.3);
}

.tournaments-filter-tabs .filter-tab.active .tab-icon {
    background: rgba(255,255,255,0.2);
}

.tournaments-filter-tabs .tab-icon {
    width: 45px;
    height: 45px;
    border-radius: 12px;
    background: rgba(255,255,255,0.1);
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-primary);
    font-size: 1.2rem;
}

.tournaments-filter-tabs .tab-content {
    flex: 1;
}

.tournaments-filter-tabs .tab-label {
    display: block;
    color: var(--text-primary);
    font-weight: 600;
    font-size: 1rem;
    margin-bottom: 0.25rem;
}

.tournaments-filter-tabs .tab-desc {
    display: block;
    color: var(--text-secondary);
    font-size: 0.8rem;
    opacity: 0.8;
}

/* Game Filters */
.game-filters-section {
    margin-bottom: 2rem;
}

.game-filters-container {
    background: linear-gradient(180deg, rgba(22,27,34,0.95), rgba(22,27,34,0.85));
    border-radius: 16px;
    padding: 1.5rem;
    border: 1px solid rgba(255, 255, 255, 0.08);
}

.game-filters-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 0.75rem;
}

.game-filter-btn {
    background: rgba(255,255,255,0.05);
    border: 1px solid rgba(255,255,255,0.08);
    border-radius: 20px;
    padding: 0.5rem 1rem;
    color: var(--text-primary);
    font-size: 0.85rem;
    font-weight: 500;
    transition: all 0.3s ease;
    cursor: pointer;
}

.game-filter-btn:hover {
    background: rgba(255,255,255,0.1);
    transform: translateY(-1px);
}

.game-filter-btn.active {
    background: linear-gradient(135deg, #3498db, #2980b9);
    border-color: rgba(52, 152, 219, 0.3);
    color: white;
}

/* Tournaments Container */
.tournaments-container {
    margin-bottom: 2rem;
}

.tournaments-grid {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.tournament-card {
    background: linear-gradient(180deg, rgba(22,27,34,0.95), rgba(22,27,34,0.85));
    border-radius: 16px;
    padding: 1.5rem;
    border: 1px solid rgba(255, 255, 255, 0.08);
    transition: all 0.3s ease;
}

.tournament-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0,0,0,0.3);
}

.tournament-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 1rem;
}

.tournament-title-section {
    flex: 1;
}

.tournament-title {
    color: var(--text-primary);
    font-weight: 600;
    font-size: 1.1rem;
    margin-bottom: 0.25rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.tournament-game {
    color: var(--text-secondary);
    font-size: 0.85rem;
    opacity: 0.8;
}

.tournament-status {
    padding: 0.5rem 1rem;
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 600;
    text-align: center;
}

.status-upcoming {
    background: linear-gradient(135deg, #ffd700, #ffed4e);
    color: #000;
}

.status-ongoing {
    background: linear-gradient(135deg, #ff4757, #ff3742);
    color: white;
}

.status-completed {
    background: linear-gradient(135deg, #2ed573, #1e90ff);
    color: white;
}

.tournament-content {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
    margin-bottom: 1.5rem;
}

.tournament-info {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.info-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: var(--text-secondary);
    font-size: 0.85rem;
}

.info-item i {
    color: var(--accent-color);
    font-size: 0.9rem;
}

.tournament-prize {
    background: rgba(255,255,255,0.05);
    border-radius: 12px;
    padding: 1rem;
    text-align: center;
}

.prize-amount {
    color: var(--accent-color);
    font-weight: 700;
    font-size: 1.2rem;
    margin-bottom: 0.25rem;
}

.prize-label {
    color: var(--text-secondary);
    font-size: 0.8rem;
    opacity: 0.8;
}

.tournament-actions {
    display: flex;
    gap: 1rem;
}

.tournament-action-btn {
    flex: 1;
    padding: 0.75rem 1rem;
    border-radius: 12px;
    border: none;
    font-weight: 600;
    font-size: 0.9rem;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    cursor: pointer;
}

.btn-view-players {
    background: linear-gradient(135deg, #3498db, #2980b9);
    color: white;
}

.btn-view-players:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
}

.btn-join {
    background: linear-gradient(135deg, #2ed573, #1e90ff);
    color: white;
}

.btn-join:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 15px rgba(46, 213, 115, 0.3);
}

.btn-joined {
    background: linear-gradient(135deg, #2ed573, #1e90ff);
    color: white;
    opacity: 0.8;
}

.btn-joined:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 15px rgba(46, 213, 115, 0.3);
}

.btn-disabled {
    background: linear-gradient(135deg, #6c757d, #495057);
    color: white;
    opacity: 0.6;
    cursor: not-allowed;
}

/* Tournament Card Placeholders */
.tournament-card-placeholder {
    background: linear-gradient(180deg, rgba(22,27,34,0.95), rgba(22,27,34,0.85));
    border-radius: 16px;
    padding: 1.5rem;
    border: 1px solid rgba(255, 255, 255, 0.08);
}

.tournament-header-placeholder {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 1rem;
}

.tournament-title-placeholder {
    height: 20px;
    background: rgba(255,255,255,0.1);
    border-radius: 4px;
    width: 60%;
}

.tournament-status-placeholder {
    height: 30px;
    background: rgba(255,255,255,0.1);
    border-radius: 15px;
    width: 80px;
}

.tournament-content-placeholder {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
    margin-bottom: 1.5rem;
}

.tournament-info-placeholder {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.tournament-info-placeholder > div {
    height: 16px;
    background: rgba(255,255,255,0.05);
    border-radius: 4px;
    width: 80%;
}

.tournament-prize-placeholder {
    background: rgba(255,255,255,0.05);
    border-radius: 12px;
    padding: 1rem;
    height: 60px;
}

.tournament-actions-placeholder {
    display: flex;
    gap: 1rem;
}

.action-button-placeholder {
    flex: 1;
    height: 40px;
    background: rgba(255,255,255,0.1);
    border-radius: 12px;
}

/* Empty State */
.tournaments-container .empty-state {
    text-align: center;
    padding: 3rem 1rem;
}

.tournaments-container .empty-state-icon {
    width: 80px;
    height: 80px;
    background: linear-gradient(135deg, #667eea, #764ba2);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 1.5rem;
    color: white;
    font-size: 2rem;
}

.tournaments-container .empty-state-title {
    color: var(--text-primary);
    font-weight: 600;
    font-size: 1.3rem;
    margin-bottom: 0.5rem;
}

.tournaments-container .empty-state-subtitle {
    color: var(--text-secondary);
    font-size: 0.9rem;
    margin-bottom: 2rem;
}

.tournaments-container .empty-state-action {
    background: linear-gradient(135deg, #2ed573, #1e90ff);
    color: white;
    text-decoration: none;
    padding: 0.75rem 1.5rem;
    border-radius: 12px;
    font-weight: 600;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    transition: all 0.3s ease;
}

.tournaments-container .empty-state-action:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(46, 213, 115, 0.3);
    text-decoration: none;
    color: white;
}

/* Mobile Responsive */
@media (max-width: 768px) {
    .tournaments-header {
        padding: 1.5rem;
        margin-bottom: 1.5rem;
    }

    .tournaments-title {
        font-size: 1.5rem;
    }

    .tournaments-subtitle {
        font-size: 0.9rem;
    }

    .tournaments-stats {
        gap: 0.75rem;
    }

    .tournaments-stats .stat-badge {
        padding: 0.5rem 0.75rem;
    }

    .tournaments-stats .stat-number {
        font-size: 1.1rem;
    }

    .tournaments-filter-tabs {
        gap: 0.75rem;
        margin-bottom: 1.5rem;
    }

    .tournaments-filter-tabs .filter-tab {
        padding: 1.25rem;
    }

    .tournaments-filter-tabs .tab-icon {
        width: 40px;
        height: 40px;
        font-size: 1.1rem;
    }

    .tournaments-filter-tabs .tab-label {
        font-size: 0.95rem;
    }

    .game-filters-container {
        padding: 1.25rem;
    }

    .game-filters-grid {
        gap: 0.5rem;
    }

    .game-filter-btn {
        padding: 0.4rem 0.8rem;
        font-size: 0.8rem;
    }

    .tournament-card {
        padding: 1.25rem;
    }

    .tournament-content {
        grid-template-columns: 1fr;
        gap: 0.75rem;
    }

    .tournament-actions {
        flex-direction: column;
        gap: 0.75rem;
    }

    .tournament-action-btn {
        padding: 0.875rem 1rem;
    }

    .tournaments-container .empty-state {
        padding: 2rem 1rem;
    }

    .tournaments-container .empty-state-icon {
        width: 70px;
        height: 70px;
        font-size: 1.8rem;
    }

    .tournaments-container .empty-state-title {
        font-size: 1.2rem;
    }
}

/* Modern Prize Pool Section Design */
.prize-pool-section {
    background: linear-gradient(180deg, rgba(22,27,34,0.95), rgba(22,27,34,0.85));
    border-radius: 16px;
    padding: 1.5rem;
    border: 1px solid rgba(255, 255, 255, 0.08);
    margin-bottom: 1.5rem;
}

.prize-pool-content {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

.prize-pool-main {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 2rem;
    padding: 1rem;
    background: rgba(255,255,255,0.05);
    border-radius: 12px;
    border: 1px solid rgba(255,255,255,0.08);
}

.prize-pool-amount {
    text-align: center;
    flex-shrink: 0;
}

.prize-amount {
    display: block;
    color: var(--accent-color);
    font-weight: 700;
    font-size: 2rem;
    margin-bottom: 0.25rem;
}

.prize-label {
    display: block;
    color: var(--text-secondary);
    font-size: 0.9rem;
    opacity: 0.8;
}

.prize-description {
    flex: 1;
}

.prize-subtitle {
    color: var(--text-primary);
    font-weight: 600;
    font-size: 1rem;
    margin-bottom: 0.75rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.prize-subtitle::before {
    content: '';
    width: 4px;
    height: 16px;
    background: linear-gradient(135deg, var(--accent-color), #FBBF24);
    border-radius: 2px;
}

.prize-description-content {
    color: var(--text-secondary);
    font-size: 0.9rem;
    line-height: 1.5;
}

.prize-breakdown-details {
    padding: 1rem;
    background: rgba(255,255,255,0.03);
    border-radius: 12px;
    border: 1px solid rgba(255,255,255,0.05);
}

.prize-breakdown-content {
    color: var(--text-secondary);
    font-size: 0.9rem;
    line-height: 1.6;
}

.prize-breakdown {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.prize-breakdown > div {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.5rem 0;
    border-bottom: 1px solid rgba(255,255,255,0.05);
}

.prize-breakdown > div:last-child {
    border-bottom: none;
}

.prize-breakdown .rank {
    color: var(--text-primary);
    font-weight: 600;
}

.prize-breakdown .amount {
    color: var(--accent-color);
    font-weight: 700;
}

.balance-label {
    color: var(--text-primary);
    font-weight: 600;
    font-size: 1rem;
    margin-bottom: 0.25rem;
}

.balance-amount {
    color: var(--accent-color);
    font-weight: 700;
    font-size: 1.5rem;
}

.balance-card-action {
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.btn-history, .btn-withdraw {
    padding: 0.5rem 1rem;
    border-radius: 8px;
    border: none;
    font-weight: 600;
    font-size: 0.9rem;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    cursor: pointer;
}

.btn-history {
    background: rgba(255,255,255,0.1);
    color: var(--text-primary);
}

.btn-history:hover {
    background: rgba(255,255,255,0.15);
    transform: translateY(-1px);
}

.btn-withdraw {
    background: linear-gradient(135deg, #2ed573, #1e90ff);
    color: white;
}

.btn-withdraw:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 15px rgba(46, 213, 115, 0.3);
}

.bonus-info {
    color: var(--text-secondary);
    font-size: 0.8rem;
    opacity: 0.8;
}

/* Quick Actions */
.quick-actions-section {
    margin-bottom: 2rem;
}

.btn-add-amount {
    width: 100%;
    padding: 1rem 1.5rem;
    background: linear-gradient(135deg, #667eea, #764ba2);
    border: none;
    border-radius: 12px;
    color: white;
    font-weight: 600;
    font-size: 1rem;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    transition: all 0.3s ease;
    cursor: pointer;
}

.btn-add-amount:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
    color: white;
}

/* Transactions Section */
.transactions-section {
    background: linear-gradient(180deg, rgba(22,27,34,0.95), rgba(22,27,34,0.85));
    border-radius: 16px;
    padding: 1.5rem;
    border: 1px solid rgba(255, 255, 255, 0.08);
}

.transactions-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 1.5rem;
}

.transactions-title {
    color: var(--text-primary);
    font-weight: 600;
    font-size: 1.2rem;
    margin: 0;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.transactions-count {
    color: var(--text-secondary);
    font-size: 0.9rem;
    opacity: 0.8;
}

.transactions-container {
    position: relative;
}

.transactions-list {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
}

/* Transaction Card Placeholder */
.transaction-card-placeholder {
    background: rgba(255,255,255,0.05);
    border-radius: 12px;
    padding: 1rem;
    border: 1px solid rgba(255,255,255,0.08);
}

.transaction-header-placeholder {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.transaction-icon-placeholder {
    width: 40px;
    height: 40px;
    background: rgba(255,255,255,0.1);
    border-radius: 8px;
}

.transaction-info-placeholder {
    flex: 1;
}

.transaction-title-placeholder {
    height: 16px;
    background: rgba(255,255,255,0.1);
    border-radius: 4px;
    width: 60%;
    margin-bottom: 0.5rem;
}

.transaction-subtitle-placeholder {
    height: 14px;
    background: rgba(255,255,255,0.05);
    border-radius: 4px;
    width: 40%;
}

.transaction-amount-placeholder {
    height: 20px;
    background: rgba(255,255,255,0.1);
    border-radius: 4px;
    width: 80px;
}

/* Empty Transactions */
.empty-transactions {
    text-align: center;
    padding: 3rem 1rem;
}

.empty-icon {
    width: 80px;
    height: 80px;
    background: linear-gradient(135deg, #667eea, #764ba2);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 1.5rem;
    color: white;
    font-size: 2rem;
}

.empty-title {
    color: var(--text-primary);
    font-weight: 600;
    font-size: 1.3rem;
    margin-bottom: 0.5rem;
}

.empty-subtitle {
    color: var(--text-secondary);
    font-size: 0.9rem;
    margin: 0;
}

        /* Wallet Header Styles */
        .wallet-header {
            background: linear-gradient(135deg, rgba(88, 166, 255, 0.1), rgba(102, 126, 234, 0.1));
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid rgba(88, 166, 255, 0.2);
            position: relative;
            overflow: hidden;
            animation: slideInFromTop 0.6s ease-out;
        }

        .wallet-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(88, 166, 255, 0.05), rgba(102, 126, 234, 0.05));
            border-radius: 20px;
        }

        @keyframes slideInFromTop {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .wallet-header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            z-index: 1;
        }

        .wallet-title-section {
            flex: 1;
        }

        .wallet-title {
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, #58a6ff, #667eea);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .wallet-subtitle {
            color: var(--text-secondary);
            font-size: 1rem;
            margin: 0;
            opacity: 0.9;
        }

        .wallet-header-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #58a6ff, #667eea);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2.5rem;
            box-shadow: 0 8px 32px rgba(88, 166, 255, 0.3);
        }

        /* Balance Cards Grid */
        .balance-cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .balance-card {
            background: linear-gradient(145deg, var(--card-bg), var(--secondary-bg));
            border-radius: 20px;
            padding: 1.5rem;
            border: 1px solid var(--border-color);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            animation: fadeInUp 0.6s ease-out;
        }

        .balance-card:nth-child(1) { animation-delay: 0.1s; }
        .balance-card:nth-child(2) { animation-delay: 0.2s; }
        .balance-card:nth-child(3) { animation-delay: 0.3s; }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .balance-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--accent-color), #667eea);
        }

        .balance-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 16px 48px rgba(0, 0, 0, 0.3);
            border-color: var(--accent-color);
        }

        .balance-card.deposit-card::before {
            background: linear-gradient(90deg, #10b981, #059669);
        }

        .balance-card.winning-card::before {
            background: linear-gradient(90deg, #f59e0b, #d97706);
        }

        .balance-card.bonus-card::before {
            background: linear-gradient(90deg, #8b5cf6, #7c3aed);
        }

        .balance-card-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .balance-icon {
            width: 60px;
            height: 60px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            color: white;
            flex-shrink: 0;
        }

        .deposit-card .balance-icon {
            background: linear-gradient(135deg, #10b981, #059669);
        }

        .winning-card .balance-icon {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }

        .bonus-card .balance-icon {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
        }

        .balance-info {
            flex: 1;
        }

        .balance-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .balance-amount {
            color: var(--text-primary);
            font-weight: 800;
            font-size: 2rem;
            margin: 0;
            line-height: 1;
        }

        .balance-card-action {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .btn-history, .btn-withdraw {
            padding: 0.75rem 1.5rem;
            border-radius: 12px;
            border: none;
            font-weight: 600;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-history {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .btn-history:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .btn-withdraw {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
        }

        .btn-withdraw:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
            filter: brightness(1.1);
        }

        .bonus-info {
            color: var(--text-secondary);
            font-size: 0.8rem;
            opacity: 0.8;
            font-style: italic;
        }

        /* Quick Actions */
        .quick-actions-section {
            margin-bottom: 2rem;
        }

        .quick-actions-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .btn-add-amount, .btn-send-money {
            width: 100%;
            padding: 1.25rem 1.5rem;
            border: none;
            border-radius: 16px;
            color: white;
            font-weight: 700;
            font-size: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            transition: all 0.3s ease;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            position: relative;
            overflow: hidden;
        }

        .btn-add-amount {
            background: linear-gradient(135deg, #667eea, #764ba2);
            box-shadow: 0 8px 32px rgba(102, 126, 234, 0.3);
        }

        .btn-send-money {
            background: linear-gradient(135deg, #10b981, #059669);
            box-shadow: 0 8px 32px rgba(16, 185, 129, 0.3);
        }

        .btn-add-amount::before, .btn-send-money::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }

        .btn-add-amount:hover::before, .btn-send-money:hover::before {
            left: 100%;
        }

        .btn-add-amount:hover, .btn-send-money:hover {
            transform: translateY(-3px);
            color: white;
        }

        .btn-add-amount:hover {
            box-shadow: 0 12px 40px rgba(102, 126, 234, 0.4);
        }

        .btn-send-money:hover {
            box-shadow: 0 12px 40px rgba(16, 185, 129, 0.4);
        }

        /* Quick Stats */
        .quick-stats-section {
            margin-bottom: 2rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .stat-card {
            background: linear-gradient(145deg, var(--card-bg), var(--secondary-bg));
            border-radius: 16px;
            padding: 1.25rem;
            border: 1px solid var(--border-color);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.25);
            border-color: var(--accent-color);
        }

        .stat-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            background: linear-gradient(135deg, var(--accent-color), #667eea);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.3rem;
            flex-shrink: 0;
        }

        .stat-content {
            flex: 1;
        }

        .stat-value {
            color: var(--text-primary);
            font-weight: 800;
            font-size: 1.5rem;
            margin: 0 0 0.25rem 0;
            line-height: 1;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.85rem;
            margin: 0;
            opacity: 0.8;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Floating Action Button */
        .fab-container {
            position: fixed;
            bottom: 90px;
            right: 20px;
            z-index: 1000;
        }

        .fab-button {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(102, 126, 234, 0.4);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1001;
        }

        .fab-button:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 25px rgba(102, 126, 234, 0.5);
        }

        .fab-button.active {
            transform: rotate(45deg);
        }

        .fab-menu {
            position: absolute;
            bottom: 70px;
            right: 0;
            display: none;
            flex-direction: column;
            gap: 0.75rem;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s ease;
        }

        .fab-menu.active {
            display: flex;
            opacity: 1;
            transform: translateY(0);
        }

        .fab-menu-item {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .fab-menu-item:hover {
            background: var(--accent-color);
            color: white;
            transform: scale(1.1);
        }

        .fab-menu-item span {
            position: absolute;
            right: 60px;
            background: var(--card-bg);
            color: var(--text-primary);
            padding: 0.5rem 0.75rem;
            border-radius: 8px;
            font-size: 0.8rem;
            white-space: nowrap;
            opacity: 0;
            transform: translateX(10px);
            transition: all 0.3s ease;
            border: 1px solid var(--border-color);
            pointer-events: none;
        }

        .fab-menu-item:hover span {
            opacity: 1;
            transform: translateX(0);
        }

        .fab-menu-item:hover {
            background: var(--accent-color);
            color: white;
            transform: scale(1.1);
        }

        .fab-menu-item span {
            position: absolute;
            right: 60px;
            background: var(--card-bg);
            color: var(--text-primary);
            padding: 0.5rem 0.75rem;
            border-radius: 8px;
            font-size: 0.8rem;
            white-space: nowrap;
            opacity: 0;
            transform: translateX(10px);
            transition: all 0.3s ease;
            border: 1px solid var(--border-color);
            pointer-events: none;
        }

        .fab-menu-item:hover span {
            opacity: 1;
            transform: translateX(0);
        }

        /* Transactions Section */
        .transactions-section {
            background: linear-gradient(180deg, rgba(22, 27, 34, 0.95), rgba(22, 27, 34, 0.85));
            border-radius: 20px;
            padding: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        }

        .transactions-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .transactions-title {
            color: var(--text-primary);
            font-weight: 700;
            font-size: 1.4rem;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .transactions-count {
            color: var(--text-secondary);
            font-size: 0.9rem;
            opacity: 0.8;
            background: rgba(255, 255, 255, 0.05);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .transactions-container {
            position: relative;
        }

        .transactions-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        /* Transaction Card Placeholder */
        .transaction-card-placeholder {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 1.25rem;
            border: 1px solid rgba(255, 255, 255, 0.08);
            transition: all 0.3s ease;
        }

        .transaction-card-placeholder:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateX(4px);
        }

        .transaction-header-placeholder {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .transaction-icon-placeholder {
            width: 48px;
            height: 48px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
        }

        .transaction-info-placeholder {
            flex: 1;
        }

        .transaction-title-placeholder {
            height: 18px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            width: 70%;
            margin-bottom: 0.75rem;
        }

        .transaction-subtitle-placeholder {
            height: 16px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
            width: 50%;
        }

        .transaction-amount-placeholder {
            height: 24px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            width: 100px;
        }

        /* Empty Transactions */
        .empty-transactions {
            text-align: center;
            padding: 4rem 2rem;
        }

        .empty-icon {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 2rem;
            color: white;
            font-size: 2.5rem;
            box-shadow: 0 8px 32px rgba(102, 126, 234, 0.3);
        }

        .empty-title {
            color: var(--text-primary);
            font-weight: 700;
            font-size: 1.5rem;
            margin-bottom: 0.75rem;
        }

        .empty-subtitle {
            color: var(--text-secondary);
            font-size: 1rem;
            margin: 0;
            opacity: 0.8;
        }

        /* Deposit History Modal Styles */
        .deposit-history-container {
            color: var(--text-primary);
        }

        .deposit-history-filters .form-label {
            color: var(--text-primary);
            font-weight: 500;
            margin-bottom: 0.5rem;
        }

        .deposit-history-filters .form-select {
            background-color: var(--card-bg);
            border-color: var(--border-color);
            color: var(--text-primary);
        }

        .deposit-history-filters .form-select:focus {
            background-color: var(--card-bg);
            border-color: var(--accent-color);
            color: var(--text-primary);
            box-shadow: 0 0 0 0.2rem rgba(88, 166, 255, 0.25);
        }

        .deposit-history-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .deposit-history-item {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
        }

        .deposit-history-item:hover {
            border-color: var(--accent-color);
            box-shadow: 0 4px 20px rgba(88, 166, 255, 0.15);
        }

        .deposit-history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .deposit-history-title {
            font-weight: 600;
            color: var(--text-primary);
            margin: 0;
        }

        .deposit-history-status {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .deposit-history-status.pending {
            background: rgba(245, 158, 11, 0.2);
            color: #f59e0b;
            border: 1px solid rgba(245, 158, 11, 0.3);
        }

        .deposit-history-status.approved {
            background: rgba(34, 197, 94, 0.2);
            color: #22c55e;
            border: 1px solid rgba(34, 197, 94, 0.3);
        }

        .deposit-history-status.rejected {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .deposit-history-details {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .deposit-history-amount {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .deposit-history-date {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .deposit-history-note {
            color: var(--text-secondary);
            font-size: 0.85rem;
            font-style: italic;
            margin: 0;
        }

        .empty-deposits {
            text-align: center;
            padding: 3rem 2rem;
        }

        .deposit-history-loading {
            text-align: center;
            padding: 2rem;
            color: var(--text-secondary);
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .wallet-header {
                padding: 1.5rem;
                margin-bottom: 1.5rem;
                border-radius: 16px;
            }

            .wallet-title {
                font-size: 1.75rem;
            }

            .wallet-subtitle {
                font-size: 0.9rem;
            }

            .wallet-header-icon {
                width: 60px;
                height: 60px;
                font-size: 1.8rem;
            }

            .balance-cards-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .balance-card {
                padding: 1.25rem;
                border-radius: 16px;
            }

            .balance-card-header {
                gap: 0.75rem;
            }

            .balance-icon {
                width: 50px;
                height: 50px;
                font-size: 1.5rem;
            }

            .balance-amount {
                font-size: 1.75rem;
            }

            .btn-history, .btn-withdraw {
                padding: 0.6rem 1rem;
                font-size: 0.85rem;
            }

            .quick-actions-grid {
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }

            .btn-add-amount, .btn-send-money {
                padding: 1rem 1.5rem;
                font-size: 1rem;
            }

            .stats-grid {
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }

            .stat-card {
                padding: 1rem;
            }

            .stat-icon {
                width: 45px;
                height: 45px;
                font-size: 1.2rem;
            }

            .stat-value {
                font-size: 1.3rem;
            }

            .transactions-section {
                padding: 1.5rem;
                border-radius: 16px;
            }

            .transactions-title {
                font-size: 1.2rem;
            }

            .empty-transactions {
                padding: 3rem 1.5rem;
            }

            .empty-icon {
                width: 80px;
                height: 80px;
                font-size: 2rem;
            }

            .empty-title {
                font-size: 1.3rem;
            }

            .fab-container {
                bottom: 80px;
                right: 15px;
            }

            .fab-button {
                width: 55px;
                height: 55px;
                font-size: 1.3rem;
            }

            .fab-menu-item {
                width: 45px;
                height: 45px;
                font-size: 1.1rem;
            }
        }

        @media (max-width: 480px) {
            .wallet-header {
                padding: 1.25rem;
            }

            .wallet-title {
                font-size: 1.5rem;
            }

            .wallet-header-icon {
                width: 50px;
                height: 50px;
                font-size: 1.5rem;
            }

            .balance-card {
                padding: 1rem;
            }

            .balance-icon {
                width: 45px;
                height: 45px;
                font-size: 1.3rem;
            }

            .balance-amount {
                font-size: 1.5rem;
            }

            .btn-history, .btn-withdraw {
                padding: 0.5rem 0.8rem;
                font-size: 0.8rem;
            }

            .quick-actions-grid {
                gap: 0.5rem;
            }

            .btn-add-amount, .btn-send-money {
                padding: 0.875rem 1.25rem;
                font-size: 0.95rem;
            }

            .stats-grid {
                gap: 0.5rem;
            }

            .stat-card {
                padding: 0.875rem;
            }

            .stat-icon {
                width: 40px;
                height: 40px;
                font-size: 1.1rem;
            }

            .stat-value {
                font-size: 1.2rem;
            }

            .stat-label {
                font-size: 0.8rem;
            }

            .transactions-section {
                padding: 1.25rem;
            }

            .transactions-title {
                font-size: 1.1rem;
            }
        }

        /* ===== MOBILE APP STYLE SUPPORT SECTION ===== */
        
        /* Mobile App Header */
        .mobile-app-header {
            background: var(--primary-bg);
            padding: 1.5rem 1rem 2rem;
            margin: -1rem -1rem 1rem -1rem;
            border-bottom: 1px solid var(--border-color);
            position: relative;
        }
        
        .mobile-app-header::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--border-color), transparent);
        }
        
        .header-content {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .header-icon {
            width: 50px;
            height: 50px;
            background: var(--accent-color);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(88, 166, 255, 0.3);
        }
        
        .header-icon i {
            font-size: 1.5rem;
            color: white;
        }
        
        .app-title {
            color: var(--text-primary);
            font-size: 1.5rem;
            font-weight: 700;
            margin: 0;
            letter-spacing: -0.5px;
        }
        
        .app-subtitle {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin: 0.25rem 0 0 0;
            font-weight: 400;
        }
        
        /* Mobile App Stats */
        .mobile-stats-container {
            display: flex;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
            padding: 0 0.5rem;
        }
        
        .stat-item {
            flex: 1;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 1rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            transition: all 0.2s ease;
        }
        
        .stat-item:active {
            transform: scale(0.98);
            background: var(--secondary-bg);
        }
        
        .stat-icon-wrapper {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            color: white;
            flex-shrink: 0;
        }
        
        .stat-icon-wrapper.active {
            background: linear-gradient(135deg, #F59E0B, #F97316);
        }
        
        .stat-icon-wrapper.resolved {
            background: linear-gradient(135deg, #10B981, #059669);
        }
        
        .stat-icon-wrapper.response {
            background: linear-gradient(135deg, #8B5CF6, #7C3AED);
        }
        
        .stat-info {
            display: flex;
            flex-direction: column;
            min-width: 0;
        }
        
        .stat-number {
            color: var(--text-primary);
            font-size: 1.1rem;
            font-weight: 700;
            line-height: 1.2;
        }
        
        .stat-label {
            color: var(--text-secondary);
            font-size: 0.75rem;
            font-weight: 500;
            margin-top: 0.25rem;
        }
        
        /* Mobile App Create Ticket */
        .mobile-create-ticket {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1rem;
            transition: all 0.2s ease;
        }
        
        .mobile-create-ticket:active {
            transform: scale(0.98);
            background: var(--secondary-bg);
        }
        
        .create-ticket-content {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex: 1;
        }
        
        .ticket-icon {
            width: 50px;
            height: 50px;
            background: var(--accent-color);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
            flex-shrink: 0;
        }
        
        .ticket-text h3 {
            color: var(--text-primary);
            font-size: 1.1rem;
            font-weight: 600;
            margin: 0 0 0.25rem 0;
        }
        
        .ticket-text p {
            color: var(--text-secondary);
            font-size: 0.85rem;
            margin: 0;
            line-height: 1.3;
        }
        
        .mobile-create-btn {
            background: var(--accent-color);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 0.75rem 1.25rem;
            font-size: 0.9rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            transition: all 0.2s ease;
            flex-shrink: 0;
        }
        
        .mobile-create-btn:active {
            transform: scale(0.95);
            background: #3B82F6;
        }
        
        /* Mobile App Tickets Section */
        .mobile-tickets-section {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 1.5rem;
        }
        
        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
        }
        
        .header-left {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .header-left i {
            color: var(--accent-color);
            font-size: 1.25rem;
        }
        
        .header-left h3 {
            color: var(--text-primary);
            font-size: 1.1rem;
            font-weight: 600;
            margin: 0;
        }
        
        .mobile-refresh-btn {
            background: var(--secondary-bg);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            border-radius: 10px;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .mobile-refresh-btn:active {
            background: var(--accent-color);
            color: white;
            transform: rotate(180deg);
        }
        
        .tickets-container {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }
        
        .ticket-item {
            background: var(--secondary-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1rem;
            transition: all 0.2s ease;
            cursor: pointer;
        }
        
        .ticket-item:active {
            transform: scale(0.98);
            background: var(--primary-bg);
        }
        
        .ticket-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 0.75rem;
        }
        
        .ticket-title {
            color: var(--text-primary);
            font-weight: 600;
            font-size: 1rem;
        }
        
        .ticket-status {
            padding: 0.375rem 0.75rem;
            border-radius: 16px;
            font-size: 0.75rem;
            font-weight: 500;
        }
        
        .ticket-status.active {
            background: rgba(245, 158, 11, 0.2);
            color: #F59E0B;
            border: 1px solid rgba(245, 158, 11, 0.3);
        }
        
        .ticket-status.resolved {
            background: rgba(16, 185, 129, 0.2);
            color: #10B981;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }
        
        .ticket-status.pending {
            background: rgba(139, 92, 246, 0.2);
            color: #8B5CF6;
            border: 1px solid rgba(139, 92, 246, 0.3);
        }
        
        .ticket-meta {
            display: flex;
            align-items: center;
            gap: 1rem;
            color: var(--text-secondary);
            font-size: 0.8rem;
        }
        
        .ticket-meta span {
            display: flex;
            align-items: center;
            gap: 0.375rem;
        }
        
        /* Mobile App Empty State */
        .mobile-empty-state {
            text-align: center;
            padding: 2rem 1rem;
        }
        
        .empty-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, rgba(88, 166, 255, 0.1), rgba(59, 130, 246, 0.1));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.5rem;
            font-size: 2.5rem;
            color: var(--accent-color);
        }
        
        .mobile-empty-state h4 {
            color: var(--text-primary);
            font-size: 1.2rem;
            font-weight: 600;
            margin: 0 0 0.75rem 0;
        }
        
        .mobile-empty-state p {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin: 0 0 1.5rem 0;
            line-height: 1.4;
        }
        
        .mobile-empty-btn {
            background: var(--accent-color);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 0.875rem 1.5rem;
            font-size: 0.9rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            transition: all 0.2s ease;
            margin: 0 auto;
        }
        
        .mobile-empty-btn:active {
            transform: scale(0.95);
            background: #3B82F6;
        }
        
        /* Mobile App Optimizations */
        @media (max-width: 768px) {
            .mobile-app-header {
                padding: 1.25rem 1rem 1.5rem;
                margin: -1rem -1rem 1rem -1rem;
            }
            
            .header-content {
                gap: 0.75rem;
            }
            
            .header-icon {
                width: 45px;
                height: 45px;
            }
            
            .header-icon i {
                font-size: 1.25rem;
            }
            
            .app-title {
                font-size: 1.3rem;
            }
            
            .app-subtitle {
                font-size: 0.85rem;
            }
            
            .mobile-stats-container {
                gap: 0.5rem;
                padding: 0 0.25rem;
            }
            
            .stat-item {
                padding: 0.875rem;
            }
            
            .stat-icon-wrapper {
                width: 35px;
                height: 35px;
                font-size: 1rem;
            }
            
            .stat-number {
                font-size: 1rem;
            }
            
            .stat-label {
                font-size: 0.7rem;
            }
            
            .mobile-create-ticket {
                padding: 1.25rem;
                margin-bottom: 1.25rem;
            }
            
            .ticket-icon {
                width: 45px;
                height: 45px;
                font-size: 1.25rem;
            }
            
            .ticket-text h3 {
                font-size: 1rem;
            }
            
            .ticket-text p {
                font-size: 0.8rem;
            }
            
            .mobile-create-btn {
                padding: 0.625rem 1rem;
                font-size: 0.85rem;
            }
            
            .mobile-tickets-section {
                padding: 1.25rem;
            }
            
            .section-header {
                margin-bottom: 1.25rem;
            }
            
            .header-left h3 {
                font-size: 1rem;
            }
            
            .mobile-refresh-btn {
                width: 35px;
                height: 35px;
            }
            
            .tickets-container {
                gap: 0.5rem;
            }
            
            .ticket-item {
                padding: 0.875rem;
            }
            
            .ticket-title {
                font-size: 0.9rem;
            }
            
            .ticket-status {
                padding: 0.25rem 0.5rem;
                font-size: 0.7rem;
            }
            
            .ticket-meta {
                gap: 0.75rem;
                font-size: 0.75rem;
            }
            
            .mobile-empty-state {
                padding: 1.5rem 0.75rem;
            }
            
            .empty-icon {
                width: 70px;
                height: 70px;
                font-size: 2rem;
            }
            
            .mobile-empty-state h4 {
                font-size: 1.1rem;
            }
            
            .mobile-empty-state p {
                font-size: 0.85rem;
            }
            
            .mobile-empty-btn {
                padding: 0.75rem 1.25rem;
                font-size: 0.85rem;
            }
        }
        
        @media (max-width: 480px) {
            .mobile-app-header {
                padding: 1rem 0.75rem 1.25rem;
            }
            
            .header-icon {
                width: 40px;
                height: 40px;
            }
            
            .header-icon i {
                font-size: 1.1rem;
            }
            
            .app-title {
                font-size: 1.2rem;
            }
            
            .app-subtitle {
                font-size: 0.8rem;
            }
            
            .mobile-stats-container {
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .stat-item {
                padding: 0.75rem;
            }
            
            .stat-icon-wrapper {
                width: 32px;
                height: 32px;
                font-size: 0.9rem;
            }
            
            .stat-number {
                font-size: 0.9rem;
            }
            
            .stat-label {
                font-size: 0.65rem;
            }
            
            .mobile-create-ticket {
                padding: 1rem;
                flex-direction: column;
                text-align: center;
                gap: 1rem;
            }
            
            .create-ticket-content {
                flex-direction: column;
                gap: 0.75rem;
            }
            
            .ticket-icon {
                width: 40px;
                height: 40px;
                font-size: 1.1rem;
            }
            
            .ticket-text h3 {
                font-size: 0.95rem;
            }
            
            .ticket-text p {
                font-size: 0.75rem;
            }
            
            .mobile-create-btn {
                padding: 0.75rem 1.5rem;
                font-size: 0.8rem;
            }
            
            .mobile-tickets-section {
                padding: 1rem;
            }
            
            .section-header {
                flex-direction: column;
                gap: 0.75rem;
                align-items: flex-start;
            }
            
            .header-left h3 {
                font-size: 0.95rem;
            }
            
            .mobile-refresh-btn {
                width: 32px;
                height: 32px;
            }
            
            .ticket-item {
                padding: 0.75rem;
            }
            
            .ticket-header {
                flex-direction: column;
                gap: 0.5rem;
                align-items: flex-start;
            }
            
            .ticket-title {
                font-size: 0.85rem;
            }
            
            .ticket-status {
                padding: 0.25rem 0.5rem;
                font-size: 0.65rem;
            }
            
            .ticket-meta {
                flex-direction: column;
                gap: 0.5rem;
                align-items: flex-start;
                font-size: 0.7rem;
            }
            
            .mobile-empty-state {
                padding: 1.25rem 0.5rem;
            }
            
            .empty-icon {
                width: 60px;
                height: 60px;
                font-size: 1.75rem;
            }
            
            .mobile-empty-state h4 {
                font-size: 1rem;
            }
            
            .mobile-empty-state p {
                font-size: 0.8rem;
            }
            
            .mobile-empty-btn {
                padding: 0.625rem 1.25rem;
                font-size: 0.8rem;
            }
        }
        
        /* ===== COMPACT MOBILE APP STYLE PROFILE SECTION ===== */
        
        /* Compact Profile Header */
        .compact-profile-header {
            background: linear-gradient(135deg, var(--accent-color) 0%, #3B82F6 100%);
            padding: 1.5rem 1rem 1rem;
            margin: -1rem -1rem 1rem -1rem;
            position: relative;
            overflow: hidden;
        }
        
        .compact-profile-header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: float 6s ease-in-out infinite;
        }
        
        .profile-main-info {
            display: flex;
            align-items: center;
            gap: 1rem;
            position: relative;
            z-index: 2;
            margin-bottom: 1rem;
        }
        
        .profile-avatar-container {
            position: relative;
            flex-shrink: 0;
        }
        
        .profile-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: 2px solid rgba(255, 255, 255, 0.3);
            object-fit: cover;
        }
        
        .edit-avatar-btn {
            position: absolute;
            bottom: 0;
            right: 0;
            width: 22px;
            height: 22px;
            background: var(--accent-color);
            border: 2px solid white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.7rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .edit-avatar-btn:active {
            transform: scale(0.9);
            background: #3B82F6;
        }
        
        .profile-info {
            flex: 1;
            min-width: 0;
        }
        
        .profile-name {
            color: white;
            font-size: 1.2rem;
            font-weight: 700;
            margin: 0 0 0.25rem 0;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        
        .profile-email {
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.8rem;
            margin: 0 0 0.5rem 0;
            font-weight: 400;
        }
        
        .status-indicator {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.25rem 0.75rem;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            color: white;
            font-size: 0.75rem;
            font-weight: 500;
        }
        
        .status-indicator.online {
            background: rgba(16, 185, 129, 0.3);
            border: 1px solid rgba(16, 185, 129, 0.5);
        }
        
        .status-indicator i {
            font-size: 0.5rem;
            color: #10B981;
        }
        
        /* Compact Stats Row */
        .compact-stats-row {
            display: flex;
            gap: 0.5rem;
            position: relative;
            z-index: 2;
        }
        
        .compact-stat {
            flex: 1;
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            padding: 0.75rem 0.5rem;
            text-align: center;
            color: white;
            transition: all 0.2s ease;
        }
        
        .compact-stat:active {
            transform: scale(0.98);
            background: rgba(255, 255, 255, 0.25);
        }
        
        .compact-stat i {
            font-size: 1rem;
            margin-bottom: 0.25rem;
            display: block;
        }
        
        .compact-stat-value {
            display: block;
            font-size: 0.9rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }
        
        .compact-stat-label {
            display: block;
            font-size: 0.65rem;
            font-weight: 500;
            opacity: 0.9;
        }
        
        /* Compact Quick Actions */
        .compact-quick-actions {
            margin-bottom: 1rem;
        }
        
        .actions-row {
            display: flex;
            gap: 0.5rem;
        }
        
        .compact-action {
            flex: 1;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 1rem 0.75rem;
            text-align: center;
            transition: all 0.2s ease;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
        }
        
        .compact-action:active {
            transform: scale(0.98);
            background: var(--secondary-bg);
        }
        
        .compact-action i {
            font-size: 1.2rem;
            color: var(--accent-color);
        }
        
        .compact-action span {
            color: var(--text-primary);
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        /* Compact Menu Section */
        .compact-menu-section {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }
        
        .compact-menu-row {
            display: flex;
            gap: 0.75rem;
        }
        
        .compact-menu-item {
            flex: 1;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 1rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            transition: all 0.2s ease;
            cursor: pointer;
            text-decoration: none;
            color: inherit;
        }
        
        .compact-menu-item:active {
            transform: scale(0.98);
            background: var(--secondary-bg);
        }
        
        .compact-menu-item i:first-child {
            font-size: 1.1rem;
            color: var(--accent-color);
            flex-shrink: 0;
        }
        
        .compact-menu-item span {
            flex: 1;
            color: var(--text-primary);
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .compact-menu-item i:last-child {
            color: var(--text-secondary);
            font-size: 0.8rem;
            flex-shrink: 0;
        }
        
        .compact-menu-item.logout-item i:first-child {
            color: #EF4444;
        }
        
        /* Toggle Switch for Compact Design */
        .compact-menu-item .toggle-switch {
            position: relative;
            width: 36px;
            height: 20px;
            flex-shrink: 0;
        }
        
        .compact-menu-item .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .compact-menu-item .toggle-switch label {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--border-color);
            transition: 0.3s;
            border-radius: 20px;
        }
        
        .compact-menu-item .toggle-switch label:before {
            position: absolute;
            content: "";
            height: 14px;
            width: 14px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: 0.3s;
            border-radius: 50%;
        }
        
        .compact-menu-item .toggle-switch input:checked + label {
            background-color: var(--accent-color);
        }
        
        .compact-menu-item .toggle-switch input:checked + label:before {
            transform: translateX(16px);
        }
        
        /* Mobile Profile Header */
        .mobile-profile-header {
            background: linear-gradient(135deg, var(--accent-color) 0%, #3B82F6 100%);
            padding: 2rem 1rem 1.5rem;
            margin: -1rem -1rem 1rem -1rem;
            position: relative;
            overflow: hidden;
        }
        
        .mobile-profile-header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: float 6s ease-in-out infinite;
        }
        
        .profile-cover {
            display: flex;
            align-items: center;
            gap: 1rem;
            position: relative;
            z-index: 2;
        }
        
        .profile-avatar-container {
            position: relative;
            flex-shrink: 0;
        }
        
        .profile-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            border: 3px solid rgba(255, 255, 255, 0.3);
            object-fit: cover;
        }
        
        .edit-avatar-btn {
            position: absolute;
            bottom: 0;
            right: 0;
            width: 28px;
            height: 28px;
            background: var(--accent-color);
            border: 2px solid white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .edit-avatar-btn:active {
            transform: scale(0.9);
            background: #3B82F6;
        }
        
        .profile-info {
            flex: 1;
            min-width: 0;
        }
        
        .profile-name {
            color: white;
            font-size: 1.5rem;
            font-weight: 700;
            margin: 0 0 0.25rem 0;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        
        .profile-email {
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.9rem;
            margin: 0 0 0.5rem 0;
            font-weight: 400;
        }
        
        .status-indicator {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.25rem 0.75rem;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            color: white;
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        .status-indicator.online {
            background: rgba(16, 185, 129, 0.3);
            border: 1px solid rgba(16, 185, 129, 0.5);
        }
        
        .status-indicator i {
            font-size: 0.6rem;
            color: #10B981;
        }
        
        /* Mobile Profile Stats */
        .mobile-profile-stats {
            margin-bottom: 1.5rem;
        }
        
        .stats-row {
            display: flex;
            gap: 0.75rem;
            padding: 0 0.5rem;
        }
        
        .stat-card {
            flex: 1;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            transition: all 0.2s ease;
        }
        
        .stat-card:active {
            transform: scale(0.98);
            background: var(--secondary-bg);
        }
        
        .stat-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            color: white;
            flex-shrink: 0;
        }
        
        .stat-card:nth-child(1) .stat-icon {
            background: linear-gradient(135deg, #F59E0B, #F97316);
        }
        
        .stat-card:nth-child(2) .stat-icon {
            background: linear-gradient(135deg, #10B981, #059669);
        }
        
        .stat-card:nth-child(3) .stat-icon {
            background: linear-gradient(135deg, #8B5CF6, #7C3AED);
        }
        
        .stat-card:nth-child(4) .stat-icon {
            background: linear-gradient(135deg, #EF4444, #DC2626);
        }
        
        .stat-content {
            display: flex;
            flex-direction: column;
            min-width: 0;
        }
        
        .stat-value {
            color: var(--text-primary);
            font-size: 1.1rem;
            font-weight: 700;
            line-height: 1.2;
        }
        
        .stat-label {
            color: var(--text-secondary);
            font-size: 0.75rem;
            font-weight: 500;
            margin-top: 0.25rem;
        }
        
        /* Mobile Quick Actions */
        .mobile-quick-actions {
            margin-bottom: 1.5rem;
        }
        
        .section-header {
            margin-bottom: 1rem;
        }
        
        .section-header h3 {
            color: var(--text-primary);
            font-size: 1.1rem;
            font-weight: 600;
            margin: 0;
        }
        
        .actions-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.75rem;
        }
        
        .action-item {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.25rem;
            text-align: center;
            transition: all 0.2s ease;
            cursor: pointer;
        }
        
        .action-item:active {
            transform: scale(0.98);
            background: var(--secondary-bg);
        }
        
        .action-icon {
            width: 50px;
            height: 50px;
            background: var(--accent-color);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 0.75rem;
            font-size: 1.3rem;
            color: white;
        }
        
        .action-label {
            color: var(--text-primary);
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        /* Mobile Profile Menu */
        .mobile-profile-menu {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        .menu-section {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            overflow: hidden;
        }
        
        .section-title {
            color: var(--text-primary);
            font-size: 0.9rem;
            font-weight: 600;
            padding: 1rem 1rem 0.5rem;
            margin: 0;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .menu-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            border-bottom: 1px solid var(--border-color);
            transition: all 0.2s ease;
            cursor: pointer;
            text-decoration: none;
            color: inherit;
        }
        
        .menu-item:last-child {
            border-bottom: none;
        }
        
        .menu-item:active {
            background: var(--secondary-bg);
        }
        
        .menu-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            color: white;
            flex-shrink: 0;
        }
        
        .menu-icon {
            background: var(--accent-color);
        }
        
        .logout-icon {
            background: linear-gradient(135deg, #EF4444, #DC2626);
        }
        
        .menu-content {
            flex: 1;
            min-width: 0;
        }
        
        .menu-title {
            color: var(--text-primary);
            font-size: 1rem;
            font-weight: 500;
            display: block;
            margin-bottom: 0.25rem;
        }
        
        .menu-subtitle {
            color: var(--text-secondary);
            font-size: 0.8rem;
            display: block;
        }
        
        .menu-action {
            flex-shrink: 0;
        }
        
        .menu-action i {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        /* Toggle Switch */
        .toggle-switch {
            position: relative;
            width: 44px;
            height: 24px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-switch label {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--border-color);
            transition: 0.3s;
            border-radius: 24px;
        }
        
        .toggle-switch label:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: 0.3s;
            border-radius: 50%;
        }
        
        .toggle-switch input:checked + label {
            background-color: var(--accent-color);
        }
        
        .toggle-switch input:checked + label:before {
            transform: translateX(20px);
        }
        
        /* Compact Profile Mobile Optimizations */
        @media (max-width: 768px) {
            .compact-profile-header {
                padding: 1.25rem 1rem 0.875rem;
            }
            
            .profile-main-info {
                gap: 0.75rem;
                margin-bottom: 0.875rem;
            }
            
            .profile-avatar {
                width: 55px;
                height: 55px;
            }
            
            .edit-avatar-btn {
                width: 20px;
                height: 20px;
                font-size: 0.65rem;
            }
            
            .profile-name {
                font-size: 1.1rem;
            }
            
            .profile-email {
                font-size: 0.75rem;
            }
            
            .compact-stats-row {
                gap: 0.375rem;
            }
            
            .compact-stat {
                padding: 0.625rem 0.375rem;
            }
            
            .compact-stat i {
                font-size: 0.9rem;
            }
            
            .compact-stat-value {
                font-size: 0.8rem;
            }
            
            .compact-stat-label {
                font-size: 0.6rem;
            }
            
            .actions-row {
                gap: 0.375rem;
            }
            
            .compact-action {
                padding: 0.875rem 0.625rem;
            }
            
            .compact-action i {
                font-size: 1.1rem;
            }
            
            .compact-action span {
                font-size: 0.75rem;
            }
            
            .compact-menu-row {
                gap: 0.625rem;
            }
            
            .compact-menu-item {
                padding: 0.875rem;
            }
            
            .compact-menu-item i:first-child {
                font-size: 1rem;
            }
            
            .compact-menu-item span {
                font-size: 0.85rem;
            }
            
            .compact-menu-item i:last-child {
                font-size: 0.75rem;
            }
        }
        
        @media (max-width: 480px) {
            .compact-profile-header {
                padding: 1rem 0.75rem 0.75rem;
            }
            
            .profile-avatar {
                width: 50px;
                height: 50px;
            }
            
            .edit-avatar-btn {
                width: 18px;
                height: 18px;
                font-size: 0.6rem;
            }
            
            .profile-name {
                font-size: 1rem;
            }
            
            .profile-email {
                font-size: 0.7rem;
            }
            
            .compact-stats-row {
                flex-direction: row;
                gap: 0.375rem;
            }
            
            .compact-stat {
                padding: 0.5rem;
            }
            
            .compact-stat i {
                font-size: 0.8rem;
            }
            
            .compact-stat-value {
                font-size: 0.75rem;
            }
            
            .compact-stat-label {
                font-size: 0.55rem;
            }
            
            .actions-row {
                grid-template-columns: 1fr;
                gap: 0.375rem;
            }
            
            .compact-action {
                padding: 0.75rem;
            }
            
            .compact-action i {
                font-size: 1rem;
            }
            
            .compact-action span {
                font-size: 0.7rem;
            }
            
            .compact-menu-row {
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .compact-menu-item {
                padding: 0.75rem;
            }
            
            .compact-menu-item i:first-child {
                font-size: 0.9rem;
            }
            
            .compact-menu-item span {
                font-size: 0.8rem;
            }
            
            .compact-menu-item i:last-child {
                font-size: 0.7rem;
            }
        }
        @media (max-width: 768px) {
            .mobile-profile-header {
                padding: 1.5rem 1rem 1.25rem;
            }
            
            .profile-cover {
                gap: 0.75rem;
            }
            
            .profile-avatar {
                width: 70px;
                height: 70px;
            }
            
            .edit-avatar-btn {
                width: 24px;
                height: 24px;
                font-size: 0.7rem;
            }
            
            .profile-name {
                font-size: 1.3rem;
            }
            
            .profile-email {
                font-size: 0.85rem;
            }
            
            .stats-row {
                gap: 0.5rem;
                padding: 0 0.25rem;
            }
            
            .stat-card {
                padding: 0.875rem;
            }
            
            .stat-icon {
                width: 35px;
                height: 35px;
                font-size: 1rem;
            }
            
            .stat-value {
                font-size: 1rem;
            }
            
            .stat-label {
                font-size: 0.7rem;
            }
            
            .actions-grid {
                gap: 0.5rem;
            }
            
            .action-item {
                padding: 1rem;
            }
            
            .action-icon {
                width: 45px;
                height: 45px;
                font-size: 1.2rem;
            }
            
            .action-label {
                font-size: 0.85rem;
            }
            
            .menu-item {
                padding: 0.875rem;
            }
            
            .menu-icon {
                width: 35px;
                height: 35px;
                font-size: 1rem;
            }
            
            .menu-title {
                font-size: 0.9rem;
            }
            
            .menu-subtitle {
                font-size: 0.75rem;
            }
        }
        
        @media (max-width: 480px) {
            .mobile-profile-header {
                padding: 1.25rem 0.75rem 1rem;
            }
            
            .profile-avatar {
                width: 60px;
                height: 60px;
            }
            
            .edit-avatar-btn {
                width: 22px;
                height: 22px;
                font-size: 0.65rem;
            }
            
            .profile-name {
                font-size: 1.2rem;
            }
            
            .profile-email {
                font-size: 0.8rem;
            }
            
            .stats-row {
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .stat-card {
                padding: 0.75rem;
            }
            
            .stat-icon {
                width: 32px;
                height: 32px;
                font-size: 0.9rem;
            }
            
            .stat-value {
                font-size: 0.9rem;
            }
            
            .stat-label {
                font-size: 0.65rem;
            }
            
            .actions-grid {
                grid-template-columns: 1fr;
                gap: 0.5rem;
            }
            
            .action-item {
                padding: 0.875rem;
            }
            
            .action-icon {
                width: 40px;
                height: 40px;
                font-size: 1.1rem;
            }
            
            .action-label {
                font-size: 0.8rem;
            }
            
            .menu-item {
                padding: 0.75rem;
            }
            
            .menu-icon {
                width: 32px;
                height: 32px;
                font-size: 0.9rem;
            }
            
            .menu-title {
                font-size: 0.85rem;
            }
            
            .menu-subtitle {
                font-size: 0.7rem;
            }
        }
        
        /* Mobile Optimizations */
        @media (max-width: 768px) {
            .support-header {
                padding: 1.5rem;
                margin-bottom: 1.5rem;
            }
            
            .support-header-content {
                flex-direction: column;
                text-align: center;
                gap: 1rem;
            }
            
            .support-header-icon {
                width: 60px;
                height: 60px;
            }
            
            .support-header-icon i {
                font-size: 2rem;
            }
            
            .support-title {
                font-size: 1.5rem;
            }
            
            .support-subtitle {
                font-size: 0.9rem;
            }
            
            .support-stats-grid {
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }
            
            .support-stat-card {
                padding: 1.25rem;
            }
            
            .create-ticket-card {
                flex-direction: column;
                text-align: center;
                padding: 1.5rem;
                gap: 1.5rem;
            }
            
            .create-ticket-content {
                flex-direction: column;
                gap: 1rem;
            }
            
            .create-ticket-icon {
                width: 60px;
                height: 60px;
                font-size: 1.5rem;
            }
            
            .my-tickets-section {
                padding: 1.5rem;
            }
            
            .tickets-header {
                flex-direction: column;
                gap: 1rem;
                align-items: flex-start;
            }
            
            .ticket-meta {
                flex-direction: column;
                gap: 0.5rem;
                align-items: flex-start;
            }
        }
        
        @media (max-width: 480px) {
            .support-header {
                padding: 1rem;
                border-radius: 16px;
            }
            
            .support-header-icon {
                width: 50px;
                height: 50px;
            }
            
            .support-header-icon i {
                font-size: 1.5rem;
            }
            
            .support-title {
                font-size: 1.3rem;
            }
            
            .support-stat-card {
                padding: 1rem;
            }
            
            .create-ticket-card {
                padding: 1rem;
            }
            
            .create-ticket-icon {
                width: 50px;
                height: 50px;
                font-size: 1.3rem;
            }
            
            .btn-create-ticket,
            .btn-create-first-ticket {
                padding: 0.875rem 1.5rem;
                font-size: 0.9rem;
            }
            
            .my-tickets-section {
                padding: 1rem;
                border-radius: 16px;
            }
            
            .tickets-title h5 {
                font-size: 1.1rem;
            }
            
            .ticket-item {
                padding: 1rem;
            }
            
            .ticket-header {
                flex-direction: column;
                gap: 0.5rem;
                align-items: flex-start;
            }
        }

        /* --- Compact Mobile Referral UI Styles --- */
        .compact-referral-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            position: relative;
            overflow: hidden;
        }

        .compact-referral-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
            pointer-events: none;
        }

        .referral-main-info {
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            z-index: 1;
        }

        .referral-title-section {
            flex: 1;
        }

        .referral-title {
            color: white;
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .referral-subtitle {
            color: rgba(255,255,255,0.9);
            font-size: 0.9rem;
            margin: 0;
        }

        .referral-header-icon {
            width: 50px;
            height: 50px;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.3rem;
            backdrop-filter: blur(10px);
        }

        /* Compact Stats Row */
        .compact-referral-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .compact-referral-stat {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1rem;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .compact-referral-stat::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, var(--accent-color), #FBBF24);
        }

        .compact-referral-stat:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .compact-referral-stat i {
            font-size: 1.5rem;
            color: var(--accent-color);
            margin-bottom: 0.5rem;
            display: block;
        }

        .compact-referral-value {
            display: block;
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }

        .compact-referral-label {
            display: block;
            font-size: 0.75rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        /* Compact Referral Code Section */
        .compact-referral-code {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 1.25rem;
            margin-bottom: 1rem;
        }

        .compact-referral-code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            flex-wrap: wrap;
            gap: 0.75rem;
        }

        .compact-referral-code .referral-code-title {
            color: var(--text-primary);
            font-size: 1.1rem;
            font-weight: 600;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .compact-referral-code .btn-copy-code {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border: none;
            border-radius: 8px;
            padding: 0.5rem 1rem;
            color: white;
            font-weight: 600;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.4rem;
        }

        .compact-referral-code .btn-copy-code:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .compact-referral-code-display {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
            border: 2px solid rgba(102, 126, 234, 0.3);
            border-radius: 12px;
            padding: 1rem;
            text-align: center;
            margin-bottom: 1rem;
            font-family: monospace;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
            letter-spacing: 1px;
        }

        .compact-referral-code .referral-code-subtitle {
            color: var(--text-secondary);
            font-size: 0.85rem;
            margin-bottom: 1rem;
            text-align: center;
        }

        /* Compact Share Options */
        .compact-share-options {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .share-options-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
        }

        .compact-share-btn {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 0.75rem;
            color: var(--text-primary);
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            text-decoration: none;
        }

        .compact-share-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            border-color: var(--accent-color);
        }

        .compact-share-btn.whatsapp:hover {
            background: #25D366;
            color: white;
            border-color: #25D366;
        }

        .compact-share-btn.telegram:hover {
            background: #0088cc;
            color: white;
            border-color: #0088cc;
        }

        .compact-share-btn.copy:hover {
            background: var(--accent-color);
            color: white;
            border-color: var(--accent-color);
        }

        .compact-share-btn.more:hover {
            background: var(--text-secondary);
            color: white;
            border-color: var(--text-secondary);
        }

        /* Compact Referral History */
        .compact-referral-history {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 1.25rem;
        }

        .compact-referral-history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            flex-wrap: wrap;
            gap: 0.75rem;
        }

        .compact-referral-history .history-title {
            color: var(--text-primary);
            font-size: 1.1rem;
            font-weight: 600;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .compact-referral-history .btn-refresh {
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 0.4rem 0.8rem;
            color: var(--text-secondary);
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.4rem;
        }

        .compact-referral-history .btn-refresh:hover {
            background: var(--accent-color);
            color: white;
            border-color: var(--accent-color);
        }

        .compact-referral-history-list {
            max-height: 300px;
            overflow-y: auto;
        }

        .compact-referral-history-placeholder {
            padding: 1rem 0;
        }

        /* Compact Referral History Items */
        .compact-referral-history-item {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 0.75rem;
            transition: all 0.3s ease;
        }

        .compact-referral-history-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            border-color: var(--accent-color);
        }

        .referral-item-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 1rem;
        }

        .referral-item-info {
            flex: 1;
        }

        .referral-item-name {
            color: var(--text-primary);
            font-weight: 600;
            font-size: 0.95rem;
            margin-bottom: 0.25rem;
        }

        .referral-item-email {
            color: var(--text-secondary);
            font-size: 0.8rem;
        }

        .referral-item-meta {
            text-align: right;
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 0.5rem;
        }

        .referral-item-date {
            color: var(--text-secondary);
            font-size: 0.8rem;
        }

        .referral-status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .referral-status-badge.active {
            background: rgba(34, 197, 94, 0.2);
            color: #22c55e;
            border: 1px solid rgba(34, 197, 94, 0.3);
        }

        .referral-status-badge.inactive {
            background: rgba(107, 114, 128, 0.2);
            color: #6b7280;
            border: 1px solid rgba(107, 114, 128, 0.3);
        }

        .compact-empty-referral-state {
            text-align: center;
            padding: 2rem 1rem;
            color: var(--text-secondary);
        }

        .compact-empty-referral-state i {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        .compact-empty-referral-state h4 {
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .compact-empty-referral-state p {
            font-size: 0.9rem;
            line-height: 1.5;
        }

        /* Mobile Responsiveness for Compact Referral */
        @media (max-width: 480px) {
            .compact-referral-header {
                padding: 1.25rem;
                border-radius: 12px;
            }
            
            .referral-title {
                font-size: 1.2rem;
            }
            
            .referral-subtitle {
                font-size: 0.8rem;
            }
            
            .compact-referral-stats {
                gap: 0.5rem;
            }
            
            .compact-referral-stat {
                padding: 0.75rem;
            }
            
            .compact-referral-stat i {
                font-size: 1.3rem;
            }
            
            .compact-referral-value {
                font-size: 1.1rem;
            }
            
            .compact-referral-label {
                font-size: 0.7rem;
            }
            
            .compact-referral-code {
                padding: 1rem;
                border-radius: 12px;
            }
            
            .compact-referral-code-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .share-options-row {
                gap: 0.5rem;
            }
            
            .compact-share-btn {
                padding: 0.6rem;
                font-size: 0.8rem;
            }
            
            .compact-referral-history {
                padding: 1rem;
                border-radius: 12px;
            }
            
            .compact-referral-history-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .compact-referral-history-item {
                padding: 0.75rem;
            }
            
            .referral-item-content {
                gap: 0.75rem;
            }
            
            .referral-item-name {
                font-size: 0.9rem;
            }
            
            .referral-item-email {
                font-size: 0.75rem;
            }
            
            .referral-item-date {
                font-size: 0.75rem;
            }
            
            .referral-status-badge {
                padding: 0.2rem 0.6rem;
                font-size: 0.7rem;
            }
        }

        @media (max-width: 768px) {
            .compact-referral-stats {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .share-options-row {
                grid-template-columns: 1fr 1fr;
            }
        }

        /* --- Compact Mobile Stats UI Styles --- */
        .compact-stats-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            position: relative;
            overflow: hidden;
        }

        .compact-stats-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
            pointer-events: none;
        }

        .stats-main-info {
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            z-index: 1;
        }

        .stats-title-section {
            flex: 1;
        }

        .stats-title {
            color: white;
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .stats-subtitle {
            color: rgba(255,255,255,0.9);
            font-size: 0.9rem;
            margin: 0;
        }

        .stats-header-icon {
            width: 50px;
            height: 50px;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.3rem;
            backdrop-filter: blur(10px);
        }

        /* Compact Stats Sections */
        .compact-performance-stats,
        .compact-financial-stats,
        .compact-quick-summary {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 1.25rem;
            margin-bottom: 1rem;
        }

        .compact-stats-section-header {
            margin-bottom: 1rem;
        }

        .compact-stats-section-header .stats-section-title {
            color: var(--text-primary);
            font-size: 1.1rem;
            font-weight: 600;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Compact Stats Grid */
        .compact-stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.75rem;
        }

        .compact-stat-item {
            background: var(--secondary-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1rem;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .compact-stat-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, var(--accent-color), #FBBF24);
        }

        .compact-stat-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .compact-stat-item i {
            font-size: 1.5rem;
            color: var(--accent-color);
            margin-bottom: 0.5rem;
            display: block;
        }

        .compact-stat-value {
            display: block;
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }

        .compact-stat-label {
            display: block;
            font-size: 0.75rem;
            color: var(--text-secondary);
            font-weight: 500;
            margin-bottom: 0.75rem;
        }

        /* Compact Stat Trends */
        .compact-stat-trend {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.25rem;
            font-size: 0.7rem;
            font-weight: 500;
            padding: 0.25rem 0.5rem;
            border-radius: 8px;
        }

        .compact-stat-trend.positive {
            background: rgba(34, 197, 94, 0.1);
            color: #22c55e;
        }

        .compact-stat-trend.neutral {
            background: rgba(107, 114, 128, 0.1);
            color: #6b7280;
        }

        .compact-stat-trend i {
            font-size: 0.6rem;
            margin: 0;
        }

        .compact-stat-trend span {
            font-size: 0.65rem;
        }

        /* Compact Win Rate Progress */
        .compact-win-rate-progress {
            margin-top: 0.5rem;
        }

        .compact-win-rate-progress .progress {
            background: rgba(255,255,255,0.1);
            border-radius: 4px;
            overflow: hidden;
        }

        .compact-win-rate-progress .progress-bar {
            background: linear-gradient(90deg, var(--accent-color), #FBBF24);
            border-radius: 4px;
        }

        .compact-win-rate-progress .win-rate-label {
            color: var(--text-secondary);
            font-size: 0.65rem;
            margin-top: 0.25rem;
        }

        /* Compact Quick Summary */
        .compact-summary-header {
            margin-bottom: 1rem;
        }

        .compact-summary-content {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .compact-summary-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem;
            background: var(--secondary-bg);
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        .compact-summary-item .summary-label {
            color: var(--text-secondary);
            font-size: 0.85rem;
            font-weight: 500;
        }

        .compact-summary-item .summary-value {
            color: var(--text-primary);
            font-size: 0.85rem;
            font-weight: 600;
        }

        /* Mobile Responsiveness for Compact Stats */
        @media (max-width: 480px) {
            .compact-stats-header {
                padding: 1.25rem;
                border-radius: 12px;
            }
            
            .stats-title {
                font-size: 1.2rem;
            }
            
            .stats-subtitle {
                font-size: 0.8rem;
            }
            
            .compact-performance-stats,
            .compact-financial-stats,
            .compact-quick-summary {
                padding: 1rem;
                border-radius: 12px;
            }
            
            .compact-stats-grid {
                gap: 0.5rem;
            }
            
            .compact-stat-item {
                padding: 0.75rem;
            }
            
            .compact-stat-item i {
                font-size: 1.3rem;
            }
            
            .compact-stat-value {
                font-size: 1.1rem;
            }
            
            .compact-stat-label {
                font-size: 0.7rem;
            }
            
            .compact-stat-trend {
                font-size: 0.65rem;
                padding: 0.2rem 0.4rem;
            }
            
            .compact-summary-item {
                padding: 0.6rem;
            }
            
            .compact-summary-item .summary-label,
            .compact-summary-item .summary-value {
                font-size: 0.8rem;
            }
        }

        @media (max-width: 768px) {
            .compact-stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* --- Compact Mobile Wallet UI Styles --- */
        .compact-wallet-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            position: relative;
            overflow: hidden;
        }

        .compact-wallet-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
            pointer-events: none;
        }

        .wallet-main-info {
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            z-index: 1;
        }

        .wallet-title-section {
            flex: 1;
        }

        .wallet-title {
            color: white;
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .wallet-subtitle {
            color: rgba(255,255,255,0.9);
            font-size: 0.9rem;
            margin: 0;
        }

        .wallet-header-icon {
            width: 50px;
            height: 50px;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.3rem;
            backdrop-filter: blur(10px);
        }

        /* Compact Balance Cards */
        .compact-balance-cards {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .compact-balance-card {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .compact-balance-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
        }

        .compact-balance-card.deposit::before {
            background: linear-gradient(180deg, #10b981, #059669);
        }

        .compact-balance-card.winning::before {
            background: linear-gradient(180deg, #f59e0b, #d97706);
        }

        .compact-balance-card.bonus::before {
            background: linear-gradient(180deg, #8b5cf6, #7c3aed);
        }

        .compact-balance-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .balance-card-content {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            flex: 1;
        }

        .balance-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: white;
        }

        .compact-balance-card.deposit .balance-icon {
            background: linear-gradient(135deg, #10b981, #059669);
        }

        .compact-balance-card.winning .balance-icon {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }

        .compact-balance-card.bonus .balance-icon {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
        }

        .balance-info {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .balance-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .balance-amount {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .compact-balance-action {
            background: var(--accent-color);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 0.5rem 0.75rem;
            font-size: 0.8rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.25rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .compact-balance-action:hover {
            background: var(--accent-hover);
            transform: translateY(-1px);
        }

        .compact-balance-info {
            color: var(--text-secondary);
            font-size: 0.7rem;
            font-weight: 500;
        }

        /* Compact Wallet Actions */
        .compact-wallet-actions {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 1.25rem;
            margin-bottom: 1rem;
        }

        .actions-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
        }

        .compact-wallet-action {
            background: var(--secondary-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--text-primary);
            text-decoration: none;
        }

        .compact-wallet-action:hover {
            background: var(--accent-color);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .compact-wallet-action i {
            font-size: 1.5rem;
        }

        .compact-wallet-action span {
            font-size: 0.8rem;
            font-weight: 500;
        }

        /* Compact Wallet Stats */
        .compact-wallet-stats {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 1.25rem;
            margin-bottom: 1rem;
        }

        .compact-stats-section-header {
            margin-bottom: 1rem;
        }

        .compact-stats-section-header .stats-section-title {
            color: var(--text-primary);
            font-size: 1.1rem;
            font-weight: 600;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Compact Transactions */
        .compact-transactions {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 1.25rem;
        }

        .compact-transactions-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .transactions-title {
            color: var(--text-primary);
            font-size: 1.1rem;
            font-weight: 600;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .transactions-count {
            color: var(--text-secondary);
            font-size: 0.8rem;
            font-weight: 500;
        }

        .compact-transactions-list {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .compact-transaction-placeholder {
            background: var(--secondary-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1rem;
        }

        .placeholder-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .placeholder-icon {
            width: 40px;
            height: 40px;
            background: var(--border-color);
            border-radius: 50%;
            animation: pulse 1.5s infinite;
        }

        .placeholder-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .placeholder-title {
            height: 16px;
            background: var(--border-color);
            border-radius: 4px;
            width: 60%;
            animation: pulse 1.5s infinite;
        }

        .placeholder-subtitle {
            height: 12px;
            background: var(--border-color);
            border-radius: 4px;
            width: 40%;
            animation: pulse 1.5s infinite;
        }

        .placeholder-amount {
            height: 20px;
            background: var(--border-color);
            border-radius: 4px;
            width: 80px;
            animation: pulse 1.5s infinite;
        }

        .compact-empty-transactions {
            text-align: center;
            padding: 2rem 1rem;
        }

        .empty-icon {
            width: 60px;
            height: 60px;
            background: var(--secondary-bg);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1rem;
            color: var(--text-secondary);
            font-size: 1.5rem;
        }

        .empty-title {
            color: var(--text-primary);
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .empty-subtitle {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin: 0;
        }

        /* Mobile Responsiveness for Compact Wallet */
        @media (max-width: 480px) {
            .compact-wallet-header {
                padding: 1.25rem;
                border-radius: 12px;
            }
            
            .wallet-title {
                font-size: 1.2rem;
            }
            
            .wallet-subtitle {
                font-size: 0.8rem;
            }
            
            .compact-balance-cards {
                gap: 0.5rem;
            }
            
            .compact-balance-card {
                padding: 0.75rem;
            }
            
            .balance-icon {
                width: 35px;
                height: 35px;
                font-size: 1rem;
            }
            
            .balance-amount {
                font-size: 1rem;
            }
            
            .compact-balance-action {
                padding: 0.4rem 0.6rem;
                font-size: 0.75rem;
            }
            
            .compact-wallet-actions,
            .compact-wallet-stats,
            .compact-transactions {
                padding: 1rem;
                border-radius: 12px;
            }
            
            .actions-row {
                gap: 0.5rem;
            }
            
            .compact-wallet-action {
                padding: 0.75rem;
            }
            
            .compact-wallet-action i {
                font-size: 1.3rem;
            }
            
            .compact-wallet-action span {
                font-size: 0.75rem;
            }
        }

        @media (max-width: 768px) {
            .actions-row {
                grid-template-columns: 1fr 1fr;
            }
        }

        /* Compact Transaction Items */
        .compact-transaction-item {
            background: var(--secondary-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 0.75rem;
            transition: all 0.3s ease;
        }

        .compact-transaction-item:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .transaction-item-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .transaction-item-info {
            flex: 1;
        }

        .transaction-item-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }

        .transaction-item-time {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .transaction-item-amount {
            font-size: 1rem;
            font-weight: 700;
            padding: 0.25rem 0.5rem;
            border-radius: 6px;
        }

        .transaction-item-amount.positive {
            color: #22c55e;
            background: rgba(34, 197, 94, 0.1);
        }

        .transaction-item-amount.negative {
            color: #ef4444;
            background: rgba(239, 68, 68, 0.1);
        }

        /* Mobile Responsiveness for Transaction Items */
        @media (max-width: 480px) {
            .compact-transaction-item {
                padding: 0.75rem;
            }
            
            .transaction-item-title {
                font-size: 0.85rem;
            }
            
            .transaction-item-time {
                font-size: 0.7rem;
            }
            
            .transaction-item-amount {
                font-size: 0.9rem;
                padding: 0.2rem 0.4rem;
            }
        }

        /* --- Compact Mobile Homepage UI Styles --- */
        .compact-home-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            position: relative;
            overflow: hidden;
        }

        .compact-home-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
            pointer-events: none;
        }

        .home-main-info {
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            z-index: 1;
        }

        .home-title-section {
            flex: 1;
        }

        .home-title {
            color: white;
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .home-subtitle {
            color: rgba(255,255,255,0.9);
            font-size: 0.9rem;
            margin: 0;
        }

        .home-header-icon {
            width: 50px;
            height: 50px;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.3rem;
            backdrop-filter: blur(10px);
        }

        /* Compact Quick Actions */
        .compact-quick-actions {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 1.25rem;
            margin-bottom: 1rem;
        }

        .compact-quick-action {
            background: var(--secondary-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--text-primary);
            text-decoration: none;
        }

        .compact-quick-action:hover {
            background: var(--accent-color);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .compact-quick-action i {
            font-size: 1.5rem;
        }

        .compact-quick-action span {
            font-size: 0.8rem;
            font-weight: 500;
        }

        /* Compact Section Headers */
        .compact-section-header {
            margin-bottom: 1rem;
        }

        .compact-section-header .section-title {
            color: var(--text-primary);
            font-size: 1.1rem;
            font-weight: 600;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .compact-section-header .section-subtitle {
            color: var(--text-secondary);
            font-size: 0.85rem;
            margin: 0.25rem 0 0 0;
        }

        /* Compact Promotion Section */
        .compact-promotion-section {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 1.25rem;
            margin-bottom: 1rem;
        }

        .compact-swiper-container {
            width: 100%;
            height: 180px;
            border-radius: 12px;
            overflow: hidden;
            --swiper-pagination-color: var(--accent-color);
            --swiper-pagination-bullet-inactive-color: var(--text-secondary);
            --swiper-pagination-bullet-size: 6px;
        }

        .compact-promotion-card {
            background: var(--secondary-bg);
            border-radius: 12px;
            height: 100%;
            position: relative;
            overflow: hidden;
        }

        .compact-promotion-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
            z-index: 1;
        }

        /* Compact Games Section */
        .compact-games-section {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 1.25rem;
            margin-bottom: 1rem;
        }

        .compact-games-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.75rem;
        }

        .compact-game-card {
            background: var(--secondary-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .compact-game-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .compact-game-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, var(--accent-color), #FBBF24);
        }

        .compact-game-card img {
            width: 100%;
            height: 100px;
            object-fit: cover;
            display: block;
        }

        .compact-game-card span {
            display: block;
            padding: 0.75rem;
            font-weight: 500;
            font-size: 0.85rem;
            color: var(--text-primary);
            text-align: center;
        }

        /* Compact Stats Overview */
        .compact-stats-overview {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 1.25rem;
        }

        /* Mobile Responsiveness for Compact Homepage */
        @media (max-width: 480px) {
            .compact-home-header {
                padding: 1.25rem;
                border-radius: 12px;
            }
            
            .home-title {
                font-size: 1.2rem;
            }
            
            .home-subtitle {
                font-size: 0.8rem;
            }
            
            .compact-quick-actions,
            .compact-promotion-section,
            .compact-games-section,
            .compact-stats-overview {
                padding: 1rem;
                border-radius: 12px;
            }
            
            .actions-row {
                gap: 0.5rem;
            }
            
            .compact-quick-action {
                padding: 0.75rem;
            }
            
            .compact-quick-action i {
                font-size: 1.3rem;
            }
            
            .compact-quick-action span {
                font-size: 0.75rem;
            }
            
            .compact-swiper-container {
                height: 150px;
            }
            
            .compact-games-grid {
                gap: 0.5rem;
            }
            
            .compact-game-card img {
                height: 80px;
            }
            
            .compact-game-card span {
                padding: 0.6rem;
                font-size: 0.8rem;
            }
        }

        @media (max-width: 768px) {
            .actions-row {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .compact-games-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* --- Simple Homepage UI Styles --- */
        .simple-banner-section {
            margin-bottom: 1rem;
        }

        .simple-swiper-container {
            width: 100%;
            height: 200px;
            border-radius: 16px;
            overflow: hidden;
            --swiper-pagination-color: var(--accent-color);
            --swiper-pagination-bullet-inactive-color: var(--text-secondary);
            --swiper-pagination-bullet-size: 8px;
        }

        .simple-banner-card {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            height: 100%;
            position: relative;
            overflow: hidden;
        }

        .simple-banner-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
            z-index: 1;
        }

        .banner-image-placeholder {
            width: 100%;
            height: 100%;
            background: var(--secondary-bg);
            border-radius: 16px;
            animation: pulse 1.5s infinite;
        }

        .banner-content-placeholder {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 1rem;
            background: linear-gradient(transparent, rgba(0,0,0,0.7));
            z-index: 2;
        }

        .title-placeholder {
            height: 20px;
            background: var(--border-color);
            border-radius: 4px;
            width: 70%;
            margin-bottom: 0.5rem;
            animation: pulse 1.5s infinite;
        }

        .description-placeholder {
            height: 16px;
            background: var(--border-color);
            border-radius: 4px;
            width: 50%;
            animation: pulse 1.5s infinite;
        }

        /* Simple Games Section */
        .simple-games-section {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 1.25rem;
        }

        .simple-section-header {
            margin-bottom: 1rem;
        }

        .simple-section-header .section-title {
            color: var(--text-primary);
            font-size: 1.1rem;
            font-weight: 600;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .simple-games-list {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.75rem;
        }

        .simple-game-item {
            background: var(--secondary-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            overflow: hidden;
            position: relative;
        }

        .simple-game-item:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-color: var(--accent-color);
        }

        .game-icon-placeholder {
            width: 40px;
            height: 40px;
            background: var(--border-color);
            border-radius: 8px;
            animation: pulse 1.5s infinite;
        }

        .game-name-placeholder {
            height: 18px;
            background: var(--border-color);
            border-radius: 4px;
            width: 60%;
            animation: pulse 1.5s infinite;
        }

        .game-icon {
            width: 100%;
            height: 100px;
            overflow: hidden;
            position: relative;
        }

        .game-icon img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        .game-name {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0,0,0,0.8));
            color: white;
            font-size: 0.9rem;
            font-weight: 600;
            text-align: center;
            padding: 0.75rem 0.5rem 0.5rem;
            line-height: 1.2;
        }

        /* Mobile Responsiveness for Simple Homepage */
        @media (max-width: 480px) {
            .simple-swiper-container {
                height: 160px;
                border-radius: 12px;
            }
            
            .simple-games-section {
                padding: 1rem;
                border-radius: 12px;
            }
            
            .simple-games-list {
                gap: 0.5rem;
            }
            
            .simple-game-item {
                padding: 0;
            }
            
            .game-icon {
                height: 80px;
            }
            
            .game-name {
                font-size: 0.8rem;
                padding: 0.5rem 0.25rem 0.25rem;
            }
            
            .game-icon-placeholder {
                width: 100%;
                height: 80px;
            }
            
            .game-name-placeholder {
                height: 16px;
            }
        }

        /* --- Beautiful Modern Header Styles --- */
        .beautiful-header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 70px;
            z-index: 1000;
            overflow: hidden;
        }

        .header-background {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .header-gradient {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
        }

        .header-pattern {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: radial-gradient(circle at 20% 50%, rgba(255,255,255,0.1) 0%, transparent 50%),
                              radial-gradient(circle at 80% 20%, rgba(255,255,255,0.05) 0%, transparent 50%);
        }

        .header-content {
            position: relative;
            z-index: 1;
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 100%;
            padding: 0 1rem;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .header-back-button {
            background: rgba(255,255,255,0.2);
            border: none;
            border-radius: 50%;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .header-back-button:hover {
            background: rgba(255,255,255,0.3);
            transform: scale(1.05);
        }

        .header-brand {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .header-logo-container {
            width: 40px;
            height: 40px;
            background: rgba(255,255,255,0.2);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
        }

        .header-logo-icon {
            color: white;
            font-size: 1.3rem;
        }

        .header-title-container {
            display: flex;
            flex-direction: column;
            gap: 0.1rem;
        }

        .header-welcome {
            color: white;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .header-subtitle {
            color: rgba(255,255,255,0.8);
            font-size: 0.75rem;
            font-weight: 400;
        }

        .header-game-title {
            color: white;
            font-size: 1rem;
            font-weight: 600;
            margin-left: 0.5rem;
            display: none;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .header-notification-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            position: relative;
        }

        .header-notification-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: scale(1.05);
        }

        .notification-badge {
            position: absolute;
            top: -2px;
            right: -2px;
            background: #ef4444;
            color: white;
            font-size: 0.6rem;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
        }

        .header-wallet-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            border-radius: 12px;
            padding: 0.5rem 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
        }

        .header-wallet-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-1px);
        }

        .wallet-icon {
            font-size: 1rem;
        }

        .wallet-amount {
            font-size: 0.9rem;
            font-weight: 600;
        }

        /* Mobile Responsiveness for Beautiful Header */
        @media (max-width: 480px) {
            .beautiful-header {
                height: 65px;
            }
            
            .header-content {
                padding: 0 0.75rem;
            }
            
            .header-left {
                gap: 0.5rem;
            }
            
            .header-brand {
                gap: 0.5rem;
            }
            
            .header-logo-container {
                width: 35px;
                height: 35px;
            }
            
            .header-logo-icon {
                font-size: 1.1rem;
            }
            
            .header-welcome {
                font-size: 0.8rem;
            }
            
            .header-subtitle {
                font-size: 0.7rem;
            }
            
            .header-right {
                gap: 0.5rem;
            }
            
            .header-notification-btn {
                width: 36px;
                height: 36px;
                font-size: 1rem;
            }
            
            .header-wallet-btn {
                padding: 0.4rem 0.6rem;
            }
            
            .wallet-amount {
                font-size: 0.8rem;
            }
        }
</style>

</body>
</html>